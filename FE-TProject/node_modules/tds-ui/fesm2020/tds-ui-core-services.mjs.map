{"version":3,"file":"tds-ui-core-services.mjs","sources":["../../../projects/tds-ui/core/services/environment.ts","../../../projects/tds-ui/core/services/singleton.ts","../../../projects/tds-ui/core/services/scroll.ts","../../../projects/tds-ui/core/services/resize.ts","../../../projects/tds-ui/core/services/breakpoint.ts","../../../projects/tds-ui/core/services/destroy.ts","../../../projects/tds-ui/core/services/drag.ts","../../../projects/tds-ui/core/services/tds-ui-core-services.ts"],"sourcesContent":["\r\nexport const environment = {\r\n  isTestMode: false\r\n};\r\n","\r\n\r\nimport { Injectable } from '@angular/core';\r\nimport { environment } from './environment';\r\n\r\ninterface SingletonRegistryItem {\r\n  target: any;\r\n}\r\n\r\n/**\r\n * When running in test, singletons should not be destroyed. So we keep references of singletons\r\n * in this global variable.\r\n */\r\nconst testSingleRegistry = new Map<string, SingletonRegistryItem>();\r\n\r\n/**\r\n * Some singletons should have life cycle that is same to Angular's. This service make sure that\r\n * those singletons get destroyed in HMR.\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TDSSingletonService {\r\n  private get singletonRegistry(): Map<string, SingletonRegistryItem> {\r\n    return environment.isTestMode ? testSingleRegistry : this._singletonRegistry;\r\n  }\r\n\r\n  /**\r\n   * This registry is used to register singleton in dev mode.\r\n   * So that singletons get destroyed when hot module reload happens.\r\n   *\r\n   * This works in prod mode too but with no specific effect.\r\n   */\r\n  private _singletonRegistry = new Map<string, SingletonRegistryItem>();\r\n\r\n  registerSingletonWithKey(key: string, target: any): void {\r\n    const alreadyHave = this.singletonRegistry.has(key);\r\n    const item: SingletonRegistryItem = alreadyHave ? this.singletonRegistry.get(key)! : this.withNewTarget(target);\r\n\r\n    if (!alreadyHave) {\r\n      this.singletonRegistry.set(key, item);\r\n    }\r\n  }\r\n\r\n  getSingletonWithKey<T>(key: string): T | null {\r\n    return this.singletonRegistry.has(key) ? (this.singletonRegistry.get(key)!.target as T) : null;\r\n  }\r\n\r\n  private withNewTarget(target: any): SingletonRegistryItem {\r\n    return {\r\n      target\r\n    };\r\n  }\r\n}\r\n","\r\n\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { Inject, Injectable } from '@angular/core';\r\nimport { TDSSafeAny } from 'tds-ui/shared/utility';\r\nimport { reqAnimFrame } from 'tds-ui/core/animation';\r\n\r\nexport type EasyingFn = (t: number, b: number, c: number, d: number) => number;\r\n\r\nfunction easeInOutCubic(t: number, b: number, c: number, d: number): number {\r\n  const cc = c - b;\r\n  let tt = t / (d / 2);\r\n  if (tt < 1) {\r\n    return (cc / 2) * tt * tt * tt + b;\r\n  } else {\r\n    return (cc / 2) * ((tt -= 2) * tt * tt + 2) + b;\r\n  }\r\n}\r\n\r\nexport interface TDSScrollToOptions {\r\n  /** Scroll container, default as window */\r\n  easing?: EasyingFn;\r\n  /** Scroll end callback */\r\n  callback?(): void;\r\n  /** Animation duration, default as 450 */\r\n  duration?: number;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TDSScrollService {\r\n  private doc: Document;\r\n\r\n  constructor(@Inject(DOCUMENT) doc: TDSSafeAny) {\r\n    this.doc = doc;\r\n  }\r\n\r\n  /** Set the position of the scroll bar of `el`. */\r\n  setScrollTop(el: Element | Window, topValue: number = 0): void {\r\n    if (el === window) {\r\n      this.doc.body.scrollTop = topValue;\r\n      this.doc.documentElement!.scrollTop = topValue;\r\n    } else {\r\n      (el as Element).scrollTop = topValue;\r\n    }\r\n  }\r\n\r\n  /** Get position of `el` against window. */\r\n  getOffset(el: Element): { top: number; left: number } {\r\n    const ret = {\r\n      top: 0,\r\n      left: 0\r\n    };\r\n    if (!el || !el.getClientRects().length) {\r\n      return ret;\r\n    }\r\n\r\n    const rect = el.getBoundingClientRect();\r\n    if (rect.width || rect.height) {\r\n      const doc = el.ownerDocument!.documentElement;\r\n      ret.top = rect.top - doc!.clientTop;\r\n      ret.left = rect.left - doc!.clientLeft;\r\n    } else {\r\n      ret.top = rect.top;\r\n      ret.left = rect.left;\r\n    }\r\n\r\n    return ret;\r\n  }\r\n\r\n  /** Get the position of the scoll bar of `el`. */\r\n  // TODO: remove '| Window' as the fallback already happens here\r\n  getScroll(target?: Element | HTMLElement | Window | Document | null, top: boolean = true): number {\r\n    if (typeof window === 'undefined') {\r\n      return 0;\r\n    }\r\n    const method = top ? 'scrollTop' : 'scrollLeft';\r\n    let result = 0;\r\n    if (this.isWindow(target)) {\r\n      result = (target as Window)[top ? 'pageYOffset' : 'pageXOffset'];\r\n    } else if (target instanceof Document) {\r\n      result = target.documentElement[method];\r\n    } else if (target) {\r\n      result = (target as HTMLElement)[method];\r\n    }\r\n    if (target && !this.isWindow(target) && typeof result !== 'number') {\r\n      result = ((target as HTMLElement).ownerDocument || (target as Document)).documentElement[method];\r\n    }\r\n    return result;\r\n  }\r\n\r\n  isWindow(obj: TDSSafeAny): boolean {\r\n    return obj !== null && obj !== undefined && obj === obj.window;\r\n  }\r\n\r\n  /**\r\n   * Scroll `el` to some position with animation.\r\n   *\r\n   * @param containerEl container, `window` by default\r\n   * @param y Scroll to `top`, 0 by default\r\n   */\r\n  scrollTo(containerEl?: Element | HTMLElement | Window | Document | null, y: number = 0, options: TDSScrollToOptions = {}): void {\r\n    const target = containerEl ? containerEl : window;\r\n    const scrollTop = this.getScroll(target);\r\n    const startTime = Date.now();\r\n    const { easing, callback, duration = 450 } = options;\r\n    const frameFunc = () => {\r\n      const timestamp = Date.now();\r\n      const time = timestamp - startTime;\r\n      const nextScrollTop = (easing || easeInOutCubic)(time > duration ? duration : time, scrollTop, y, duration);\r\n      if (this.isWindow(target)) {\r\n        (target as Window).scrollTo(window.pageXOffset, nextScrollTop);\r\n      } else if (target instanceof HTMLDocument || target.constructor.name === 'HTMLDocument') {\r\n        (target as HTMLDocument).documentElement.scrollTop = nextScrollTop;\r\n      } else {\r\n        (target as HTMLElement).scrollTop = nextScrollTop;\r\n      }\r\n      if (time < duration) {\r\n        reqAnimFrame(frameFunc);\r\n      } else if (typeof callback === 'function') {\r\n        callback();\r\n      }\r\n    };\r\n    reqAnimFrame(frameFunc);\r\n  }\r\n}\r\n","import { Injectable, NgZone, Renderer2, RendererFactory2 } from \"@angular/core\";\r\nimport { Observable, Subject } from \"rxjs\";\r\nimport { auditTime, finalize } from \"rxjs/operators\";\r\n\r\nconst NOOP = (): void => {};\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TDSResizeService {\r\n  private readonly resizeSource$ = new Subject<void>();\r\n\r\n  private listeners = 0;\r\n\r\n  private renderer: Renderer2;\r\n\r\n  private disposeHandle = NOOP;\r\n\r\n  private handler = (): void => {\r\n    this.ngZone.run(() => {\r\n      this.resizeSource$.next();\r\n    });\r\n  };\r\n\r\n  constructor(private ngZone: NgZone, private rendererFactory2: RendererFactory2) {\r\n    this.renderer = this.rendererFactory2.createRenderer(null, null);\r\n  }\r\n\r\n  subscribe(): Observable<void> {\r\n    this.registerListener();\r\n\r\n    return this.resizeSource$.pipe(\r\n      auditTime(16),\r\n      finalize(() => this.unregisterListener())\r\n    );\r\n  }\r\n\r\n  unsubscribe(): void {\r\n    this.unregisterListener();\r\n  }\r\n\r\n  private registerListener(): void {\r\n    if (this.listeners === 0) {\r\n      this.ngZone.runOutsideAngular(() => {\r\n        this.disposeHandle = this.renderer.listen('window', 'resize', this.handler);\r\n      });\r\n    }\r\n\r\n    this.listeners += 1;\r\n  }\r\n\r\n  private unregisterListener(): void {\r\n    this.listeners -= 1;\r\n\r\n    if (this.listeners === 0) {\r\n      this.disposeHandle();\r\n      this.disposeHandle = NOOP;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from \"@angular/core\";\r\nimport { Observable } from \"rxjs\";\r\nimport { distinctUntilChanged, map, startWith } from \"rxjs/operators\";\r\nimport { TDSResizeService } from \"./resize\";\r\nimport { MediaMatcher } from '@angular/cdk/layout';\r\n\r\nexport enum TDSBreakpointEnum {\r\n  xxl = 'xxl',\r\n  xl = 'xl',\r\n  lg = 'lg',\r\n  md = 'md',\r\n  sm = 'sm',\r\n  xs = 'xs'\r\n}\r\n\r\nexport type BreakpointMap = { [key in TDSBreakpointEnum]: string };\r\nexport type BreakpointBooleanMap = { [key in TDSBreakpointEnum]: boolean };\r\nexport type TDSBreakpointKey = keyof typeof TDSBreakpointEnum;\r\n\r\nexport const gridResponsiveMap: BreakpointMap = {\r\n  xs: '(max-width: 575px)',\r\n  sm: '(min-width: 576px)',\r\n  md: '(min-width: 768px)',\r\n  lg: '(min-width: 992px)',\r\n  xl: '(min-width: 1200px)',\r\n  xxl: '(min-width: 1600px)'\r\n};\r\n\r\nexport const siderResponsiveMap: BreakpointMap = {\r\n  xs: '(max-width: 479.98px)',\r\n  sm: '(max-width: 575.98px)',\r\n  md: '(max-width: 767.98px)',\r\n  lg: '(max-width: 991.98px)',\r\n  xl: '(max-width: 1199.98px)',\r\n  xxl: '(max-width: 1599.98px)'\r\n};\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TDSBreakpointService {\r\n  constructor(private resizeService: TDSResizeService, private mediaMatcher: MediaMatcher) {\r\n    this.resizeService.subscribe().subscribe(() => {});\r\n  }\r\n\r\n  subscribe(breakpointMap: BreakpointMap): Observable<TDSBreakpointEnum>;\r\n  subscribe(breakpointMap: BreakpointMap, fullMap: true): Observable<BreakpointBooleanMap>;\r\n  subscribe(breakpointMap: BreakpointMap, fullMap?: true): Observable<TDSBreakpointEnum | BreakpointBooleanMap> {\r\n    if (fullMap) {\r\n      const get = () => this.matchMedia(breakpointMap, true);\r\n      return this.resizeService.subscribe().pipe(\r\n        map(get),\r\n        startWith(get()),\r\n        distinctUntilChanged(\r\n          (x: [TDSBreakpointEnum, BreakpointBooleanMap], y: [TDSBreakpointEnum, BreakpointBooleanMap]) => x[0] === y[0]\r\n        ),\r\n        map(x => x[1])\r\n      );\r\n    } else {\r\n      const get = () => this.matchMedia(breakpointMap);\r\n      return this.resizeService.subscribe().pipe(map(get), startWith(get()), distinctUntilChanged());\r\n    }\r\n  }\r\n\r\n  private matchMedia(breakpointMap: BreakpointMap): TDSBreakpointEnum;\r\n  private matchMedia(breakpointMap: BreakpointMap, fullMap: true): [TDSBreakpointEnum, BreakpointBooleanMap];\r\n  private matchMedia(\r\n    breakpointMap: BreakpointMap,\r\n    fullMap?: true\r\n  ): TDSBreakpointEnum | [TDSBreakpointEnum, BreakpointBooleanMap] {\r\n    let bp = TDSBreakpointEnum.md;\r\n\r\n    const breakpointBooleanMap: Partial<BreakpointBooleanMap> = {};\r\n\r\n    Object.keys(breakpointMap).map(breakpoint => {\r\n      const castBP = breakpoint as TDSBreakpointEnum;\r\n      const matched = this.mediaMatcher.matchMedia(gridResponsiveMap[castBP]).matches;\r\n\r\n      breakpointBooleanMap[breakpoint as TDSBreakpointEnum] = matched;\r\n\r\n      if (matched) {\r\n        bp = castBP;\r\n      }\r\n    });\r\n\r\n    if (fullMap) {\r\n      return [bp, breakpointBooleanMap as BreakpointBooleanMap];\r\n    } else {\r\n      return bp;\r\n    }\r\n  }\r\n}","import { Injectable, OnDestroy } from \"@angular/core\";\r\nimport { Subject } from \"rxjs\";\r\n\r\n@Injectable()\r\nexport class TDSDestroyService extends Subject<void> implements OnDestroy {\r\n  ngOnDestroy(): void {\r\n    this.next();\r\n    this.complete();\r\n  }\r\n}","\r\nimport { Injectable, Renderer2, RendererFactory2 } from '@angular/core';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { filter, finalize, map } from 'rxjs/operators';\r\nimport { getEventPosition, isTouchEvent } from 'tds-ui/core/util';\r\n\r\n\r\ninterface Point {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\ntype Delta = Point;\r\n\r\ninterface HandlerItem {\r\n  handler?(e: Event): void;\r\n\r\n  teardown(): void;\r\n}\r\n\r\nfunction getPagePosition(event: MouseEvent | TouchEvent): Point {\r\n  const e = getEventPosition(event);\r\n  return {\r\n    x: e.pageX,\r\n    y: e.pageY\r\n  };\r\n}\r\n\r\n/**\r\n * This module provide a global dragging service to other components.\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TDSDragService {\r\n  private draggingThreshold = 5;\r\n  private currentDraggingSequence: Subject<MouseEvent | Touch> | null = null;\r\n  private currentStartingPoint: Point | null = null;\r\n  private handleRegistry = new Set<HandlerItem>();\r\n  private renderer: Renderer2;\r\n\r\n  constructor(rendererFactory2: RendererFactory2) {\r\n    this.renderer = rendererFactory2.createRenderer(null, null);\r\n  }\r\n\r\n  requestDraggingSequence(event: MouseEvent | TouchEvent): Observable<Delta> {\r\n    if (!this.handleRegistry.size) {\r\n      this.registerDraggingHandler(isTouchEvent(event));\r\n    }\r\n\r\n    // Complete last dragging sequence if a new target is dragged.\r\n    if (this.currentDraggingSequence) {\r\n      this.currentDraggingSequence.complete();\r\n    }\r\n\r\n    this.currentStartingPoint = getPagePosition(event);\r\n    this.currentDraggingSequence = new Subject<MouseEvent | Touch>();\r\n\r\n    return this.currentDraggingSequence.pipe(\r\n      map((e: MouseEvent | Touch) => {\r\n        return {\r\n          x: e.pageX - this.currentStartingPoint!.x,\r\n          y: e.pageY - this.currentStartingPoint!.y\r\n        };\r\n      }),\r\n      filter((e: Delta) => Math.abs(e.x) > this.draggingThreshold || Math.abs(e.y) > this.draggingThreshold),\r\n      finalize(() => this.teardownDraggingSequence())\r\n    );\r\n  }\r\n\r\n  private registerDraggingHandler(isTouch: boolean): void {\r\n    if (isTouch) {\r\n      this.handleRegistry.add({\r\n        teardown: this.renderer.listen('document', 'touchmove', (e: TouchEvent) => {\r\n          if (this.currentDraggingSequence) {\r\n            this.currentDraggingSequence.next(e.touches[0] || e.changedTouches[0]);\r\n          }\r\n        })\r\n      });\r\n      this.handleRegistry.add({\r\n        teardown: this.renderer.listen('document', 'touchend', () => {\r\n          if (this.currentDraggingSequence) {\r\n            this.currentDraggingSequence.complete();\r\n          }\r\n        })\r\n      });\r\n    } else {\r\n      this.handleRegistry.add({\r\n        teardown: this.renderer.listen('document', 'mousemove', e => {\r\n          if (this.currentDraggingSequence) {\r\n            this.currentDraggingSequence.next(e);\r\n          }\r\n        })\r\n      });\r\n      this.handleRegistry.add({\r\n        teardown: this.renderer.listen('document', 'mouseup', () => {\r\n          if (this.currentDraggingSequence) {\r\n            this.currentDraggingSequence.complete();\r\n          }\r\n        })\r\n      });\r\n    }\r\n  }\r\n\r\n  private teardownDraggingSequence(): void {\r\n    this.currentDraggingSequence = null;\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.TDSResizeService"],"mappings":"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"}