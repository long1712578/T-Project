{"version":3,"file":"tds-ui-zoom-box.mjs","sources":["../../../projects/tds-ui/zoom-box/tds-zoom-box.ts","../../../projects/tds-ui/zoom-box/tds-zoom-box.module.ts","../../../projects/tds-ui/zoom-box/tds-ui-zoom-box.ts"],"sourcesContent":["\r\nimport { ConnectionPositionPair } from '@angular/cdk/overlay';\r\nimport {  ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter,  Input,  OnDestroy, OnInit,  Output, Renderer2, ViewChild,  } from '@angular/core';\r\nimport { DEFAULT_TOOLTIP_POSITIONS, POSITION_MAP } from 'tds-ui/core/overlay';\r\n\r\n\r\n\r\n\r\nexport interface zoomboxCoord {\r\n    x: number;\r\n    y: number;\r\n  }\r\n  @Component({\r\n    selector: 'tds-zoombox',\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n    template: `\r\n  <div \r\n        #zoomContainer class=\"relative m-auto w-full h-full overflow-hidden pointer-events-none\"\r\n       >\r\n  \r\n    <img cdkOverlayOrigin #overlay=\"cdkOverlayOrigin\" #imageThumbnail \r\n    class=\"pointer-events-auto\" [src]=\"thumbImage\" (load)=\"onThumbImageLoaded()\"/>\r\n    \r\n    <div  class=\"absolute overflow-hidden pointer-events-none\" \r\n    [ngClass]=\"{ 'border border-red-500 cursor-move ': this.enableLens,'rounded-full':this.circularLens}\"\r\n         [style.display]=\"this.displayLen\"\r\n         [style.top.px]=\"this.lensTop\"\r\n         [style.left.px]=\"this.lensLeft\"\r\n         [style.width.px]=\"this.lensWidth\"\r\n         [style.height.px]=\"this.lensHeight\"\r\n    >\r\n    \r\n      <img #fullSizeImage class=\"absolute max-w-none max-h-none hidden pointer-events-none\" [src]=\"fullImage\"\r\n           (load)=\"onFullImageLoaded()\"\r\n           [style.display]=\"this.displayInPic\"\r\n           [style.top.px]=\"this.fullImageTop\"\r\n           [style.left.px]=\"this.fullImageLeft\"\r\n           [style.width.px]=\"this.magnifiedWidth\"\r\n           [style.height.px]=\"this.magnifiedHeight\"\r\n      />\r\n  \r\n    </div>\r\n  </div>\r\n  \r\n  <ng-template  cdkConnectedOverlay \r\n  [cdkConnectedOverlayOrigin]=\"overlay\"\r\n  [cdkConnectedOverlayOpen]=\"overlayVisible\"\r\n  [cdkConnectedOverlayPositions]=\"position\">\r\n      <div class=\"relative overflow-hidden pointer-events-none\"\r\n       [ngClass]=\"{\r\n      'border border-red-500 cursor-move': this.enableLens,\r\n      'rounded-full':this.circularLens}\"\r\n          [style.display]=\"this.displayOverlay\"\r\n          [style.top.px]=\"this.extendY\"\r\n           [style.left.px]=\"this.extendX\"\r\n         [style.width.px]=\"this.overlayWidth\"\r\n         [style.height.px]=\"this.overlayHeight\"\r\n           \r\n    >\r\n    <img #fullSizeImage class=\" relative max-w-none max-h-none hidden pointer-events-none\" [src]=\"fullImage\"\r\n           (load)=\"onFullImageLoaded()\"\r\n           [style.display]=\"this.displayOverlay\"\r\n           [style.top.px]=\"this.fullImageTop\"\r\n           [style.left.px]=\"this.fullImageLeft\"\r\n           [style.width.px]=\"this.magnifiedWidth\"\r\n           [style.height.px]=\"this.magnifiedHeight\"/>\r\n    </div>\r\n  \r\n  </ng-template>\r\n    `,\r\n    exportAs: 'TDSZoomBoxComponent'\r\n  })\r\n  \r\n  export class TDSZoomBoxComponent implements OnInit, OnDestroy {\r\n  \r\n    private static readonly validZoomModes: string[] = ['hover', 'toggle', 'click', 'hover-freeze'];\r\n  \r\n    @ViewChild('zoomContainer', {static: true}) zoomContainer !: ElementRef;\r\n    @ViewChild('imageThumbnail', {static: true}) imageThumbnail !: ElementRef;\r\n    @ViewChild('fullSizeImage', {static: true}) fullSizeImage !: ElementRef;\r\n    @Output() zoomScroll = new EventEmitter<number>();\r\n    @Output() zoomPosition = new EventEmitter<zoomboxCoord>();\r\n  \r\n    public displayLen!: string;\r\n    public displayOverlay!: string;\r\n    public displayInPic!:string\r\n  \r\n    public fullImageTop!: number;\r\n    public fullImageLeft!: number;\r\n    public magnifiedWidth!: number;\r\n    public magnifiedHeight!: number;\r\n    public lensTop!: number;\r\n    public lensLeft!: number;\r\n    public enableLens = false;\r\n  \r\n  \r\n    public thumbImage!: string;\r\n    public fullImage!: string;\r\n    public thumbWidth!: number;\r\n    public thumbHeight!: number;\r\n    public fullWidth!: number;\r\n    public fullHeight!: number;\r\n    \r\n    //scale to apply to len, will be change when zoom\r\n    public lensWidth = 100;\r\n    public lensHeight = 100;\r\n    \r\n      //default scale to calculate zoom value, will not be change\r\n    defaultLenWidth=100\r\n    defaultLenHeight=100\r\n  \r\n    overlayTop!:number\r\n    overlayLeft!:number\r\n    overlayWidth=200\r\n    overlayHeight=200\r\n    overlayVisible=false\r\n   \r\n  \r\n    extendY!:number\r\n    extendX!:number\r\n  \r\n    private zoomMode = 'hover';\r\n    private magnification = 1;\r\n    private enableScrollZoom = false;\r\n    private scrollStepSize = 0.1;\r\n    circularLens = false;\r\n  \r\n    private baseRatio!: number;\r\n    private minZoomRatio=0;\r\n    private maxZoomRatio = 2;\r\n    private xRatio!: number;\r\n    private yRatio!: number;\r\n    private offsetLeft!: number;\r\n    private offsetTop!: number;\r\n    private zoomingEnabled = false;\r\n    private zoomFrozen = false;\r\n    private isReady = false;\r\n    private thumbImageLoaded = false;\r\n    private fullImageLoaded = false;\r\n  \r\n    private latestMouseLeft!: number;\r\n    private latestMouseTop!: number;\r\n  \r\n    private eventListeners: (() => void)[] = [];\r\n    position:ConnectionPositionPair[]=[POSITION_MAP.right]\r\n     \r\n      \r\n    constructor( \r\n      private renderer: Renderer2,\r\n      private cd:ChangeDetectorRef\r\n      ) {\r\n          \r\n    }\r\n    \r\n    @Input() enableOverlay=false\r\n    \r\n    @Input ('extendX')\r\n    public set setExtendX(value:number)\r\n    {\r\n      this.extendX=Number(value) ||0\r\n    }\r\n    @Input ('extendY')\r\n    public set setExtendY(value:number)\r\n    {\r\n       this.extendY=Number(value) ||0\r\n    }\r\n    @Input('thumbImage')\r\n    public set setThumbImage(thumbImage: string) {\r\n        this.thumbImageLoaded = false;\r\n        this.isReady = false;\r\n        this.thumbImage = thumbImage;\r\n    }\r\n  \r\n    @Input('fullImage')\r\n    public set setFullImage(fullImage: string) {\r\n        this.fullImageLoaded = false;\r\n        this.isReady = false;\r\n        this.fullImage = fullImage;\r\n    }\r\n  \r\n    @Input('zoomMode')\r\n    public set setZoomMode(zoomMode: string) {\r\n      \r\n      if (TDSZoomBoxComponent.validZoomModes.some(m => m === zoomMode)) \r\n      {\r\n          \r\n          this.zoomContainer.nativeElement.removeAllListeners()\r\n          this.eventListeners=[]\r\n          this.zoomMode = zoomMode;\r\n          this.setUpEventListeners();\r\n        }\r\n        \r\n    }\r\n  \r\n    @Input('magnification')\r\n    public set setMagnification(magnification: number) {\r\n        this.magnification =Math.round((Number(magnification) || this.magnification)*10)/10;\r\n        this.zoomScroll.emit(this.magnification);\r\n    }\r\n  \r\n    @Input('minZoomRatio')\r\n    public set setMinZoomRatio(minZoomRatio: number) {\r\n        const ratio = Number(minZoomRatio) || this.minZoomRatio || this.baseRatio || 0;\r\n        this.minZoomRatio = Math.max(ratio, this.baseRatio || 0);\r\n    }\r\n  \r\n    @Input('maxZoomRatio')\r\n    public set setMaxZoomRatio(maxZoomRatio: number) {\r\n        this.maxZoomRatio = Number(maxZoomRatio) || this.maxZoomRatio;\r\n    }\r\n  \r\n    @Input('scrollStepSize')\r\n    public set setScrollStepSize(stepSize: number) {\r\n        this.scrollStepSize = Number(stepSize) || this.scrollStepSize;\r\n    }\r\n  \r\n    @Input('enableLens')\r\n    public set setEnableLens(enable: boolean) {\r\n        this.enableLens = Boolean(enable);\r\n    }\r\n  \r\n    @Input('lensWidth')\r\n    public set setLensWidth(width: number) {\r\n      this.defaultLenWidth =this.lensWidth= Number(width) || this.lensWidth;\r\n    }\r\n  \r\n    @Input('lensHeight')\r\n    public set setLensHeight(height: number) {\r\n      this.defaultLenHeight=this.lensHeight=  Number(height) || this.lensHeight;\r\n    }\r\n  \r\n    @Input('circularLens')\r\n    public set setCircularLens(enable: boolean) {\r\n        this.circularLens = Boolean(enable);\r\n    }\r\n  \r\n    @Input('enableScrollZoom')\r\n    public set setEnableScrollZoom(enable: boolean) {\r\n        this.enableScrollZoom = Boolean(enable);\r\n    }\r\n    @Input('postion')\r\n    public set setPositon(pos:string|string[])\r\n    {\r\n      this.setOverlayPositon(pos)\r\n    }\r\n    \r\n    ngOnInit(): void {\r\n      this.setUpEventListeners();\r\n    }\r\n  \r\n    ngOnDestroy(): void {\r\n        this.eventListeners.forEach((destroyFn) => destroyFn());\r\n    }\r\n    setOverlayPositon(pos:string|string[])\r\n    {\r\n      let preferredPosition:any\r\n      if (Array.isArray(pos))\r\n          preferredPosition= pos.map(placement => POSITION_MAP[placement]);\r\n      else\r\n          preferredPosition= [pos].map(placement => POSITION_MAP[placement]);\r\n      this.position = [...preferredPosition, ...DEFAULT_TOOLTIP_POSITIONS];\r\n    }\r\n    onThumbImageLoaded() {\r\n        this.thumbImageLoaded = true;\r\n        this.checkImagesLoaded();\r\n    }\r\n  \r\n    onFullImageLoaded() {\r\n        this.fullImageLoaded = true;\r\n        this.checkImagesLoaded();\r\n    }\r\n  \r\n    private setUpEventListeners() {\r\n        switch(this.zoomMode)\r\n        {\r\n          case 'hover':\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mouseenter', ($event) => this.hoverMouseEnter($event))\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mouseleave', () => this.hoverMouseLeave())\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mousemove', ($event) => this.hoverMouseMove($event))\r\n              );\r\n              break\r\n          case 'toggle':\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'click', ($event) => this.toggleClick($event))\r\n              );\r\n              break\r\n          case 'click':\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'click', ($event) => this.clickStarter($event))\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mouseleave', () => this.clickMouseLeave())\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mousemove', ($event) => this.clickMouseMove($event))\r\n              );\r\n              break\r\n          case 'toggle-click':\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'click', (event) => this.toggleClick(event))\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mouseleave', () => this.clickMouseLeave())\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mousemove', (event) => this.clickMouseMove(event))\r\n              );\r\n              break\r\n          case 'hover-freeze':\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mouseenter', ($event) => this.hoverFreezeMouseEnter($event))\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mouseleave', () => this.hoverFreezeMouseLeave())\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'mousemove', ($event) => this.hoverFreezeMouseMove($event))\r\n              );\r\n              this.eventListeners.push(\r\n                  this.renderer.listen(this.zoomContainer.nativeElement, 'click', ($event) => this.hoverFreezeClick($event))\r\n              );\r\n              break\r\n          default:\r\n              break\r\n        }\r\n        if (this.enableScrollZoom) {\r\n            // Chrome: 'mousewheel', Firefox: 'DOMMouseScroll', IE: 'onmousewheel'\r\n            this.eventListeners.push(\r\n                this.renderer.listen(this.zoomContainer.nativeElement, 'mousewheel', (event) => this.onMouseWheel(event))\r\n            );\r\n            this.eventListeners.push(\r\n                this.renderer.listen(this.zoomContainer.nativeElement, 'DOMMouseScroll', (event) => this.onMouseWheel(event))\r\n            );\r\n            this.eventListeners.push(\r\n                this.renderer.listen(this.zoomContainer.nativeElement, 'onmousewheel', (event) => this.onMouseWheel(event))\r\n            );\r\n        }\r\n        \r\n    }\r\n    private checkImagesLoaded() {\r\n        this.calculateRatioAndOffset();\r\n        if (this.thumbImageLoaded && this.fullImageLoaded) {\r\n            this.calculateImageAndLensPosition();\r\n            this.isReady = true;\r\n        }\r\n    }\r\n  \r\n    /**\r\n     * Zoom position setters\r\n     */\r\n    private setZoomPosition(left: number, top: number) {\r\n        this.latestMouseLeft = Number(left) || this.latestMouseLeft;\r\n        this.latestMouseTop = Number(top) || this.latestMouseTop;\r\n  \r\n        const c: zoomboxCoord = {\r\n            x: this.latestMouseLeft,\r\n            y: this.latestMouseTop\r\n        };\r\n        \r\n        this.zoomPosition.emit(c);\r\n    }\r\n  \r\n  \r\n    /**\r\n     * Mouse wheel event\r\n     */\r\n    private onMouseWheel(event: any) {\r\n        // Don't eat events if zooming isn't active\r\n        if (!this.zoomingEnabled || this.zoomFrozen) {\r\n            return;\r\n        }\r\n  \r\n        event = window.event || event; // old IE\r\n        const direction = Math.max(Math.min((event.wheelDelta || -event.detail), 1), -1);\r\n        if (direction > 0) {\r\n            // up\r\n            this.setMagnification = Math.min(this.magnification + this.scrollStepSize, this.maxZoomRatio);\r\n        } else {\r\n            // down\r\n            this.setMagnification = Math.max(this.magnification - this.scrollStepSize, this.minZoomRatio);\r\n        }\r\n        this.calculateRatio();\r\n        this.calculateZoomPosition(event);\r\n        this.cd.markForCheck()\r\n        // Prevent scrolling on page.\r\n        event.returnValue = false; // IE\r\n        if (event.preventDefault) {\r\n            event.preventDefault(); // Chrome & FF\r\n        }\r\n    }\r\n  \r\n    /**\r\n     * Hover mode\r\n     */\r\n    private hoverMouseEnter(event: MouseEvent) {\r\n        this.zoomOn(event);\r\n        \r\n    }\r\n  \r\n    private hoverMouseLeave() {\r\n        this.zoomOff();\r\n        \r\n    }\r\n  \r\n    private hoverMouseMove(event: MouseEvent) {\r\n        this.calculateZoomPosition(event);\r\n        \r\n    }\r\n  \r\n    /**\r\n     * Toggle mode\r\n     */\r\n    private toggleClick(event: MouseEvent) {\r\n      if (this.zoomingEnabled) {\r\n            this.zoomOff();\r\n        } else {\r\n            this.zoomOn(event);\r\n        }\r\n    }\r\n  \r\n    /**\r\n     * Click mode\r\n     */\r\n    private clickStarter(event: MouseEvent) {\r\n        if (this.zoomingEnabled === false) {\r\n            this.zoomOn(event);\r\n        }\r\n    }\r\n  \r\n    private clickMouseLeave() {\r\n        this.zoomOff();\r\n    }\r\n  \r\n    private clickMouseMove(event: MouseEvent) {\r\n        if (this.zoomingEnabled) {\r\n            this.calculateZoomPosition(event);\r\n        }\r\n        \r\n    }\r\n  \r\n    /**\r\n     * Hover freeze mode\r\n     */\r\n    private hoverFreezeMouseEnter(event: MouseEvent) {\r\n        if (this.zoomingEnabled && !this.zoomFrozen) {\r\n            this.zoomOn(event);\r\n        }\r\n    }\r\n  \r\n    private hoverFreezeMouseLeave() {\r\n        if (this.zoomingEnabled && !this.zoomFrozen) {\r\n            this.zoomOff();\r\n        }\r\n    }\r\n  \r\n    private hoverFreezeMouseMove(event: MouseEvent) {\r\n        if (this.zoomingEnabled && !this.zoomFrozen) {\r\n            this.calculateZoomPosition(event);\r\n            \r\n        }\r\n    }\r\n  \r\n    private hoverFreezeClick(event: MouseEvent) {\r\n        if (this.zoomingEnabled && this.zoomFrozen) {\r\n            this.zoomFrozen = false;\r\n            this.zoomOff();\r\n        } else if (this.zoomingEnabled) {\r\n            this.zoomFrozen = true;\r\n        } else {\r\n            this.zoomOn(event);\r\n        }\r\n    }\r\n  \r\n    /**\r\n     * Private helper methods\r\n     */\r\n    private zoomOn(event: MouseEvent) {\r\n        if (this.isReady) {\r\n            this.zoomingEnabled = true;\r\n            this.calculateRatioAndOffset();\r\n            if (this.enableOverlay)\r\n            {\r\n              this.displayLen=this.displayOverlay='block'\r\n              this.overlayVisible=true\r\n              this.displayInPic='none'\r\n            }\r\n            else \r\n            {\r\n              this.displayLen=this.displayInPic='block'\r\n              \r\n            }\r\n            this.calculateZoomPosition(event);\r\n            this.cd.markForCheck()\r\n        }\r\n    }\r\n  \r\n    private zoomOff() {\r\n        this.zoomingEnabled = false;\r\n        if (this.enableOverlay)\r\n          {\r\n          this.displayLen=this.displayOverlay='none'\r\n          this.overlayVisible=false\r\n      }\r\n        else \r\n        {\r\n          this.displayLen=this.displayInPic='none'\r\n          this.overlayVisible=false\r\n        }\r\n          this.cd.markForCheck()\r\n    }\r\n  \r\n    private calculateZoomPosition(event: MouseEvent) {\r\n        const newLeft = Math.max(Math.min(event.offsetX, this.thumbWidth), 0);\r\n        const newTop = Math.max(Math.min(event.offsetY, this.thumbHeight), 0);\r\n  \r\n        this.setZoomPosition(newLeft, newTop);\r\n  \r\n        this.calculateImageAndLensPosition();\r\n        this.cd.markForCheck()\r\n    }\r\n  \r\n    private calculateImageAndLensPosition() {\r\n        let lensLeftMod = 0;\r\n        let lensTopMod = 0;\r\n        let overlayLeftMod=0;\r\n        let overlayTopMod=0\r\n        \r\n        if (this.enableOverlay)\r\n        {\r\n          this.overlayHeight= this.defaultLenHeight/ this.thumbHeight*this.fullHeight\r\n          this.overlayWidth=this.defaultLenWidth/this.thumbWidth*this.fullWidth\r\n         this.overlayLeft= this.thumbWidth +this.zoomContainer.nativeElement.offsetLeft\r\n          this.overlayTop= this.zoomContainer.nativeElement.offsetTop\r\n          overlayLeftMod= this.latestMouseLeft-this.overlayWidth/2\r\n          overlayTopMod=this.latestMouseTop - this.overlayHeight / 2;\r\n          \r\n              if (overlayLeftMod<0) overlayLeftMod=0\r\n              else if (overlayLeftMod>(this.thumbWidth-this.overlayWidth)) overlayLeftMod=this.thumbWidth-this.overlayWidth\r\n              if (overlayTopMod<0) overlayTopMod=0\r\n              else if (overlayTopMod>(this.thumbHeight-this.overlayHeight)) overlayTopMod=this.thumbHeight-this.overlayHeight\r\n          \r\n        }\r\n        if (this.enableLens) {\r\n          this.lensLeft = this.latestMouseLeft - this.lensWidth / 2;\r\n          this.lensTop = this.latestMouseTop - this.lensHeight / 2;\r\n          \r\n              if (this.lensLeft<0) this.lensLeft=0\r\n              else if (this.lensLeft>(this.thumbWidth-this.lensWidth)) this.lensLeft=(this.thumbWidth-this.lensWidth)\r\n          \r\n              if (this.lensTop<0) this.lensTop=0\r\n              else if (this.lensTop>(this.thumbHeight-this.lensHeight)) this.lensTop=(this.thumbHeight-this.lensHeight)\r\n          \r\n          lensLeftMod =this.lensLeft\r\n          lensTopMod=this.lensTop\r\n        }\r\n        this.fullImageLeft = (this.latestMouseLeft * -this.xRatio) - ((this.enableOverlay)?overlayLeftMod:lensLeftMod) ;\r\n        \r\n        this.fullImageTop = (this.latestMouseTop * -this.yRatio) - ((this.enableOverlay)?overlayTopMod:lensTopMod) ;\r\n    }\r\n  \r\n    private calculateRatioAndOffset() {\r\n      \r\n        this.thumbWidth = this.imageThumbnail.nativeElement.naturalWidth;\r\n        this.thumbHeight = this.imageThumbnail.nativeElement.naturalHeight;\r\n  \r\n        // If lens is disabled, set lens size to equal thumb size and position it on top of the thumb\r\n        if (!this.enableLens) {\r\n            this.lensWidth = this.thumbWidth;\r\n            this.lensHeight = this.thumbHeight;\r\n            this.lensLeft = 0;\r\n            this.lensTop = 0;\r\n        }\r\n  \r\n        // getBoundingClientRect() ? https://stackoverflow.com/a/44008873\r\n        this.offsetTop = this.imageThumbnail.nativeElement.getBoundingClientRect().top;\r\n        this.offsetLeft = this.imageThumbnail.nativeElement.getBoundingClientRect().left;\r\n  \r\n        if (this.fullImage === undefined) {\r\n            this.fullImage = this.thumbImage;\r\n        }\r\n  \r\n        if (this.fullImageLoaded) {\r\n            this.fullWidth = this.fullSizeImage.nativeElement.naturalWidth;\r\n            this.fullHeight = this.fullSizeImage.nativeElement.naturalHeight;\r\n  \r\n            this.baseRatio = Math.max(\r\n                (this.thumbWidth / this.fullWidth),\r\n                (this.thumbHeight / this.fullHeight));\r\n  \r\n            // Don't allow zooming to smaller than thumbnail size\r\n            this.minZoomRatio = Math.max(this.minZoomRatio || 0, this.baseRatio || 0);\r\n  \r\n            this.calculateRatio();\r\n        }\r\n    }\r\n  \r\n    private calculateRatio() {\r\n        this.magnifiedWidth = (this.fullWidth * this.magnification);\r\n        this.magnifiedHeight = (this.fullHeight * this.magnification);\r\n        if (this.enableOverlay)\r\n        {\r\n          this.lensWidth=this.defaultLenWidth/this.magnification\r\n          this.lensHeight=this.defaultLenHeight/this.magnification\r\n          \r\n        }\r\n        this.xRatio = (this.magnifiedWidth - this.thumbWidth) / this.thumbWidth;\r\n        this.yRatio = (this.magnifiedHeight - this.thumbHeight) / this.thumbHeight;\r\n        \r\n    }\r\n    \r\n    \r\n  }\r\n\r\n","import { BidiModule } from '@angular/cdk/bidi';\r\nimport { OverlayModule } from '@angular/cdk/overlay';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { TDSZoomBoxComponent } from './tds-zoom-box'\r\n\r\n\r\n\r\n@NgModule({\r\n    declarations: [\r\n        TDSZoomBoxComponent\r\n    ],\r\n    imports: [        \r\n        CommonModule,\r\n        BidiModule,\r\n        OverlayModule\r\n    ],\r\n    exports: [\r\n        TDSZoomBoxComponent\r\n    ]\r\n})\r\nexport class TDSZoomBoxModule { }\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}