{"version":3,"file":"tds-ui-core-overlay.mjs","sources":["../../../projects/tds-ui/core/overlay/overlay-position.ts","../../../projects/tds-ui/core/overlay/tds-connected-overlay.ts","../../../projects/tds-ui/core/overlay/tds-overlay.module.ts","../../../projects/tds-ui/core/overlay/tds-ui-core-overlay.ts"],"sourcesContent":["\r\n\r\nimport { ConnectedOverlayPositionChange, ConnectionPositionPair } from '@angular/cdk/overlay';\r\n\r\nexport const POSITION_MAP: { [key: string]: ConnectionPositionPair } = {\r\n  top: new ConnectionPositionPair({ originX: 'center', originY: 'top' }, { overlayX: 'center', overlayY: 'bottom' }),\r\n  topCenter: new ConnectionPositionPair({ originX: 'center', originY: 'top' }, { overlayX: 'center', overlayY: 'bottom' }),\r\n  topLeft: new ConnectionPositionPair({ originX: 'start', originY: 'top' }, { overlayX: 'start', overlayY: 'bottom' }),\r\n  topRight: new ConnectionPositionPair({ originX: 'end', originY: 'top' }, { overlayX: 'end', overlayY: 'bottom' }),\r\n  right: new ConnectionPositionPair({ originX: 'end', originY: 'center' }, { overlayX: 'start', overlayY: 'center' }),\r\n  rightTop: new ConnectionPositionPair({ originX: 'end', originY: 'top' }, { overlayX: 'start', overlayY: 'top' }),\r\n  rightBottom: new ConnectionPositionPair({ originX: 'end', originY: 'bottom' }, { overlayX: 'start', overlayY: 'bottom' }),\r\n  bottom: new ConnectionPositionPair({ originX: 'center', originY: 'bottom' }, { overlayX: 'center', overlayY: 'top' }),\r\n  bottomCenter: new ConnectionPositionPair({ originX: 'center', originY: 'bottom' }, { overlayX: 'center', overlayY: 'top' }),\r\n  bottomLeft: new ConnectionPositionPair({ originX: 'start', originY: 'bottom' }, { overlayX: 'start', overlayY: 'top' }),\r\n  bottomRight: new ConnectionPositionPair({ originX: 'end', originY: 'bottom' }, { overlayX: 'end', overlayY: 'top' }),\r\n  left: new ConnectionPositionPair({ originX: 'start', originY: 'center' }, { overlayX: 'end', overlayY: 'center' }),\r\n  leftTop: new ConnectionPositionPair({ originX: 'start', originY: 'top' }, { overlayX: 'end', overlayY: 'top' }),\r\n  leftBottom: new ConnectionPositionPair({ originX: 'start', originY: 'bottom' }, { overlayX: 'end', overlayY: 'bottom' })\r\n};\r\n\r\nexport const DEFAULT_TOOLTIP_POSITIONS = [POSITION_MAP.top, POSITION_MAP.right, POSITION_MAP.bottom, POSITION_MAP.left];\r\n\r\nexport const DEFAULT_CASCADER_POSITIONS = [POSITION_MAP.bottomLeft, POSITION_MAP.bottomRight, POSITION_MAP.topLeft, POSITION_MAP.topRight];\r\n\r\nexport const DEFAULT_MENTION_TOP_POSITIONS = [\r\n  new ConnectionPositionPair({ originX: 'start', originY: 'bottom' }, { overlayX: 'start', overlayY: 'bottom' }),\r\n  new ConnectionPositionPair({ originX: 'start', originY: 'bottom' }, { overlayX: 'end', overlayY: 'bottom' })\r\n];\r\n\r\nexport const DEFAULT_MENTION_BOTTOM_POSITIONS = [\r\n  POSITION_MAP.bottomLeft,\r\n  new ConnectionPositionPair({ originX: 'start', originY: 'bottom' }, { overlayX: 'end', overlayY: 'top' })\r\n];\r\n\r\nexport function getPlacementName(position: ConnectedOverlayPositionChange): string | undefined {\r\n  for (const placement in POSITION_MAP) {\r\n    if (\r\n      position.connectionPair.originX === POSITION_MAP[placement].originX &&\r\n      position.connectionPair.originY === POSITION_MAP[placement].originY &&\r\n      position.connectionPair.overlayX === POSITION_MAP[placement].overlayX &&\r\n      position.connectionPair.overlayY === POSITION_MAP[placement].overlayY\r\n    ) {\r\n      return placement;\r\n    }\r\n  }\r\n  return undefined;\r\n}\r\n","\r\nimport {\r\n  CdkConnectedOverlay,\r\n  CdkOverlayOrigin,\r\n  ConnectedOverlayPositionChange,\r\n  FlexibleConnectedPositionStrategyOrigin\r\n} from '@angular/cdk/overlay';\r\nimport { Directive, ElementRef, Input } from '@angular/core';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { TDSDestroyService } from 'tds-ui/core/services';\r\nimport { InputBoolean } from 'tds-ui/shared/utility';\r\n\r\nimport { getPlacementName } from './overlay-position';\r\n\r\n/** Equivalent of `ClientRect` without some of the properties we don't care about. */\r\ntype Dimensions = Omit<ClientRect, 'x' | 'y' | 'toJSON'>;\r\n\r\n@Directive({\r\n  selector: '[cdkConnectedOverlay][tdsConnectedOverlay]',\r\n  exportAs: 'tdsConnectedOverlay',\r\n  providers: [TDSDestroyService]\r\n})\r\nexport class TDSConnectedOverlayDirective {\r\n  @Input() @InputBoolean() tdsArrowPointAtCenter: boolean = false;\r\n\r\n  constructor(\r\n    private readonly cdkConnectedOverlay: CdkConnectedOverlay,\r\n    private readonly TDSDestroyService: TDSDestroyService\r\n  ) {\r\n    this.cdkConnectedOverlay.backdropClass = 'nz-overlay-transparent-backdrop';\r\n\r\n    this.cdkConnectedOverlay.positionChange\r\n      .pipe(takeUntil(this.TDSDestroyService))\r\n      .subscribe((position: ConnectedOverlayPositionChange) => {\r\n        if (this.tdsArrowPointAtCenter) {\r\n          this.updateArrowPosition(position);\r\n        }\r\n      });\r\n  }\r\n\r\n  private updateArrowPosition(position: ConnectedOverlayPositionChange): void {\r\n    const originRect = this.getOriginRect();\r\n    const placement = getPlacementName(position);\r\n\r\n    let offsetX: number | undefined = 0;\r\n    let offsetY: number | undefined = 0;\r\n\r\n    if (placement === 'topLeft' || placement === 'bottomLeft') {\r\n      offsetX = originRect.width / 2 - 14;\r\n    } else if (placement === 'topRight' || placement === 'bottomRight') {\r\n      offsetX = -(originRect.width / 2 - 14);\r\n    } else if (placement === 'leftTop' || placement === 'rightTop') {\r\n      offsetY = originRect.height / 2 - 10;\r\n    } else if (placement === 'leftBottom' || placement === 'rightBottom') {\r\n      offsetY = -(originRect.height / 2 - 10);\r\n    }\r\n\r\n    if (this.cdkConnectedOverlay.offsetX !== offsetX || this.cdkConnectedOverlay.offsetY !== offsetY) {\r\n      this.cdkConnectedOverlay.offsetY = offsetY;\r\n      this.cdkConnectedOverlay.offsetX = offsetX;\r\n      this.cdkConnectedOverlay.overlayRef.updatePosition();\r\n    }\r\n  }\r\n\r\n  private getFlexibleConnectedPositionStrategyOrigin(): FlexibleConnectedPositionStrategyOrigin {\r\n    if (this.cdkConnectedOverlay.origin instanceof CdkOverlayOrigin) {\r\n      return this.cdkConnectedOverlay.origin.elementRef;\r\n    } else {\r\n      return this.cdkConnectedOverlay.origin;\r\n    }\r\n  }\r\n\r\n  private getOriginRect(): Dimensions {\r\n    const origin = this.getFlexibleConnectedPositionStrategyOrigin();\r\n\r\n    if (origin instanceof ElementRef) {\r\n      return origin.nativeElement.getBoundingClientRect();\r\n    }\r\n\r\n    // Check for Element so SVG elements are also supported.\r\n    if (origin instanceof Element) {\r\n      return origin.getBoundingClientRect();\r\n    }\r\n\r\n    const width = origin.width || 0;\r\n    const height = origin.height || 0;\r\n\r\n    // If the origin is a point, return a client rect as if it was a 0x0 element at the point.\r\n    return {\r\n      top: origin.y,\r\n      bottom: origin.y + height,\r\n      left: origin.x,\r\n      right: origin.x + width,\r\n      height,\r\n      width\r\n    };\r\n  }\r\n}\r\n","\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { TDSConnectedOverlayDirective } from './tds-connected-overlay';\r\n\r\n@NgModule({\r\n  declarations: [TDSConnectedOverlayDirective],\r\n  exports: [TDSConnectedOverlayDirective]\r\n})\r\nexport class TDSOverlayModule {}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}