{"version":3,"file":"tds-ui-core-config.mjs","sources":["../../../projects/tds-ui/core/config/config.service.ts","../../../projects/tds-ui/core/config/tds-ui-core-config.ts"],"sourcesContent":["\r\nimport { Inject, Injectable, InjectionToken, Optional } from \"@angular/core\";\r\nimport { Observable, Subject } from \"rxjs\";\r\nimport { filter, mapTo } from \"rxjs/operators\";\r\nimport { TDSSafeAny } from \"tds-ui/shared/utility\";\r\nimport { TDSConfig, TDSConfigKey } from \"./config\";\r\nconst isDefined = function (value?: any): boolean {\r\n  return value !== undefined;\r\n};\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TDSConfigService {\r\n  private configUpdated$ = new Subject<keyof TDSConfig>();\r\n  private readonly config: TDSConfig;\r\n  constructor(@Optional() @Inject(TDS_CONFIG) defaultConfig?: TDSConfig) {\r\n    this.config = defaultConfig || {};\r\n  }\r\n\r\n  getConfig(): TDSConfig {\r\n    return this.config;\r\n  }\r\n\r\n  getConfigForComponent<T extends TDSConfigKey>(componentName: T): TDSConfig[T] {\r\n    return this.config[componentName];\r\n  }\r\n\r\n  getConfigChangeEventForComponent(componentName: TDSConfigKey): Observable<void> {\r\n    return this.configUpdated$.pipe(\r\n      filter(n => n === componentName),\r\n      mapTo(undefined)\r\n    );\r\n  }\r\n\r\n  set<T extends TDSConfigKey>(componentName: T, value: TDSConfig[T]): void {\r\n    this.config[componentName] = { ...this.config[componentName], ...value };\r\n    this.configUpdated$.next(componentName);\r\n  }\r\n}\r\nexport function WithConfig<T>() {\r\n    return function ConfigDecorator(\r\n      target: TDSSafeAny,\r\n      propName: TDSSafeAny,\r\n      originalDescriptor?: TypedPropertyDescriptor<T>\r\n    ): TDSSafeAny {\r\n      const privatePropName = `$$__zorroConfigDecorator__${propName}`;\r\n  \r\n      Object.defineProperty(target, privatePropName, {\r\n        configurable: true,\r\n        writable: true,\r\n        enumerable: false\r\n      });\r\n  \r\n      return {\r\n        get(): T | undefined {\r\n          const originalValue = originalDescriptor?.get ? originalDescriptor.get.bind(this)() : this[privatePropName];\r\n          const assignedByUser = (this.propertyAssignCounter?.[propName] || 0) > 1;\r\n          const configValue = this.tdsConfigService.getConfigForComponent(this._tdsModuleName)?.[propName];\r\n          if (assignedByUser && isDefined(originalValue)) {\r\n            return originalValue;\r\n          } else {\r\n            return isDefined(configValue) ? configValue : originalValue;\r\n          }\r\n        },\r\n        set(value?: T): void {\r\n          this.propertyAssignCounter = this.propertyAssignCounter || {};\r\n          this.propertyAssignCounter[propName] = (this.propertyAssignCounter[propName] || 0) + 1;\r\n  \r\n          if (originalDescriptor?.set) {\r\n            originalDescriptor.set.bind(this)(value!);\r\n          } else {\r\n            this[privatePropName] = value;\r\n          }\r\n        },\r\n        configurable: true,\r\n        enumerable: true\r\n      };\r\n    };\r\n  }\r\n\r\nexport const TDS_CONFIG = new InjectionToken<TDSConfig>('tds-config');\r\n\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}