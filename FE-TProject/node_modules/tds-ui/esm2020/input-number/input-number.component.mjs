import { __decorate } from "tslib";
import { DOWN_ARROW, ENTER, UP_ARROW } from '@angular/cdk/keycodes';
import { ChangeDetectionStrategy, Component, EventEmitter, forwardRef, Host, Inject, Input, Optional, Output, Self, ViewChild, ViewEncapsulation } from '@angular/core';
import { fromEvent, Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { TDSFormFieldControl, TDS_FORM_FIELD } from 'tds-ui/form-field';
import { InputBoolean, TDSHelperObject } from 'tds-ui/shared/utility';
import { isNotNil } from 'tds-ui/core/util';
import { coerceBooleanProperty } from 'tds-ui/shared/coercion';
import { TDSIsErrorState } from 'tds-ui/shared/common';
import * as i0 from "@angular/core";
import * as i1 from "@angular/cdk/a11y";
import * as i2 from "@angular/cdk/bidi";
import * as i3 from "@angular/forms";
import * as i4 from "@angular/common";
import * as i5 from "tds-ui/form-field";
const _c0 = ["inputElement"];
const _c1 = function (a0, a1, a2) { return { "py-2": a0, "py-1": a1, "py-1.5": a2 }; };
const _c2 = function (a0) { return { "hidden": a0 }; };
const _c3 = function (a0, a1) { return { "text-xs": a0, "text-sm": a1 }; };
const _c4 = function (a0, a1) { return { "pr-8": a0, "pr-3": a1 }; };
export class TDSInputNumberComponent {
    constructor(ngZone, elementRef, cdr, focusMonitor, directionality, _formField, _parentForm, _parentFormGroup, ngControl) {
        this.ngZone = ngZone;
        this.elementRef = elementRef;
        this.cdr = cdr;
        this.focusMonitor = focusMonitor;
        this.directionality = directionality;
        this._formField = _formField;
        this._parentForm = _parentForm;
        this._parentFormGroup = _parentFormGroup;
        this.ngControl = ngControl;
        this.value = null;
        this.destroy$ = new Subject();
        this.stateChanges = new Subject();
        this.parentIsFormField = false;
        this.isFocused = false;
        this.disabledUp = false;
        this.disabledDown = false;
        this.dir = 'ltr';
        this.onChange = () => { };
        this.onTouched = () => { };
        this.tdsBlur = new EventEmitter();
        this.tdsFocus = new EventEmitter();
        this.min = -Infinity;
        this.max = Infinity;
        this.parser = (value) => value
            .trim()
            .replace(/。/g, '.')
            .replace(/[^\w\.-]+/g, '');
        this.precisionMode = 'toFixed';
        this.placeholder = '';
        this.step = 1;
        this.inputMode = 'decimal';
        this.id = null;
        this.disabled = false;
        this.autoFocus = false;
        this.formatter = value => value;
        this._size = 'md';
        // ngControl, focused, empty, required,
        this.errorState = false;
        this._required = false;
        this.hiddenIcon = false;
        /**
         *
         */
        this.autoFormat = false;
        // TODO: move to host after View Engine deprecation
        this.elementRef.nativeElement.classList.add('tds-input-number');
        if (this.ngControl != null) {
            this.ngControl.valueAccessor = this;
        }
        if (this._formField) {
            // this.size = this._formField.size;
            this.parentIsFormField = true;
        }
    }
    get size() {
        return this._size;
    }
    set size(value) {
        if (this._size != value) {
            this._size = value;
            this.stateChanges.next();
        }
    }
    updateErrorState() {
        const oldState = this.errorState;
        const parent = this._parentFormGroup || this._parentForm;
        // const matcher = this.errorStateMatcher || this._defaultErrorStateMatcher;
        const control = this.ngControl ? this.ngControl.control : null;
        const newState = this._isErrorState(control, parent);
        if (newState !== oldState) {
            this.errorState = newState;
            this.stateChanges.next();
            this.cdr.markForCheck();
        }
    }
    _isErrorState(control, form) {
        return TDSIsErrorState(control, form);
    }
    get focused() {
        return this.isFocused;
    }
    get empty() {
        return !TDSHelperObject.hasValue(this.value);
    }
    get required() {
        return this._required;
    }
    set required(value) {
        this._required = coerceBooleanProperty(value);
        this.stateChanges.next();
    }
    // setDescribedByIds, onContainerClickts
    setDescribedByIds(ids) {
        if (ids.length) {
            this.elementRef.nativeElement.setAttribute('aria-describedby', ids.join(' '));
        }
        else {
            this.elementRef.nativeElement.removeAttribute('aria-describedby');
        }
    }
    onContainerClick(e) {
        // e.preventDefault();
        // e.stopPropagation();
    }
    onModelChange(value) {
        const parsedValue = this.parser(value);
        this.parsedValue = parsedValue;
        const validValue = this.getCurrentValidValue(this.parsedValue);
        this.setValue(validValue);
        if (this.autoFormat) {
            this.updateDisplayValue(this.value);
        }
    }
    getCurrentValidValue(value) {
        let val = value;
        if (val === '') {
            val = '';
        }
        else if (!this.isNotCompleteNumber(val)) {
            val = `${this.getValidValue(val)}`;
        }
        else {
            val = this.value;
        }
        return this.toNumber(val);
    }
    // '1.' '1x' 'xx' '' => are not complete numbers
    isNotCompleteNumber(num) {
        return (isNaN(num) ||
            num === '' ||
            num === null ||
            !!(num && num.toString().indexOf('.') === num.toString().length - 1));
    }
    getValidValue(value) {
        let val = parseFloat(value);
        // https://github.com/tds-design/tds-design/issues/7358
        if (isNaN(val)) {
            return value;
        }
        if (val < this.min) {
            val = this.min;
        }
        if (val > this.max) {
            val = this.max;
        }
        return val;
    }
    toNumber(num) {
        if (this.isNotCompleteNumber(num)) {
            return num;
        }
        const numStr = String(num);
        if (numStr.indexOf('.') >= 0 && isNotNil(this.precision)) {
            if (typeof this.precisionMode === 'function') {
                return this.precisionMode(num, this.precision);
            }
            else if (this.precisionMode === 'cut') {
                const numSplit = numStr.split('.');
                numSplit[1] = numSplit[1].slice(0, this.precision);
                return Number(numSplit.join('.'));
            }
            return Number(Number(num).toFixed(this.precision));
        }
        return Number(num);
    }
    getRatio(e) {
        let ratio = 1;
        if (e.metaKey || e.ctrlKey) {
            ratio = 0.1;
        }
        else if (e.shiftKey) {
            ratio = 10;
        }
        return ratio;
    }
    down(e, ratio) {
        if (!this.isFocused) {
            this.focus();
        }
        this.onStep('down', e, ratio);
    }
    up(e, ratio) {
        if (!this.isFocused) {
            this.focus();
        }
        this.onStep('up', e, ratio);
    }
    getPrecision(value) {
        const valueString = value.toString();
        if (valueString.indexOf('e-') >= 0) {
            return parseInt(valueString.slice(valueString.indexOf('e-') + 2), 10);
        }
        let precision = 0;
        if (valueString.indexOf('.') >= 0) {
            precision = valueString.length - valueString.indexOf('.') - 1;
        }
        return precision;
    }
    // step={1.0} value={1.51}
    // press +
    // then value should be 2.51, rather than 2.5
    // if this.props.precision is undefined
    // https://github.com/react-component/input-number/issues/39
    getMaxPrecision(currentValue, ratio) {
        if (isNotNil(this.precision)) {
            return this.precision;
        }
        const ratioPrecision = this.getPrecision(ratio);
        const stepPrecision = this.getPrecision(this.step);
        const currentValuePrecision = this.getPrecision(currentValue);
        if (!currentValue) {
            return ratioPrecision + stepPrecision;
        }
        return Math.max(currentValuePrecision, ratioPrecision + stepPrecision);
    }
    getPrecisionFactor(currentValue, ratio) {
        const precision = this.getMaxPrecision(currentValue, ratio);
        return Math.pow(10, precision);
    }
    upStep(val, rat) {
        const precisionFactor = this.getPrecisionFactor(val, rat);
        const precision = Math.abs(this.getMaxPrecision(val, rat));
        let result;
        if (typeof val === 'number') {
            result = ((precisionFactor * val + precisionFactor * this.step * rat) / precisionFactor).toFixed(precision);
        }
        else {
            result = this.min === -Infinity ? this.step : this.min;
        }
        return this.toNumber(result);
    }
    downStep(val, rat) {
        const precisionFactor = this.getPrecisionFactor(val, rat);
        const precision = Math.abs(this.getMaxPrecision(val, rat));
        let result;
        if (typeof val === 'number') {
            result = ((precisionFactor * val - precisionFactor * this.step * rat) / precisionFactor).toFixed(precision);
        }
        else {
            result = this.min === -Infinity ? -this.step : this.min;
        }
        return this.toNumber(result);
    }
    onStep(type, e, ratio = 1) {
        this.stop();
        e.preventDefault();
        if (this.disabled) {
            return;
        }
        const value = this.getCurrentValidValue(this.parsedValue) || 0;
        let val = 0;
        if (type === 'up') {
            val = this.upStep(value, ratio);
        }
        else if (type === 'down') {
            val = this.downStep(value, ratio);
        }
        const outOfRange = val > this.max || val < this.min;
        if (val > this.max) {
            val = this.max;
        }
        else if (val < this.min) {
            val = this.min;
        }
        this.setValue(val);
        this.updateDisplayValue(val);
        this.isFocused = true;
        this.stateChanges.next();
        if (outOfRange) {
            return;
        }
        this.autoStepTimer = setTimeout(() => {
            this[type](e, ratio);
        }, 300);
    }
    stop() {
        if (this.autoStepTimer) {
            clearTimeout(this.autoStepTimer);
        }
    }
    setValue(value) {
        if (`${this.value}` !== `${value}`) {
            this.onChange(value);
        }
        this.value = value;
        this.parsedValue = value;
        this.disabledUp = this.disabledDown = false;
        if (value || value === 0) {
            const val = Number(value);
            if (val >= this.max) {
                this.disabledUp = true;
            }
            if (val <= this.min) {
                this.disabledDown = true;
            }
        }
    }
    updateDisplayValue(value) {
        const displayValue = isNotNil(this.formatter(value)) ? this.formatter(value) : '';
        this.displayValue = displayValue;
        this.inputElement.nativeElement.value = `${displayValue}`;
    }
    // onKeyDown(e: KeyboardEvent): void {
    //   if (e.keyCode === UP_ARROW) {
    //     const ratio = this.getRatio(e);
    //     this.up(e, ratio);
    //     this.stop();
    //   } else if (e.keyCode === DOWN_ARROW) {
    //     const ratio = this.getRatio(e);
    //     this.down(e, ratio);
    //     this.stop();
    //   } else if (e.keyCode === ENTER) {
    //     this.updateDisplayValue(this.value!);
    //   }
    // }
    writeValue(value) {
        this.value = value;
        this.setValue(value);
        this.updateDisplayValue(value);
        this.cdr.markForCheck();
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    setDisabledState(disabled) {
        this.disabled = disabled;
        this.cdr.markForCheck();
    }
    focus() {
        this.focusMonitor.focusVia(this.inputElement, 'keyboard');
    }
    blur() {
        this.inputElement.nativeElement.blur();
    }
    ngOnInit() {
        this.focusMonitor
            .monitor(this.elementRef, true)
            .pipe(takeUntil(this.destroy$))
            .subscribe(focusOrigin => {
            if (!focusOrigin) {
                this.isFocused = false;
                this.updateDisplayValue(this.value);
                this.tdsBlur.emit();
                this.stateChanges.next();
                Promise.resolve().then(() => this.onTouched());
            }
            else {
                this.isFocused = true;
                this.stateChanges.next();
                this.tdsFocus.emit();
            }
        });
        this.dir = this.directionality.value;
        this.directionality.change?.pipe(takeUntil(this.destroy$)).subscribe((direction) => {
            this.dir = direction;
        });
        this.ngZone.runOutsideAngular(() => {
            fromEvent(this.inputElement.nativeElement, 'keyup')
                .pipe(takeUntil(this.destroy$))
                .subscribe(() => this.stop());
            fromEvent(this.inputElement.nativeElement, 'keydown')
                .pipe(takeUntil(this.destroy$))
                .subscribe(event => {
                const { keyCode } = event;
                if (keyCode !== UP_ARROW && keyCode !== DOWN_ARROW && keyCode !== ENTER) {
                    return;
                }
                this.ngZone.run(() => {
                    if (keyCode === UP_ARROW) {
                        const ratio = this.getRatio(event);
                        this.up(event, ratio);
                        this.stop();
                    }
                    else if (keyCode === DOWN_ARROW) {
                        const ratio = this.getRatio(event);
                        this.down(event, ratio);
                        this.stop();
                    }
                    else {
                        this.updateDisplayValue(this.value);
                    }
                    this.cdr.markForCheck();
                });
            });
        });
    }
    ngOnChanges(changes) {
        if (changes.formatter && !changes.formatter.isFirstChange()) {
            const validValue = this.getCurrentValidValue(this.parsedValue);
            this.setValue(validValue);
            this.updateDisplayValue(validValue);
        }
    }
    ngAfterViewInit() {
        if (this.autoFocus) {
            this.focus();
        }
    }
    ngOnDestroy() {
        this.focusMonitor.stopMonitoring(this.elementRef);
        this.destroy$.next();
        this.destroy$.complete();
    }
    ngDoCheck() {
        if (this.ngControl) {
            this.updateErrorState();
        }
    }
}
TDSInputNumberComponent.ɵfac = function TDSInputNumberComponent_Factory(t) { return new (t || TDSInputNumberComponent)(i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i1.FocusMonitor), i0.ɵɵdirectiveInject(i2.Directionality, 8), i0.ɵɵdirectiveInject(TDS_FORM_FIELD, 9), i0.ɵɵdirectiveInject(i3.NgForm, 8), i0.ɵɵdirectiveInject(i3.FormGroupDirective, 8), i0.ɵɵdirectiveInject(i3.NgControl, 10)); };
TDSInputNumberComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TDSInputNumberComponent, selectors: [["tds-input-number"]], viewQuery: function TDSInputNumberComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0, 7);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.inputElement = _t.first);
    } }, hostAttrs: [1, "inline-block", "box-border", "relative", "min-w-0", "group", "outline-none", "w-full"], hostVars: 30, hostBindings: function TDSInputNumberComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵclassProp("tds-input-number-focused", ctx.isFocused)("tds-input-number-disabled", ctx.disabled)("bg-neutral-3-50", ctx.disabled)("cursor-not-allowed", ctx.disabled)("tds-input-number-rtl", ctx.dir === "rtl")("border", !ctx.parentIsFormField)("border-neutral-2-200", !ctx.parentIsFormField && !ctx.isFocused)("dark:border-d-neutral-2-200", !ctx.parentIsFormField && !ctx.isFocused)("border-primary-1", !ctx.parentIsFormField && ctx.isFocused)("ring", !ctx.parentIsFormField && ctx.isFocused)("ring-opacity-20", !ctx.parentIsFormField && ctx.isFocused)("ring-primary-1", !ctx.parentIsFormField && ctx.isFocused)("rounded", !ctx.parentIsFormField)("bg-white", !ctx.parentIsFormField && !ctx.disabled)("dark:bg-d-neutral-3-50", !ctx.parentIsFormField && !ctx.disabled);
    } }, inputs: { min: "min", max: "max", parser: "parser", precision: "precision", precisionMode: "precisionMode", placeholder: "placeholder", step: "step", inputMode: "inputMode", id: "id", disabled: "disabled", autoFocus: "autoFocus", formatter: "formatter", size: "size", required: "required", hiddenIcon: "hiddenIcon", autoFormat: "autoFormat" }, outputs: { tdsBlur: "tdsBlur", tdsFocus: "tdsFocus" }, exportAs: ["tdsInputNumber"], features: [i0.ɵɵProvidersFeature([
            {
                provide: TDSFormFieldControl,
                useExisting: forwardRef(() => TDSInputNumberComponent),
                multi: true
            }
        ]), i0.ɵɵNgOnChangesFeature], decls: 10, vars: 39, consts: [[1, "box-border", "min-w-0", "inline-block", "w-full", 3, "ngClass"], [1, "tds-input-number-handler-wrap", "absolute", "right-0", "top-0", "bottom-0", "w-8", 3, "ngClass"], [1, "w-full", "h-full", "flex", "flex-col", "items-center"], ["unselectable", "unselectable", 1, "tds-input-number-handler", "w-full", "text-center", "tds-input-number-handler-up", "h-1/2", "flex", "flex-col-reverse", "hover:bg-neutral-3-50", "hover:text-neutral-1-900", "dark:hover:text-d-neutral-1-900", "dark:hover:bg-d-neutral-3-400", "text-neutral-1-500", "dark:text-d-neutral-1-500", 3, "mousedown", "mouseup", "mouseleave"], [1, "tdsi-arrow-up-fill", "leading-3", "tds-input-number-handler-up-inner", 3, "ngClass"], ["unselectable", "unselectable", 1, "tds-input-number-handler", "w-full", "text-center", "tds-input-number-handler-down", "h-1/2", "flex", "flex-col", "hover:bg-neutral-3-50", "hover:text-neutral-1-900", "dark:hover:text-d-neutral-1-900", "dark:hover:bg-d-neutral-3-400", "text-neutral-1-500", "dark:text-d-neutral-1-500", 3, "mousedown", "mouseup", "mouseleave"], [1, "tdsi-arrow-down-fill", "leading-3", "tds-input-number-handler-down-inner", 3, "ngClass"], [1, "tds-input-number-input-wrap", "pl-3", 3, "ngClass"], ["autocomplete", "off", 1, "tds-input-number-input", "flex", "items-center", "text-body-2", "focus:outline-none", "focus:border-transparent", "shadow-none", "border-0", "bg-transparent", "text-current", "p-0", "m-0", "w-full", "outline-none", "box-border", "placeholder:text-neutral-1-400", "dark:placeholder:text-d-neutral-1-400", 3, "disabled", "placeholder", "ngModel", "ngModelChange"], ["inputElement", ""]], template: function TDSInputNumberComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "span", 3);
        i0.ɵɵlistener("mousedown", function TDSInputNumberComponent_Template_span_mousedown_3_listener($event) { return ctx.up($event); })("mouseup", function TDSInputNumberComponent_Template_span_mouseup_3_listener() { return ctx.stop(); })("mouseleave", function TDSInputNumberComponent_Template_span_mouseleave_3_listener() { return ctx.stop(); });
        i0.ɵɵelement(4, "i", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(5, "span", 5);
        i0.ɵɵlistener("mousedown", function TDSInputNumberComponent_Template_span_mousedown_5_listener($event) { return ctx.down($event); })("mouseup", function TDSInputNumberComponent_Template_span_mouseup_5_listener() { return ctx.stop(); })("mouseleave", function TDSInputNumberComponent_Template_span_mouseleave_5_listener() { return ctx.stop(); });
        i0.ɵɵelement(6, "i", 6);
        i0.ɵɵelementEnd()()();
        i0.ɵɵelementStart(7, "div", 7)(8, "input", 8, 9);
        i0.ɵɵlistener("ngModelChange", function TDSInputNumberComponent_Template_input_ngModelChange_8_listener($event) { return ctx.onModelChange($event); });
        i0.ɵɵelementEnd()()();
    } if (rf & 2) {
        i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction3(24, _c1, ctx.size === "lg", ctx.size === "sm", ctx.size === "md"));
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction1(28, _c2, ctx.disabled || ctx.hiddenIcon));
        i0.ɵɵadvance(2);
        i0.ɵɵclassProp("cursor-pointer", !ctx.disabledUp)("tds-input-number-handler-up-disabled", ctx.disabledUp);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction2(30, _c3, ctx.size == "sm", ctx.size !== "sm"));
        i0.ɵɵadvance(1);
        i0.ɵɵclassProp("tds-input-number-handler-down-disabled", ctx.disabledDown)("cursor-pointer", !ctx.disabledDown);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction2(33, _c3, ctx.size == "sm", ctx.size !== "sm"));
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction2(36, _c4, !(ctx.disabled || ctx.hiddenIcon), ctx.disabled || ctx.hiddenIcon));
        i0.ɵɵadvance(1);
        i0.ɵɵclassProp("cursor-not-allowed", ctx.disabled);
        i0.ɵɵproperty("disabled", ctx.disabled)("placeholder", ctx.placeholder)("ngModel", ctx.displayValue);
        i0.ɵɵattribute("id", ctx.id)("autofocus", ctx.autoFocus ? "autofocus" : null)("min", ctx.min)("max", ctx.max)("step", ctx.step)("inputmode", ctx.inputMode);
    } }, directives: [i4.NgClass, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel], encapsulation: 2, changeDetection: 0 });
__decorate([
    InputBoolean()
], TDSInputNumberComponent.prototype, "disabled", void 0);
__decorate([
    InputBoolean()
], TDSInputNumberComponent.prototype, "autoFocus", void 0);
__decorate([
    InputBoolean()
], TDSInputNumberComponent.prototype, "hiddenIcon", void 0);
__decorate([
    InputBoolean()
], TDSInputNumberComponent.prototype, "autoFormat", void 0);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSInputNumberComponent, [{
        type: Component,
        args: [{ selector: 'tds-input-number', exportAs: 'tdsInputNumber', providers: [
                    {
                        provide: TDSFormFieldControl,
                        useExisting: forwardRef(() => TDSInputNumberComponent),
                        multi: true
                    }
                ], changeDetection: ChangeDetectionStrategy.OnPush, encapsulation: ViewEncapsulation.None, host: {
                    '[class.tds-input-number-focused]': 'isFocused',
                    '[class.tds-input-number-disabled]': 'disabled',
                    '[class.bg-neutral-3-50]': 'disabled',
                    '[class.cursor-not-allowed]': 'disabled',
                    '[class.tds-input-number-rtl]': `dir === 'rtl'`,
                    '[class.border]': "!parentIsFormField",
                    '[class.border-neutral-2-200]': "!parentIsFormField && !isFocused",
                    '[class.dark:border-d-neutral-2-200]': "!parentIsFormField && !isFocused",
                    '[class.border-primary-1]': "!parentIsFormField && isFocused",
                    '[class.ring]': "!parentIsFormField && isFocused",
                    '[class.ring-opacity-20]': "!parentIsFormField && isFocused",
                    '[class.ring-primary-1]': "!parentIsFormField && isFocused",
                    '[class.rounded]': "!parentIsFormField ",
                    '[class.bg-white]': "!parentIsFormField && !disabled",
                    '[class.dark:bg-d-neutral-3-50]': "!parentIsFormField && !disabled",
                    'class': 'inline-block box-border relative min-w-0 group outline-none w-full'
                }, template: "<div class=\"box-border  min-w-0  inline-block w-full\"\r\n    [ngClass]=\"{'py-2':size === 'lg', 'py-1':size === 'sm','py-1.5': size === 'md'}\">\r\n\r\n    <div class=\"tds-input-number-handler-wrap absolute right-0 top-0 bottom-0 w-8\" [ngClass]=\"{'hidden':disabled || hiddenIcon}\">\r\n        <div class=\"w-full h-full flex  flex-col items-center\" >\r\n            <span unselectable=\"unselectable\"\r\n                class=\"tds-input-number-handler w-full text-center tds-input-number-handler-up h-1/2 flex flex-col-reverse hover:bg-neutral-3-50 hover:text-neutral-1-900 dark:hover:text-d-neutral-1-900 dark:hover:bg-d-neutral-3-400 text-neutral-1-500 dark:text-d-neutral-1-500\"\r\n                (mousedown)=\"up($event)\" (mouseup)=\"stop()\" (mouseleave)=\"stop()\" [class.cursor-pointer]=\"!disabledUp\"\r\n                [class.tds-input-number-handler-up-disabled]=\"disabledUp\">\r\n                <i [ngClass]=\"{'text-xs':size == 'sm','text-sm':size !== 'sm'}\"\r\n                    class=\"tdsi-arrow-up-fill leading-3  tds-input-number-handler-up-inner  \"></i>\r\n            </span>\r\n            <span unselectable=\"unselectable\"\r\n                class=\"tds-input-number-handler w-full text-center tds-input-number-handler-down  h-1/2 flex flex-col hover:bg-neutral-3-50 hover:text-neutral-1-900 dark:hover:text-d-neutral-1-900 dark:hover:bg-d-neutral-3-400 text-neutral-1-500 dark:text-d-neutral-1-500\"\r\n                (mousedown)=\"down($event)\" (mouseup)=\"stop()\" (mouseleave)=\"stop()\"\r\n                [class.tds-input-number-handler-down-disabled]=\"disabledDown\" [class.cursor-pointer]=\"!disabledDown\">\r\n                <i [ngClass]=\"{'text-xs':size == 'sm','text-sm':size !== 'sm'}\"\r\n                    class=\"tdsi-arrow-down-fill leading-3  tds-input-number-handler-down-inner \"></i>\r\n            </span>\r\n        </div>\r\n\r\n    </div>\r\n    <div class=\"tds-input-number-input-wrap pl-3\"  [ngClass]=\"{'pr-8':!(disabled || hiddenIcon),'pr-3':disabled || hiddenIcon}\">\r\n        <input #inputElement autocomplete=\"off\"\r\n            class=\"tds-input-number-input flex items-center text-body-2  focus:outline-none focus:border-transparent shadow-none border-0 bg-transparent text-current  p-0  m-0 w-full outline-none  box-border placeholder:text-neutral-1-400 dark:placeholder:text-d-neutral-1-400\"\r\n            [attr.id]=\"id\" [attr.autofocus]=\"autoFocus ? 'autofocus' : null\" [class.cursor-not-allowed]='disabled'\r\n            [disabled]=\"disabled\" [attr.min]=\"min\" [attr.max]=\"max\" [placeholder]=\"placeholder\" [attr.step]=\"step\"\r\n            [attr.inputmode]=\"inputMode\"  [ngModel]=\"displayValue\"\r\n            (ngModelChange)=\"onModelChange($event)\" />\r\n    </div>\r\n</div>" }]
    }], function () { return [{ type: i0.NgZone }, { type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: i1.FocusMonitor }, { type: i2.Directionality, decorators: [{
                type: Optional
            }] }, { type: i5.TDSFormField, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [TDS_FORM_FIELD]
            }, {
                type: Host
            }] }, { type: i3.NgForm, decorators: [{
                type: Optional
            }] }, { type: i3.FormGroupDirective, decorators: [{
                type: Optional
            }] }, { type: i3.NgControl, decorators: [{
                type: Optional
            }, {
                type: Self
            }] }]; }, { tdsBlur: [{
            type: Output
        }], tdsFocus: [{
            type: Output
        }], inputElement: [{
            type: ViewChild,
            args: ['inputElement', { static: true }]
        }], min: [{
            type: Input
        }], max: [{
            type: Input
        }], parser: [{
            type: Input
        }], precision: [{
            type: Input
        }], precisionMode: [{
            type: Input
        }], placeholder: [{
            type: Input
        }], step: [{
            type: Input
        }], inputMode: [{
            type: Input
        }], id: [{
            type: Input
        }], disabled: [{
            type: Input
        }], autoFocus: [{
            type: Input
        }], formatter: [{
            type: Input
        }], size: [{
            type: Input
        }], required: [{
            type: Input
        }], hiddenIcon: [{
            type: Input
        }], autoFormat: [{
            type: Input
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQtbnVtYmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL3Rkcy11aS9pbnB1dC1udW1iZXIvaW5wdXQtbnVtYmVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uL3Byb2plY3RzL3Rkcy11aS9pbnB1dC1udW1iZXIvaW5wdXQtbnVtYmVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFLQSxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNwRSxPQUFPLEVBRUwsdUJBQXVCLEVBRXZCLFNBQVMsRUFFVCxZQUFZLEVBQ1osVUFBVSxFQUNWLElBQUksRUFDSixNQUFNLEVBQ04sS0FBSyxFQUtMLFFBQVEsRUFDUixNQUFNLEVBQ04sSUFBSSxFQUVKLFNBQVMsRUFDVCxpQkFBaUIsRUFDbEIsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDMUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTNDLE9BQU8sRUFBZ0IsbUJBQW1CLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDdEYsT0FBTyxFQUFFLFlBQVksRUFBK0IsZUFBZSxFQUFjLE1BQU0sdUJBQXVCLENBQUM7QUFDL0csT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQzVDLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQy9ELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQzs7Ozs7Ozs7Ozs7O0FBa0N2RCxNQUFNLE9BQU8sdUJBQXVCO0lBNlZsQyxZQUNVLE1BQWMsRUFDZCxVQUFzQixFQUN0QixHQUFzQixFQUN0QixZQUEwQixFQUNkLGNBQThCLEVBQ0MsVUFB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QW9FO2lCQUM5RTs7c0JBb1dFLFFBQVE7O3NCQUNSLFFBQVE7O3NCQUFJLE1BQU07dUJBQUMsY0FBYzs7c0JBQUcsSUFBSTs7c0JBQ3hDLFFBQVE7O3NCQUNSLFFBQVE7O3NCQUNSLFFBQVE7O3NCQUFJLElBQUk7d0JBdFZBLE9BQU87a0JBQXpCLE1BQU07WUFDWSxRQUFRO2tCQUExQixNQUFNO1lBQ3NDLFlBQVk7a0JBQXhELFNBQVM7bUJBQUMsY0FBYyxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtZQUNsQyxHQUFHO2tCQUFYLEtBQUs7WUFDRyxHQUFHO2tCQUFYLEtBQUs7WUFDRyxNQUFNO2tCQUFkLEtBQUs7WUFLRyxTQUFTO2tCQUFqQixLQUFLO1lBQ0csYUFBYTtrQkFBckIsS0FBSztZQUNHLFdBQVc7a0JBQW5CLEtBQUs7WUFDRyxJQUFJO2tCQUFaLEtBQUs7WUFDRyxTQUFTO2tCQUFqQixLQUFLO1lBQ0csRUFBRTtrQkFBVixLQUFLO1lBQ21CLFFBQVE7a0JBQWhDLEtBQUs7WUFDbUIsU0FBUztrQkFBakMsS0FBSztZQUNHLFNBQVM7a0JBQWpCLEtBQUs7WUFHRixJQUFJO2tCQURQLEtBQUs7WUFtQ0YsUUFBUTtrQkFEWCxLQUFLO1lBU21CLFVBQVU7a0JBQWxDLEtBQUs7WUFJbUIsVUFBVTtrQkFBbEMsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuaW1wb3J0IHsgRm9jdXNNb25pdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2ExMXknO1xyXG5pbXBvcnQgeyBEaXJlY3Rpb24sIERpcmVjdGlvbmFsaXR5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2JpZGknO1xyXG5pbXBvcnQgeyBCb29sZWFuSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jZGsvY29lcmNpb24nO1xyXG5pbXBvcnQgeyBET1dOX0FSUk9XLCBFTlRFUiwgVVBfQVJST1cgfSBmcm9tICdAYW5ndWxhci9jZGsva2V5Y29kZXMnO1xyXG5pbXBvcnQge1xyXG4gIEFmdGVyVmlld0luaXQsXHJcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXHJcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgQ29tcG9uZW50LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIGZvcndhcmRSZWYsXHJcbiAgSG9zdCxcclxuICBJbmplY3QsXHJcbiAgSW5wdXQsXHJcbiAgTmdab25lLFxyXG4gIE9uQ2hhbmdlcyxcclxuICBPbkRlc3Ryb3ksXHJcbiAgT25Jbml0LFxyXG4gIE9wdGlvbmFsLFxyXG4gIE91dHB1dCxcclxuICBTZWxmLFxyXG4gIFNpbXBsZUNoYW5nZXMsXHJcbiAgVmlld0NoaWxkLFxyXG4gIFZpZXdFbmNhcHN1bGF0aW9uXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBGb3JtQ29udHJvbCwgRm9ybUdyb3VwRGlyZWN0aXZlLCBOZ0NvbnRyb2wsIE5nRm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgZnJvbUV2ZW50LCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHRha2VVbnRpbCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgQnV0dG9uU2l6ZSB9IGZyb20gXCJ0ZHMtdWkvY29yZS9jb25maWdcIjtcclxuaW1wb3J0IHsgVERTRm9ybUZpZWxkLCBURFNGb3JtRmllbGRDb250cm9sLCBURFNfRk9STV9GSUVMRCB9IGZyb20gJ3Rkcy11aS9mb3JtLWZpZWxkJztcclxuaW1wb3J0IHsgSW5wdXRCb29sZWFuLCBPbkNoYW5nZVR5cGUsIE9uVG91Y2hlZFR5cGUsIFREU0hlbHBlck9iamVjdCwgVERTU2FmZUFueSB9IGZyb20gJ3Rkcy11aS9zaGFyZWQvdXRpbGl0eSc7XHJcbmltcG9ydCB7IGlzTm90TmlsIH0gZnJvbSAndGRzLXVpL2NvcmUvdXRpbCc7XHJcbmltcG9ydCB7IGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSB9IGZyb20gJ3Rkcy11aS9zaGFyZWQvY29lcmNpb24nO1xyXG5pbXBvcnQgeyBURFNJc0Vycm9yU3RhdGUgfSBmcm9tICd0ZHMtdWkvc2hhcmVkL2NvbW1vbic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3Rkcy1pbnB1dC1udW1iZXInLFxyXG4gIGV4cG9ydEFzOiAndGRzSW5wdXROdW1iZXInLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9pbnB1dC1udW1iZXIuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAge1xyXG4gICAgICBwcm92aWRlOiBURFNGb3JtRmllbGRDb250cm9sLFxyXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBURFNJbnB1dE51bWJlckNvbXBvbmVudCksXHJcbiAgICAgIG11bHRpOiB0cnVlXHJcbiAgICB9XHJcbiAgXSxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gIGhvc3Q6IHtcclxuICAgICdbY2xhc3MudGRzLWlucHV0LW51bWJlci1mb2N1c2VkXSc6ICdpc0ZvY3VzZWQnLFxyXG4gICAgJ1tjbGFzcy50ZHMtaW5wdXQtbnVtYmVyLWRpc2FibGVkXSc6ICdkaXNhYmxlZCcsXHJcbiAgICAnW2NsYXNzLmJnLW5ldXRyYWwtMy01MF0nOiAnZGlzYWJsZWQnLFxyXG4gICAgJ1tjbGFzcy5jdXJzb3Itbm90LWFsbG93ZWRdJzogJ2Rpc2FibGVkJyxcclxuICAgICdbY2xhc3MudGRzLWlucHV0LW51bWJlci1ydGxdJzogYGRpciA9PT0gJ3J0bCdgLFxyXG4gICAgJ1tjbGFzcy5ib3JkZXJdJzogXCIhcGFyZW50SXNGb3JtRmllbGRcIixcclxuICAgICdbY2xhc3MuYm9yZGVyLW5ldXRyYWwtMi0yMDBdJzogXCIhcGFyZW50SXNGb3JtRmllbGQgJiYgIWlzRm9jdXNlZFwiLFxyXG4gICAgJ1tjbGFzcy5kYXJrOmJvcmRlci1kLW5ldXRyYWwtMi0yMDBdJzogXCIhcGFyZW50SXNGb3JtRmllbGQgJiYgIWlzRm9jdXNlZFwiLFxyXG4gICAgJ1tjbGFzcy5ib3JkZXItcHJpbWFyeS0xXSc6IFwiIXBhcmVudElzRm9ybUZpZWxkICYmIGlzRm9jdXNlZFwiLFxyXG4gICAgJ1tjbGFzcy5yaW5nXSc6IFwiIXBhcmVudElzRm9ybUZpZWxkICYmIGlzRm9jdXNlZFwiLFxyXG4gICAgJ1tjbGFzcy5yaW5nLW9wYWNpdHktMjBdJzogXCIhcGFyZW50SXNGb3JtRmllbGQgJiYgaXNGb2N1c2VkXCIsXHJcbiAgICAnW2NsYXNzLnJpbmctcHJpbWFyeS0xXSc6IFwiIXBhcmVudElzRm9ybUZpZWxkICYmIGlzRm9jdXNlZFwiLFxyXG4gICAgJ1tjbGFzcy5yb3VuZGVkXSc6IFwiIXBhcmVudElzRm9ybUZpZWxkIFwiLFxyXG4gICAgJ1tjbGFzcy5iZy13aGl0ZV0nOiBcIiFwYXJlbnRJc0Zvcm1GaWVsZCAmJiAhZGlzYWJsZWRcIixcclxuICAgICdbY2xhc3MuZGFyazpiZy1kLW5ldXRyYWwtMy01MF0nOiBcIiFwYXJlbnRJc0Zvcm1GaWVsZCAmJiAhZGlzYWJsZWRcIixcclxuICAgICdjbGFzcyc6ICdpbmxpbmUtYmxvY2sgYm94LWJvcmRlciByZWxhdGl2ZSBtaW4tdy0wIGdyb3VwIG91dGxpbmUtbm9uZSB3LWZ1bGwnXHJcbiAgfVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVERTSW5wdXROdW1iZXJDb21wb25lbnQgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgVERTRm9ybUZpZWxkQ29udHJvbDxhbnk+LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uSW5pdCwgT25EZXN0cm95IHtcclxuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfZGlzYWJsZWQ6IEJvb2xlYW5JbnB1dDtcclxuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfYXV0b0ZvY3VzOiBCb29sZWFuSW5wdXQ7XHJcbiAgcHJpdmF0ZSBhdXRvU3RlcFRpbWVyPzogVERTU2FmZUFueTtcclxuICBwcml2YXRlIHBhcnNlZFZhbHVlPzogc3RyaW5nIHwgbnVtYmVyO1xyXG4gIHB1YmxpYyB2YWx1ZTogbnVtYmVyIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XHJcbiAgc3RhdGVDaGFuZ2VzID0gbmV3IFN1YmplY3Q8dm9pZD4oKTtcclxuICBwYXJlbnRJc0Zvcm1GaWVsZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIGRpc3BsYXlWYWx1ZT86IHN0cmluZyB8IG51bWJlcjtcclxuICBpc0ZvY3VzZWQgPSBmYWxzZTtcclxuICBkaXNhYmxlZFVwID0gZmFsc2U7XHJcbiAgZGlzYWJsZWREb3duID0gZmFsc2U7XHJcbiAgZGlyOiBEaXJlY3Rpb24gPSAnbHRyJztcclxuICBvbkNoYW5nZTogT25DaGFuZ2VUeXBlID0gKCkgPT4geyB9O1xyXG4gIG9uVG91Y2hlZDogT25Ub3VjaGVkVHlwZSA9ICgpID0+IHsgfTtcclxuICBAT3V0cHV0KCkgcmVhZG9ubHkgdGRzQmx1ciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgcmVhZG9ubHkgdGRzRm9jdXMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgQFZpZXdDaGlsZCgnaW5wdXRFbGVtZW50JywgeyBzdGF0aWM6IHRydWUgfSkgaW5wdXRFbGVtZW50ITogRWxlbWVudFJlZjxIVE1MSW5wdXRFbGVtZW50PjtcclxuICBASW5wdXQoKSBtaW46IG51bWJlciA9IC1JbmZpbml0eTtcclxuICBASW5wdXQoKSBtYXg6IG51bWJlciA9IEluZmluaXR5O1xyXG4gIEBJbnB1dCgpIHBhcnNlciA9ICh2YWx1ZTogc3RyaW5nKSA9PlxyXG4gICAgdmFsdWVcclxuICAgICAgLnRyaW0oKVxyXG4gICAgICAucmVwbGFjZSgv44CCL2csICcuJylcclxuICAgICAgLnJlcGxhY2UoL1teXFx3XFwuLV0rL2csICcnKTtcclxuICBASW5wdXQoKSBwcmVjaXNpb24/OiBudW1iZXI7XHJcbiAgQElucHV0KCkgcHJlY2lzaW9uTW9kZTogJ2N1dCcgfCAndG9GaXhlZCcgfCAoKHZhbHVlOiBudW1iZXIgfCBzdHJpbmcsIHByZWNpc2lvbj86IG51bWJlcikgPT4gbnVtYmVyKSA9ICd0b0ZpeGVkJztcclxuICBASW5wdXQoKSBwbGFjZWhvbGRlciA9ICcnO1xyXG4gIEBJbnB1dCgpIHN0ZXAgPSAxO1xyXG4gIEBJbnB1dCgpIGlucHV0TW9kZTogc3RyaW5nID0gJ2RlY2ltYWwnO1xyXG4gIEBJbnB1dCgpIGlkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICBASW5wdXQoKSBASW5wdXRCb29sZWFuKCkgZGlzYWJsZWQgPSBmYWxzZTtcclxuICBASW5wdXQoKSBASW5wdXRCb29sZWFuKCkgYXV0b0ZvY3VzID0gZmFsc2U7XHJcbiAgQElucHV0KCkgZm9ybWF0dGVyOiAodmFsdWU6IG51bWJlcikgPT4gc3RyaW5nIHwgbnVtYmVyID0gdmFsdWUgPT4gdmFsdWU7XHJcbiAgcHJpdmF0ZSBfc2l6ZTogQnV0dG9uU2l6ZSA9ICdtZCdcclxuICBASW5wdXQoKVxyXG4gIGdldCBzaXplKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3NpemU7XHJcblxyXG4gIH1cclxuICBzZXQgc2l6ZSh2YWx1ZTogQnV0dG9uU2l6ZSkge1xyXG4gICAgaWYgKHRoaXMuX3NpemUgIT0gdmFsdWUpIHtcclxuICAgICAgdGhpcy5fc2l6ZSA9IHZhbHVlO1xyXG4gICAgICB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIG5nQ29udHJvbCwgZm9jdXNlZCwgZW1wdHksIHJlcXVpcmVkLFxyXG4gIGVycm9yU3RhdGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuICB1cGRhdGVFcnJvclN0YXRlKCkge1xyXG4gICAgICBjb25zdCBvbGRTdGF0ZSA9IHRoaXMuZXJyb3JTdGF0ZTtcclxuICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5fcGFyZW50Rm9ybUdyb3VwIHx8IHRoaXMuX3BhcmVudEZvcm07XHJcbiAgICAgIC8vIGNvbnN0IG1hdGNoZXIgPSB0aGlzLmVycm9yU3RhdGVNYXRjaGVyIHx8IHRoaXMuX2RlZmF1bHRFcnJvclN0YXRlTWF0Y2hlcjtcclxuICAgICAgY29uc3QgY29udHJvbCA9IHRoaXMubmdDb250cm9sID8gdGhpcy5uZ0NvbnRyb2wuY29udHJvbCBhcyBGb3JtQ29udHJvbCA6IG51bGw7XHJcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gdGhpcy5faXNFcnJvclN0YXRlKGNvbnRyb2wsIHBhcmVudCk7XHJcbiAgICAgIGlmIChuZXdTdGF0ZSAhPT0gb2xkU3RhdGUpIHtcclxuICAgICAgICAgIHRoaXMuZXJyb3JTdGF0ZSA9IG5ld1N0YXRlO1xyXG4gICAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZXMubmV4dCgpO1xyXG4gICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgIH1cclxuICB9XHJcbiAgcHJpdmF0ZSBfaXNFcnJvclN0YXRlKGNvbnRyb2w6IEZvcm1Db250cm9sIHwgbnVsbCwgZm9ybTogRm9ybUdyb3VwRGlyZWN0aXZlIHwgTmdGb3JtIHwgbnVsbCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICBURFNJc0Vycm9yU3RhdGUoY29udHJvbCxmb3JtKTtcclxuICB9XHJcbiAgZ2V0IGZvY3VzZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pc0ZvY3VzZWRcclxuICB9XHJcbiAgZ2V0IGVtcHR5KCkge1xyXG4gICAgcmV0dXJuICFURFNIZWxwZXJPYmplY3QuaGFzVmFsdWUodGhpcy52YWx1ZSk7XHJcbiAgfVxyXG4gIEBJbnB1dCgpXHJcbiAgZ2V0IHJlcXVpcmVkKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVpcmVkO1xyXG4gIH1cclxuICBzZXQgcmVxdWlyZWQodmFsdWU6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuX3JlcXVpcmVkID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcclxuICAgIHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKTtcclxuICB9XHJcbiAgcHJpdmF0ZSBfcmVxdWlyZWQgPSBmYWxzZTtcclxuICBASW5wdXQoKSBASW5wdXRCb29sZWFuKCkgaGlkZGVuSWNvbiA9IGZhbHNlO1xyXG4gIC8qKlxyXG4gICAqIFxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIEBJbnB1dEJvb2xlYW4oKSBhdXRvRm9ybWF0ID0gZmFsc2U7XHJcbiAgLy8gc2V0RGVzY3JpYmVkQnlJZHMsIG9uQ29udGFpbmVyQ2xpY2t0c1xyXG4gIHNldERlc2NyaWJlZEJ5SWRzKGlkczogc3RyaW5nW10pIHtcclxuICAgIGlmIChpZHMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScsIGlkcy5qb2luKCcgJykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWRlc2NyaWJlZGJ5Jyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIG9uQ29udGFpbmVyQ2xpY2soZTogTW91c2VFdmVudCkge1xyXG4gICAgLy8gZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgLy8gZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgfVxyXG4gIG9uTW9kZWxDaGFuZ2UodmFsdWU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgY29uc3QgcGFyc2VkVmFsdWUgPSB0aGlzLnBhcnNlcih2YWx1ZSk7XHJcbiAgICB0aGlzLnBhcnNlZFZhbHVlID0gcGFyc2VkVmFsdWU7XHJcbiAgICBjb25zdCB2YWxpZFZhbHVlID0gdGhpcy5nZXRDdXJyZW50VmFsaWRWYWx1ZSh0aGlzLnBhcnNlZFZhbHVlKTtcclxuICAgIHRoaXMuc2V0VmFsdWUodmFsaWRWYWx1ZSk7XHJcbiAgICBpZih0aGlzLmF1dG9Gb3JtYXQpXHJcbiAgICB7XHJcbiAgICAgIHRoaXMudXBkYXRlRGlzcGxheVZhbHVlKHRoaXMudmFsdWUhKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldEN1cnJlbnRWYWxpZFZhbHVlKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgbGV0IHZhbCA9IHZhbHVlO1xyXG4gICAgaWYgKHZhbCA9PT0gJycpIHtcclxuICAgICAgdmFsID0gJyc7XHJcbiAgICB9IGVsc2UgaWYgKCF0aGlzLmlzTm90Q29tcGxldGVOdW1iZXIodmFsKSkge1xyXG4gICAgICB2YWwgPSBgJHt0aGlzLmdldFZhbGlkVmFsdWUodmFsKX1gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdmFsID0gdGhpcy52YWx1ZSE7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy50b051bWJlcih2YWwpO1xyXG4gIH1cclxuXHJcbiAgLy8gJzEuJyAnMXgnICd4eCcgJycgPT4gYXJlIG5vdCBjb21wbGV0ZSBudW1iZXJzXHJcbiAgaXNOb3RDb21wbGV0ZU51bWJlcihudW06IHN0cmluZyB8IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgaXNOYU4obnVtIGFzIG51bWJlcikgfHxcclxuICAgICAgbnVtID09PSAnJyB8fFxyXG4gICAgICBudW0gPT09IG51bGwgfHxcclxuICAgICAgISEobnVtICYmIG51bS50b1N0cmluZygpLmluZGV4T2YoJy4nKSA9PT0gbnVtLnRvU3RyaW5nKCkubGVuZ3RoIC0gMSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBnZXRWYWxpZFZhbHVlKHZhbHVlPzogc3RyaW5nIHwgbnVtYmVyKTogc3RyaW5nIHwgbnVtYmVyIHwgdW5kZWZpbmVkIHtcclxuICAgIGxldCB2YWwgPSBwYXJzZUZsb2F0KHZhbHVlIGFzIHN0cmluZyk7XHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdGRzLWRlc2lnbi90ZHMtZGVzaWduL2lzc3Vlcy83MzU4XHJcbiAgICBpZiAoaXNOYU4odmFsKSkge1xyXG4gICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsIDwgdGhpcy5taW4pIHtcclxuICAgICAgdmFsID0gdGhpcy5taW47XHJcbiAgICB9XHJcbiAgICBpZiAodmFsID4gdGhpcy5tYXgpIHtcclxuICAgICAgdmFsID0gdGhpcy5tYXg7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsO1xyXG4gIH1cclxuXHJcbiAgdG9OdW1iZXIobnVtOiBzdHJpbmcgfCBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgaWYgKHRoaXMuaXNOb3RDb21wbGV0ZU51bWJlcihudW0pKSB7XHJcbiAgICAgIHJldHVybiBudW0gYXMgbnVtYmVyO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbnVtU3RyID0gU3RyaW5nKG51bSk7XHJcbiAgICBpZiAobnVtU3RyLmluZGV4T2YoJy4nKSA+PSAwICYmIGlzTm90TmlsKHRoaXMucHJlY2lzaW9uKSkge1xyXG4gICAgICBpZiAodHlwZW9mIHRoaXMucHJlY2lzaW9uTW9kZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByZWNpc2lvbk1vZGUobnVtLCB0aGlzLnByZWNpc2lvbik7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmVjaXNpb25Nb2RlID09PSAnY3V0Jykge1xyXG4gICAgICAgIGNvbnN0IG51bVNwbGl0ID0gbnVtU3RyLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgbnVtU3BsaXRbMV0gPSBudW1TcGxpdFsxXS5zbGljZSgwLCB0aGlzLnByZWNpc2lvbik7XHJcbiAgICAgICAgcmV0dXJuIE51bWJlcihudW1TcGxpdC5qb2luKCcuJykpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBOdW1iZXIoTnVtYmVyKG51bSkudG9GaXhlZCh0aGlzLnByZWNpc2lvbikpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE51bWJlcihudW0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0UmF0aW8oZTogS2V5Ym9hcmRFdmVudCk6IG51bWJlciB7XHJcbiAgICBsZXQgcmF0aW8gPSAxO1xyXG4gICAgaWYgKGUubWV0YUtleSB8fCBlLmN0cmxLZXkpIHtcclxuICAgICAgcmF0aW8gPSAwLjE7XHJcbiAgICB9IGVsc2UgaWYgKGUuc2hpZnRLZXkpIHtcclxuICAgICAgcmF0aW8gPSAxMDtcclxuICAgIH1cclxuICAgIHJldHVybiByYXRpbztcclxuICB9XHJcblxyXG4gIGRvd24oZTogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQsIHJhdGlvPzogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7XHJcbiAgICAgIHRoaXMuZm9jdXMoKTtcclxuICAgIH1cclxuICAgIHRoaXMub25TdGVwKCdkb3duJywgZSwgcmF0aW8pO1xyXG4gIH1cclxuXHJcbiAgdXAoZTogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQsIHJhdGlvPzogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7XHJcbiAgICAgIHRoaXMuZm9jdXMoKTtcclxuICAgIH1cclxuICAgIHRoaXMub25TdGVwKCd1cCcsIGUsIHJhdGlvKTtcclxuICB9XHJcblxyXG4gIGdldFByZWNpc2lvbih2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IHZhbHVlU3RyaW5nID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgIGlmICh2YWx1ZVN0cmluZy5pbmRleE9mKCdlLScpID49IDApIHtcclxuICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlU3RyaW5nLnNsaWNlKHZhbHVlU3RyaW5nLmluZGV4T2YoJ2UtJykgKyAyKSwgMTApO1xyXG4gICAgfVxyXG4gICAgbGV0IHByZWNpc2lvbiA9IDA7XHJcbiAgICBpZiAodmFsdWVTdHJpbmcuaW5kZXhPZignLicpID49IDApIHtcclxuICAgICAgcHJlY2lzaW9uID0gdmFsdWVTdHJpbmcubGVuZ3RoIC0gdmFsdWVTdHJpbmcuaW5kZXhPZignLicpIC0gMTtcclxuICAgIH1cclxuICAgIHJldHVybiBwcmVjaXNpb247XHJcbiAgfVxyXG5cclxuICAvLyBzdGVwPXsxLjB9IHZhbHVlPXsxLjUxfVxyXG4gIC8vIHByZXNzICtcclxuICAvLyB0aGVuIHZhbHVlIHNob3VsZCBiZSAyLjUxLCByYXRoZXIgdGhhbiAyLjVcclxuICAvLyBpZiB0aGlzLnByb3BzLnByZWNpc2lvbiBpcyB1bmRlZmluZWRcclxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVhY3QtY29tcG9uZW50L2lucHV0LW51bWJlci9pc3N1ZXMvMzlcclxuICBnZXRNYXhQcmVjaXNpb24oY3VycmVudFZhbHVlOiBzdHJpbmcgfCBudW1iZXIsIHJhdGlvOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgaWYgKGlzTm90TmlsKHRoaXMucHJlY2lzaW9uKSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5wcmVjaXNpb247XHJcbiAgICB9XHJcbiAgICBjb25zdCByYXRpb1ByZWNpc2lvbiA9IHRoaXMuZ2V0UHJlY2lzaW9uKHJhdGlvKTtcclxuICAgIGNvbnN0IHN0ZXBQcmVjaXNpb24gPSB0aGlzLmdldFByZWNpc2lvbih0aGlzLnN0ZXApO1xyXG4gICAgY29uc3QgY3VycmVudFZhbHVlUHJlY2lzaW9uID0gdGhpcy5nZXRQcmVjaXNpb24oY3VycmVudFZhbHVlIGFzIG51bWJlcik7XHJcbiAgICBpZiAoIWN1cnJlbnRWYWx1ZSkge1xyXG4gICAgICByZXR1cm4gcmF0aW9QcmVjaXNpb24gKyBzdGVwUHJlY2lzaW9uO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE1hdGgubWF4KGN1cnJlbnRWYWx1ZVByZWNpc2lvbiwgcmF0aW9QcmVjaXNpb24gKyBzdGVwUHJlY2lzaW9uKTtcclxuICB9XHJcblxyXG4gIGdldFByZWNpc2lvbkZhY3RvcihjdXJyZW50VmFsdWU6IHN0cmluZyB8IG51bWJlciwgcmF0aW86IG51bWJlcik6IG51bWJlciB7XHJcbiAgICBjb25zdCBwcmVjaXNpb24gPSB0aGlzLmdldE1heFByZWNpc2lvbihjdXJyZW50VmFsdWUsIHJhdGlvKTtcclxuICAgIHJldHVybiBNYXRoLnBvdygxMCwgcHJlY2lzaW9uKTtcclxuICB9XHJcblxyXG4gIHVwU3RlcCh2YWw6IHN0cmluZyB8IG51bWJlciwgcmF0OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgY29uc3QgcHJlY2lzaW9uRmFjdG9yID0gdGhpcy5nZXRQcmVjaXNpb25GYWN0b3IodmFsLCByYXQpO1xyXG4gICAgY29uc3QgcHJlY2lzaW9uID0gTWF0aC5hYnModGhpcy5nZXRNYXhQcmVjaXNpb24odmFsLCByYXQpKTtcclxuICAgIGxldCByZXN1bHQ7XHJcbiAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcclxuICAgICAgcmVzdWx0ID0gKChwcmVjaXNpb25GYWN0b3IgKiB2YWwgKyBwcmVjaXNpb25GYWN0b3IgKiB0aGlzLnN0ZXAgKiByYXQpIC8gcHJlY2lzaW9uRmFjdG9yKS50b0ZpeGVkKHByZWNpc2lvbik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXN1bHQgPSB0aGlzLm1pbiA9PT0gLUluZmluaXR5ID8gdGhpcy5zdGVwIDogdGhpcy5taW47XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy50b051bWJlcihyZXN1bHQpO1xyXG4gIH1cclxuXHJcbiAgZG93blN0ZXAodmFsOiBzdHJpbmcgfCBudW1iZXIsIHJhdDogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IHByZWNpc2lvbkZhY3RvciA9IHRoaXMuZ2V0UHJlY2lzaW9uRmFjdG9yKHZhbCwgcmF0KTtcclxuICAgIGNvbnN0IHByZWNpc2lvbiA9IE1hdGguYWJzKHRoaXMuZ2V0TWF4UHJlY2lzaW9uKHZhbCwgcmF0KSk7XHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XHJcbiAgICAgIHJlc3VsdCA9ICgocHJlY2lzaW9uRmFjdG9yICogdmFsIC0gcHJlY2lzaW9uRmFjdG9yICogdGhpcy5zdGVwICogcmF0KSAvIHByZWNpc2lvbkZhY3RvcikudG9GaXhlZChwcmVjaXNpb24pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzdWx0ID0gdGhpcy5taW4gPT09IC1JbmZpbml0eSA/IC10aGlzLnN0ZXAgOiB0aGlzLm1pbjtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLnRvTnVtYmVyKHJlc3VsdCk7XHJcbiAgfVxyXG5cclxuICBvblN0ZXA8VCBleHRlbmRzIGtleW9mIFREU0lucHV0TnVtYmVyQ29tcG9uZW50Pih0eXBlOiBULCBlOiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCwgcmF0aW86IG51bWJlciA9IDEpOiB2b2lkIHtcclxuICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldEN1cnJlbnRWYWxpZFZhbHVlKHRoaXMucGFyc2VkVmFsdWUhKSB8fCAwO1xyXG4gICAgbGV0IHZhbCA9IDA7XHJcbiAgICBpZiAodHlwZSA9PT0gJ3VwJykge1xyXG4gICAgICB2YWwgPSB0aGlzLnVwU3RlcCh2YWx1ZSwgcmF0aW8pO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnZG93bicpIHtcclxuICAgICAgdmFsID0gdGhpcy5kb3duU3RlcCh2YWx1ZSwgcmF0aW8pO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgb3V0T2ZSYW5nZSA9IHZhbCA+IHRoaXMubWF4IHx8IHZhbCA8IHRoaXMubWluO1xyXG4gICAgaWYgKHZhbCA+IHRoaXMubWF4KSB7XHJcbiAgICAgIHZhbCA9IHRoaXMubWF4O1xyXG4gICAgfSBlbHNlIGlmICh2YWwgPCB0aGlzLm1pbikge1xyXG4gICAgICB2YWwgPSB0aGlzLm1pbjtcclxuICAgIH1cclxuICAgIHRoaXMuc2V0VmFsdWUodmFsKTtcclxuICAgIHRoaXMudXBkYXRlRGlzcGxheVZhbHVlKHZhbCk7XHJcbiAgICB0aGlzLmlzRm9jdXNlZCA9IHRydWU7XHJcbiAgICB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCk7XHJcbiAgICBpZiAob3V0T2ZSYW5nZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmF1dG9TdGVwVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgKHRoaXNbdHlwZV0gYXMgKGU6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50LCByYXRpbzogbnVtYmVyKSA9PiB2b2lkKShlLCByYXRpbyk7XHJcbiAgICB9LCAzMDApO1xyXG4gIH1cclxuXHJcbiAgc3RvcCgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmF1dG9TdGVwVGltZXIpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuYXV0b1N0ZXBUaW1lcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRWYWx1ZSh2YWx1ZTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBpZiAoYCR7dGhpcy52YWx1ZX1gICE9PSBgJHt2YWx1ZX1gKSB7XHJcbiAgICAgIHRoaXMub25DaGFuZ2UodmFsdWUpO1xyXG4gICAgfVxyXG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgdGhpcy5wYXJzZWRWYWx1ZSA9IHZhbHVlO1xyXG4gICAgdGhpcy5kaXNhYmxlZFVwID0gdGhpcy5kaXNhYmxlZERvd24gPSBmYWxzZTtcclxuICAgIGlmICh2YWx1ZSB8fCB2YWx1ZSA9PT0gMCkge1xyXG4gICAgICBjb25zdCB2YWwgPSBOdW1iZXIodmFsdWUpO1xyXG4gICAgICBpZiAodmFsID49IHRoaXMubWF4KSB7XHJcbiAgICAgICAgdGhpcy5kaXNhYmxlZFVwID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodmFsIDw9IHRoaXMubWluKSB7XHJcbiAgICAgICAgdGhpcy5kaXNhYmxlZERvd24gPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB1cGRhdGVEaXNwbGF5VmFsdWUodmFsdWU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgY29uc3QgZGlzcGxheVZhbHVlID0gaXNOb3ROaWwodGhpcy5mb3JtYXR0ZXIodmFsdWUpKSA/IHRoaXMuZm9ybWF0dGVyKHZhbHVlKSA6ICcnO1xyXG4gICAgdGhpcy5kaXNwbGF5VmFsdWUgPSBkaXNwbGF5VmFsdWU7XHJcbiAgICB0aGlzLmlucHV0RWxlbWVudC5uYXRpdmVFbGVtZW50LnZhbHVlID0gYCR7ZGlzcGxheVZhbHVlfWA7XHJcbiAgfVxyXG5cclxuICAvLyBvbktleURvd24oZTogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xyXG4gIC8vICAgaWYgKGUua2V5Q29kZSA9PT0gVVBfQVJST1cpIHtcclxuICAvLyAgICAgY29uc3QgcmF0aW8gPSB0aGlzLmdldFJhdGlvKGUpO1xyXG4gIC8vICAgICB0aGlzLnVwKGUsIHJhdGlvKTtcclxuICAvLyAgICAgdGhpcy5zdG9wKCk7XHJcbiAgLy8gICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gRE9XTl9BUlJPVykge1xyXG4gIC8vICAgICBjb25zdCByYXRpbyA9IHRoaXMuZ2V0UmF0aW8oZSk7XHJcbiAgLy8gICAgIHRoaXMuZG93bihlLCByYXRpbyk7XHJcbiAgLy8gICAgIHRoaXMuc3RvcCgpO1xyXG4gIC8vICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IEVOVEVSKSB7XHJcbiAgLy8gICAgIHRoaXMudXBkYXRlRGlzcGxheVZhbHVlKHRoaXMudmFsdWUhKTtcclxuICAvLyAgIH1cclxuICAvLyB9XHJcblxyXG4gIHdyaXRlVmFsdWUodmFsdWU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgdGhpcy5zZXRWYWx1ZSh2YWx1ZSk7XHJcbiAgICB0aGlzLnVwZGF0ZURpc3BsYXlWYWx1ZSh2YWx1ZSk7XHJcbiAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IE9uQ2hhbmdlVHlwZSk6IHZvaWQge1xyXG4gICAgdGhpcy5vbkNoYW5nZSA9IGZuO1xyXG4gIH1cclxuXHJcbiAgcmVnaXN0ZXJPblRvdWNoZWQoZm46IE9uVG91Y2hlZFR5cGUpOiB2b2lkIHtcclxuICAgIHRoaXMub25Ub3VjaGVkID0gZm47XHJcbiAgfVxyXG5cclxuICBzZXREaXNhYmxlZFN0YXRlKGRpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc2FibGVkID0gZGlzYWJsZWQ7XHJcbiAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICB9XHJcblxyXG4gIGZvY3VzKCk6IHZvaWQge1xyXG4gICAgdGhpcy5mb2N1c01vbml0b3IuZm9jdXNWaWEodGhpcy5pbnB1dEVsZW1lbnQsICdrZXlib2FyZCcpO1xyXG4gIH1cclxuXHJcbiAgYmx1cigpOiB2b2lkIHtcclxuICAgIHRoaXMuaW5wdXRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQuYmx1cigpO1xyXG4gIH1cclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG5nWm9uZTogTmdab25lLFxyXG4gICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxyXG4gICAgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgcHJpdmF0ZSBmb2N1c01vbml0b3I6IEZvY3VzTW9uaXRvcixcclxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgZGlyZWN0aW9uYWxpdHk6IERpcmVjdGlvbmFsaXR5LFxyXG4gICAgQE9wdGlvbmFsKCkgQEluamVjdChURFNfRk9STV9GSUVMRCkgQEhvc3QoKSBwdWJsaWMgX2Zvcm1GaWVsZDogVERTRm9ybUZpZWxkLFxyXG4gICAgQE9wdGlvbmFsKCkgcHVibGljIF9wYXJlbnRGb3JtOiBOZ0Zvcm0sXHJcbiAgICBAT3B0aW9uYWwoKSBwdWJsaWMgX3BhcmVudEZvcm1Hcm91cDogRm9ybUdyb3VwRGlyZWN0aXZlLFxyXG4gICAgQE9wdGlvbmFsKCkgQFNlbGYoKSBwdWJsaWMgbmdDb250cm9sOiBOZ0NvbnRyb2wsXHJcbiAgKSB7XHJcbiAgICAvLyBUT0RPOiBtb3ZlIHRvIGhvc3QgYWZ0ZXIgVmlldyBFbmdpbmUgZGVwcmVjYXRpb25cclxuICAgIHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3Rkcy1pbnB1dC1udW1iZXInKTtcclxuICAgIGlmICh0aGlzLm5nQ29udHJvbCAhPSBudWxsKSB7XHJcbiAgICAgIHRoaXMubmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuX2Zvcm1GaWVsZCkge1xyXG4gICAgICAvLyB0aGlzLnNpemUgPSB0aGlzLl9mb3JtRmllbGQuc2l6ZTtcclxuICAgICAgdGhpcy5wYXJlbnRJc0Zvcm1GaWVsZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuZm9jdXNNb25pdG9yXHJcbiAgICAgIC5tb25pdG9yKHRoaXMuZWxlbWVudFJlZiwgdHJ1ZSlcclxuICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKVxyXG4gICAgICAuc3Vic2NyaWJlKGZvY3VzT3JpZ2luID0+IHtcclxuICAgICAgICBpZiAoIWZvY3VzT3JpZ2luKSB7XHJcbiAgICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5VmFsdWUodGhpcy52YWx1ZSEpO1xyXG4gICAgICAgICAgdGhpcy50ZHNCbHVyLmVtaXQoKTtcclxuICAgICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKTtcclxuICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gdGhpcy5vblRvdWNoZWQoKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuaXNGb2N1c2VkID0gdHJ1ZTtcclxuICAgICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKTtcclxuICAgICAgICAgIHRoaXMudGRzRm9jdXMuZW1pdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5kaXIgPSB0aGlzLmRpcmVjdGlvbmFsaXR5LnZhbHVlO1xyXG4gICAgdGhpcy5kaXJlY3Rpb25hbGl0eS5jaGFuZ2U/LnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKS5zdWJzY3JpYmUoKGRpcmVjdGlvbjogRGlyZWN0aW9uKSA9PiB7XHJcbiAgICAgIHRoaXMuZGlyID0gZGlyZWN0aW9uO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgIGZyb21FdmVudCh0aGlzLmlucHV0RWxlbWVudC5uYXRpdmVFbGVtZW50LCAna2V5dXAnKVxyXG4gICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcclxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMuc3RvcCgpKTtcclxuXHJcbiAgICAgIGZyb21FdmVudDxLZXlib2FyZEV2ZW50Pih0aGlzLmlucHV0RWxlbWVudC5uYXRpdmVFbGVtZW50LCAna2V5ZG93bicpXHJcbiAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKVxyXG4gICAgICAgIC5zdWJzY3JpYmUoZXZlbnQgPT4ge1xyXG4gICAgICAgICAgY29uc3QgeyBrZXlDb2RlIH0gPSBldmVudDtcclxuICAgICAgICAgIGlmIChrZXlDb2RlICE9PSBVUF9BUlJPVyAmJiBrZXlDb2RlICE9PSBET1dOX0FSUk9XICYmIGtleUNvZGUgIT09IEVOVEVSKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoa2V5Q29kZSA9PT0gVVBfQVJST1cpIHtcclxuICAgICAgICAgICAgICBjb25zdCByYXRpbyA9IHRoaXMuZ2V0UmF0aW8oZXZlbnQpO1xyXG4gICAgICAgICAgICAgIHRoaXMudXAoZXZlbnQsIHJhdGlvKTtcclxuICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBET1dOX0FSUk9XKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcmF0aW8gPSB0aGlzLmdldFJhdGlvKGV2ZW50KTtcclxuICAgICAgICAgICAgICB0aGlzLmRvd24oZXZlbnQsIHJhdGlvKTtcclxuICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURpc3BsYXlWYWx1ZSh0aGlzLnZhbHVlISk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZiAoY2hhbmdlcy5mb3JtYXR0ZXIgJiYgIWNoYW5nZXMuZm9ybWF0dGVyLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICBjb25zdCB2YWxpZFZhbHVlID0gdGhpcy5nZXRDdXJyZW50VmFsaWRWYWx1ZSh0aGlzLnBhcnNlZFZhbHVlISk7XHJcbiAgICAgIHRoaXMuc2V0VmFsdWUodmFsaWRWYWx1ZSk7XHJcbiAgICAgIHRoaXMudXBkYXRlRGlzcGxheVZhbHVlKHZhbGlkVmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmF1dG9Gb2N1cykge1xyXG4gICAgICB0aGlzLmZvY3VzKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZm9jdXNNb25pdG9yLnN0b3BNb25pdG9yaW5nKHRoaXMuZWxlbWVudFJlZik7XHJcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcclxuICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuICB9XHJcbiAgbmdEb0NoZWNrKCkge1xyXG5cclxuICAgIGlmICh0aGlzLm5nQ29udHJvbCkge1xyXG4gICAgICAgIHRoaXMudXBkYXRlRXJyb3JTdGF0ZSgpO1xyXG4gICAgfVxyXG59XHJcbn1cclxuIiwiPGRpdiBjbGFzcz1cImJveC1ib3JkZXIgIG1pbi13LTAgIGlubGluZS1ibG9jayB3LWZ1bGxcIlxyXG4gICAgW25nQ2xhc3NdPVwieydweS0yJzpzaXplID09PSAnbGcnLCAncHktMSc6c2l6ZSA9PT0gJ3NtJywncHktMS41Jzogc2l6ZSA9PT0gJ21kJ31cIj5cclxuXHJcbiAgICA8ZGl2IGNsYXNzPVwidGRzLWlucHV0LW51bWJlci1oYW5kbGVyLXdyYXAgYWJzb2x1dGUgcmlnaHQtMCB0b3AtMCBib3R0b20tMCB3LThcIiBbbmdDbGFzc109XCJ7J2hpZGRlbic6ZGlzYWJsZWQgfHwgaGlkZGVuSWNvbn1cIj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwidy1mdWxsIGgtZnVsbCBmbGV4ICBmbGV4LWNvbCBpdGVtcy1jZW50ZXJcIiA+XHJcbiAgICAgICAgICAgIDxzcGFuIHVuc2VsZWN0YWJsZT1cInVuc2VsZWN0YWJsZVwiXHJcbiAgICAgICAgICAgICAgICBjbGFzcz1cInRkcy1pbnB1dC1udW1iZXItaGFuZGxlciB3LWZ1bGwgdGV4dC1jZW50ZXIgdGRzLWlucHV0LW51bWJlci1oYW5kbGVyLXVwIGgtMS8yIGZsZXggZmxleC1jb2wtcmV2ZXJzZSBob3ZlcjpiZy1uZXV0cmFsLTMtNTAgaG92ZXI6dGV4dC1uZXV0cmFsLTEtOTAwIGRhcms6aG92ZXI6dGV4dC1kLW5ldXRyYWwtMS05MDAgZGFyazpob3ZlcjpiZy1kLW5ldXRyYWwtMy00MDAgdGV4dC1uZXV0cmFsLTEtNTAwIGRhcms6dGV4dC1kLW5ldXRyYWwtMS01MDBcIlxyXG4gICAgICAgICAgICAgICAgKG1vdXNlZG93bik9XCJ1cCgkZXZlbnQpXCIgKG1vdXNldXApPVwic3RvcCgpXCIgKG1vdXNlbGVhdmUpPVwic3RvcCgpXCIgW2NsYXNzLmN1cnNvci1wb2ludGVyXT1cIiFkaXNhYmxlZFVwXCJcclxuICAgICAgICAgICAgICAgIFtjbGFzcy50ZHMtaW5wdXQtbnVtYmVyLWhhbmRsZXItdXAtZGlzYWJsZWRdPVwiZGlzYWJsZWRVcFwiPlxyXG4gICAgICAgICAgICAgICAgPGkgW25nQ2xhc3NdPVwieyd0ZXh0LXhzJzpzaXplID09ICdzbScsJ3RleHQtc20nOnNpemUgIT09ICdzbSd9XCJcclxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cInRkc2ktYXJyb3ctdXAtZmlsbCBsZWFkaW5nLTMgIHRkcy1pbnB1dC1udW1iZXItaGFuZGxlci11cC1pbm5lciAgXCI+PC9pPlxyXG4gICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgIDxzcGFuIHVuc2VsZWN0YWJsZT1cInVuc2VsZWN0YWJsZVwiXHJcbiAgICAgICAgICAgICAgICBjbGFzcz1cInRkcy1pbnB1dC1udW1iZXItaGFuZGxlciB3LWZ1bGwgdGV4dC1jZW50ZXIgdGRzLWlucHV0LW51bWJlci1oYW5kbGVyLWRvd24gIGgtMS8yIGZsZXggZmxleC1jb2wgaG92ZXI6YmctbmV1dHJhbC0zLTUwIGhvdmVyOnRleHQtbmV1dHJhbC0xLTkwMCBkYXJrOmhvdmVyOnRleHQtZC1uZXV0cmFsLTEtOTAwIGRhcms6aG92ZXI6YmctZC1uZXV0cmFsLTMtNDAwIHRleHQtbmV1dHJhbC0xLTUwMCBkYXJrOnRleHQtZC1uZXV0cmFsLTEtNTAwXCJcclxuICAgICAgICAgICAgICAgIChtb3VzZWRvd24pPVwiZG93bigkZXZlbnQpXCIgKG1vdXNldXApPVwic3RvcCgpXCIgKG1vdXNlbGVhdmUpPVwic3RvcCgpXCJcclxuICAgICAgICAgICAgICAgIFtjbGFzcy50ZHMtaW5wdXQtbnVtYmVyLWhhbmRsZXItZG93bi1kaXNhYmxlZF09XCJkaXNhYmxlZERvd25cIiBbY2xhc3MuY3Vyc29yLXBvaW50ZXJdPVwiIWRpc2FibGVkRG93blwiPlxyXG4gICAgICAgICAgICAgICAgPGkgW25nQ2xhc3NdPVwieyd0ZXh0LXhzJzpzaXplID09ICdzbScsJ3RleHQtc20nOnNpemUgIT09ICdzbSd9XCJcclxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cInRkc2ktYXJyb3ctZG93bi1maWxsIGxlYWRpbmctMyAgdGRzLWlucHV0LW51bWJlci1oYW5kbGVyLWRvd24taW5uZXIgXCI+PC9pPlxyXG4gICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgPC9kaXY+XHJcbiAgICA8ZGl2IGNsYXNzPVwidGRzLWlucHV0LW51bWJlci1pbnB1dC13cmFwIHBsLTNcIiAgW25nQ2xhc3NdPVwieydwci04JzohKGRpc2FibGVkIHx8IGhpZGRlbkljb24pLCdwci0zJzpkaXNhYmxlZCB8fCBoaWRkZW5JY29ufVwiPlxyXG4gICAgICAgIDxpbnB1dCAjaW5wdXRFbGVtZW50IGF1dG9jb21wbGV0ZT1cIm9mZlwiXHJcbiAgICAgICAgICAgIGNsYXNzPVwidGRzLWlucHV0LW51bWJlci1pbnB1dCBmbGV4IGl0ZW1zLWNlbnRlciB0ZXh0LWJvZHktMiAgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOmJvcmRlci10cmFuc3BhcmVudCBzaGFkb3ctbm9uZSBib3JkZXItMCBiZy10cmFuc3BhcmVudCB0ZXh0LWN1cnJlbnQgIHAtMCAgbS0wIHctZnVsbCBvdXRsaW5lLW5vbmUgIGJveC1ib3JkZXIgcGxhY2Vob2xkZXI6dGV4dC1uZXV0cmFsLTEtNDAwIGRhcms6cGxhY2Vob2xkZXI6dGV4dC1kLW5ldXRyYWwtMS00MDBcIlxyXG4gICAgICAgICAgICBbYXR0ci5pZF09XCJpZFwiIFthdHRyLmF1dG9mb2N1c109XCJhdXRvRm9jdXMgPyAnYXV0b2ZvY3VzJyA6IG51bGxcIiBbY2xhc3MuY3Vyc29yLW5vdC1hbGxvd2VkXT0nZGlzYWJsZWQnXHJcbiAgICAgICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiIFthdHRyLm1pbl09XCJtaW5cIiBbYXR0ci5tYXhdPVwibWF4XCIgW3BsYWNlaG9sZGVyXT1cInBsYWNlaG9sZGVyXCIgW2F0dHIuc3RlcF09XCJzdGVwXCJcclxuICAgICAgICAgICAgW2F0dHIuaW5wdXRtb2RlXT1cImlucHV0TW9kZVwiICBbbmdNb2RlbF09XCJkaXNwbGF5VmFsdWVcIlxyXG4gICAgICAgICAgICAobmdNb2RlbENoYW5nZSk9XCJvbk1vZGVsQ2hhbmdlKCRldmVudClcIiAvPlxyXG4gICAgPC9kaXY+XHJcbjwvZGl2PiJdfQ==