import { __decorate } from "tslib";
import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output, ViewEncapsulation } from '@angular/core';
import { fromEvent } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { TDSDestroyService } from 'tds-ui/core/services';
import { InputBoolean } from 'tds-ui/shared/utility';
import * as i0 from "@angular/core";
import * as i1 from "tds-ui/core/services";
import * as i2 from "@angular/common";
function TDSOptionItem_ng_template_1_Template(rf, ctx) { }
const _c0 = function (a0, a1, a2, a3, a4) { return { label: a0, value: a1, $implicit: a2, item: a3, selected: a4 }; };
export class TDSOptionItem {
    constructor(elementRef, ngZone, destroy$) {
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        this.destroy$ = destroy$;
        this.selected = false;
        this.activated = false;
        this.grouped = false;
        this.disabled = false;
        this.showState = false;
        this.label = null;
        this.value = null;
        this.activatedValue = null;
        this.listOfSelectedValue = [];
        this.template = null;
        this.hideSelected = false;
        this.size = 'md';
        this.itemClick = new EventEmitter();
        this.itemHover = new EventEmitter();
        this.elementRef.nativeElement.classList.add('tds-select-item', 'tds-select-item-option');
    }
    ngOnChanges(changes) {
        const { value, activatedValue, listOfSelectedValue } = changes;
        if (value || listOfSelectedValue) {
            this.selected = this.listOfSelectedValue.some(v => this.compareWith(v, this.value));
        }
        if (value || activatedValue) {
            this.activated = this.compareWith(this.activatedValue, this.value);
        }
    }
    ngOnInit() {
        this.ngZone.runOutsideAngular(() => {
            fromEvent(this.elementRef.nativeElement, 'click')
                .pipe(takeUntil(this.destroy$))
                .subscribe(() => {
                if (!this.disabled) {
                    this.ngZone.run(() => this.itemClick.emit(this.value));
                }
            });
            fromEvent(this.elementRef.nativeElement, 'mouseenter')
                .pipe(takeUntil(this.destroy$))
                .subscribe(() => {
                if (!this.disabled) {
                    this.ngZone.run(() => this.itemHover.emit(this.value));
                }
            });
        });
    }
}
TDSOptionItem.ɵfac = function TDSOptionItem_Factory(t) { return new (t || TDSOptionItem)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i1.TDSDestroyService)); };
TDSOptionItem.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TDSOptionItem, selectors: [["tds-option-item"]], hostAttrs: [1, "w-full", "px-3", "text-body-2", "font-regular", "justify-between", "items-center", "mb-px"], hostVars: 37, hostBindings: function TDSOptionItem_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵattribute("title", ctx.label);
        i0.ɵɵclassProp("tds-select-item-option-grouped", ctx.grouped)("bg-neutral-3-50", (ctx.selected || ctx.activated) && !ctx.disabled)("dark:bg-d-neutral-3-400", (ctx.selected || ctx.activated) && !ctx.disabled)("hover:bg-neutral-3-400", !ctx.disabled)("text-neutral-1-900", !ctx.disabled)("dark:text-d-neutral-1-900", !ctx.disabled)("dark:hover:bg-d-neutral-3-400", !ctx.disabled)("text-neutral-1-300", ctx.disabled)("dark:text-d-neutral-1-300", ctx.disabled)("cursor-pointer", !ctx.disabled)("cursor-not-allowed", ctx.disabled)("tds-select-item-option-active", ctx.activated && !ctx.disabled)("py-1", ctx.size === "sm")("py-2", ctx.size === "md")("py-3", ctx.size === "lg")("flex", !ctx.hideSelected || !ctx.selected)("hidden", ctx.hideSelected && ctx.selected)("pointer-events-none", ctx.hideSelected && ctx.selected);
    } }, inputs: { item: "item", grouped: "grouped", disabled: "disabled", showState: "showState", label: "label", value: "value", activatedValue: "activatedValue", listOfSelectedValue: "listOfSelectedValue", template: "template", compareWith: "compareWith", hideSelected: "hideSelected", size: "size" }, outputs: { itemClick: "itemClick", itemHover: "itemHover" }, features: [i0.ɵɵProvidersFeature([
            TDSDestroyService
        ]), i0.ɵɵNgOnChangesFeature], decls: 2, vars: 8, consts: [[3, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function TDSOptionItem_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementContainerStart(0);
        i0.ɵɵtemplate(1, TDSOptionItem_ng_template_1_Template, 0, 0, "ng-template", 0);
        i0.ɵɵelementContainerEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngTemplateOutlet", ctx.template)("ngTemplateOutletContext", i0.ɵɵpureFunction5(2, _c0, ctx.label, ctx.value, ctx.item, ctx.item, ctx.selected));
    } }, directives: [i2.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
__decorate([
    InputBoolean()
], TDSOptionItem.prototype, "grouped", void 0);
__decorate([
    InputBoolean()
], TDSOptionItem.prototype, "disabled", void 0);
__decorate([
    InputBoolean()
], TDSOptionItem.prototype, "showState", void 0);
__decorate([
    InputBoolean()
], TDSOptionItem.prototype, "hideSelected", void 0);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSOptionItem, [{
        type: Component,
        args: [{
                selector: 'tds-option-item',
                template: `  
    <ng-container>
      <ng-template [ngTemplateOutlet]="template" [ngTemplateOutletContext]="{label:label ,value: value, $implicit:item,item:item,selected:selected}">
      </ng-template>
    </ng-container>
  `,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                host: {
                    '[attr.title]': 'label',
                    '[class.tds-select-item-option-grouped]': 'grouped',
                    '[class.bg-neutral-3-50]': '(selected || activated) && !disabled',
                    '[class.dark:bg-d-neutral-3-400]': '(selected || activated) && !disabled',
                    '[class.hover:bg-neutral-3-400]': '!disabled',
                    '[class.text-neutral-1-900]': '!disabled',
                    '[class.dark:text-d-neutral-1-900]': '!disabled',
                    '[class.dark:hover:bg-d-neutral-3-400]': '!disabled',
                    '[class.text-neutral-1-300]': 'disabled',
                    '[class.dark:text-d-neutral-1-300]': 'disabled',
                    '[class.cursor-pointer]': '!disabled',
                    '[class.cursor-not-allowed]': 'disabled',
                    '[class.tds-select-item-option-active]': 'activated && !disabled',
                    '[class.py-1.5]': "size === 'sm'",
                    '[class.py-2]': 'size === "md"',
                    '[class.py-3]': 'size === "lg"',
                    '[class.flex]': '!hideSelected || !selected',
                    '[class.hidden]': 'hideSelected && selected',
                    '[class.pointer-events-none]': 'hideSelected && selected',
                    'class': "w-full px-3 text-body-2 font-regular  justify-between items-center mb-px"
                },
                providers: [
                    TDSDestroyService
                ]
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }, { type: i1.TDSDestroyService }]; }, { item: [{
            type: Input
        }], grouped: [{
            type: Input
        }], disabled: [{
            type: Input
        }], showState: [{
            type: Input
        }], label: [{
            type: Input
        }], value: [{
            type: Input
        }], activatedValue: [{
            type: Input
        }], listOfSelectedValue: [{
            type: Input
        }], template: [{
            type: Input
        }], compareWith: [{
            type: Input
        }], hideSelected: [{
            type: Input
        }], size: [{
            type: Input
        }], itemClick: [{
            type: Output
        }], itemHover: [{
            type: Output
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0LW9wdGlvbi1pdGVtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvdGRzLXVpL3NlbGVjdC9zZWxlY3Qtb3B0aW9uLWl0ZW0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUVULFlBQVksRUFDWixLQUFLLEVBR0wsTUFBTSxFQUdOLGlCQUFpQixFQUNsQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2pDLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQTtBQUUxQyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN6RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7Ozs7OztBQXVDckQsTUFBTSxPQUFPLGFBQWE7SUFrQnhCLFlBQ1UsVUFBbUMsRUFDbkMsTUFBYyxFQUNkLFFBQTJCO1FBRjNCLGVBQVUsR0FBVixVQUFVLENBQXlCO1FBQ25DLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxhQUFRLEdBQVIsUUFBUSxDQUFtQjtRQXBCckMsYUFBUSxHQUFHLEtBQUssQ0FBQztRQUNqQixjQUFTLEdBQUcsS0FBSyxDQUFDO1FBRU8sWUFBTyxHQUFHLEtBQUssQ0FBQztRQUNoQixhQUFRLEdBQUcsS0FBSyxDQUFDO1FBQ2pCLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFDbEMsVUFBSyxHQUEyQixJQUFJLENBQUM7UUFDckMsVUFBSyxHQUFlLElBQUksQ0FBQztRQUN6QixtQkFBYyxHQUFlLElBQUksQ0FBQztRQUNsQyx3QkFBbUIsR0FBVSxFQUFFLENBQUM7UUFDaEMsYUFBUSxHQUE0QixJQUFJLENBQUM7UUFFekIsaUJBQVksR0FBRyxLQUFLLENBQUM7UUFDcEMsU0FBSSxHQUFjLElBQUksQ0FBQztRQUNkLGNBQVMsR0FB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QyxtQ0FBbUMsRUFBRSxXQUFXO29CQUNoRCx1Q0FBdUMsRUFBRSxXQUFXO29CQUNwRCw0QkFBNEIsRUFBRSxVQUFVO29CQUN4QyxtQ0FBbUMsRUFBRSxVQUFVO29CQUMvQyx3QkFBd0IsRUFBRSxXQUFXO29CQUNyQyw0QkFBNEIsRUFBRSxVQUFVO29CQUN4Qyx1Q0FBdUMsRUFBRSx3QkFBd0I7b0JBQ2pFLGdCQUFnQixFQUFFLGVBQWU7b0JBQ2pDLGNBQWMsRUFBRSxlQUFlO29CQUMvQixjQUFjLEVBQUUsZUFBZTtvQkFDL0IsY0FBYyxFQUFFLDRCQUE0QjtvQkFDNUMsZ0JBQWdCLEVBQUUsMEJBQTBCO29CQUM1Qyw2QkFBNkIsRUFBRSwwQkFBMEI7b0JBQ3pELE9BQU8sRUFBRSwwRUFBMEU7aUJBQ3BGO2dCQUNELFNBQVMsRUFBRTtvQkFDVCxpQkFBaUI7aUJBQ2xCO2FBRUY7a0hBSVUsSUFBSTtrQkFBWixLQUFLO1lBQ21CLE9BQU87a0JBQS9CLEtBQUs7WUFDbUIsUUFBUTtrQkFBaEMsS0FBSztZQUNtQixTQUFTO2tCQUFqQyxLQUFLO1lBQ0csS0FBSztrQkFBYixLQUFLO1lBQ0csS0FBSztrQkFBYixLQUFLO1lBQ0csY0FBYztrQkFBdEIsS0FBSztZQUNHLG1CQUFtQjtrQkFBM0IsS0FBSztZQUNHLFFBQVE7a0JBQWhCLEtBQUs7WUFDRyxXQUFXO2tCQUFuQixLQUFLO1lBQ21CLFlBQVk7a0JBQXBDLEtBQUs7WUFDSSxJQUFJO2tCQUFiLEtBQUs7WUFDYSxTQUFTO2tCQUEzQixNQUFNO1lBQ1ksU0FBUztrQkFBM0IsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuaW1wb3J0IHtcclxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcclxuICBDb21wb25lbnQsXHJcbiAgRWxlbWVudFJlZixcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgSW5wdXQsXHJcbiAgTmdab25lLFxyXG4gIE9uQ2hhbmdlcyxcclxuICBPdXRwdXQsXHJcbiAgU2ltcGxlQ2hhbmdlcyxcclxuICBUZW1wbGF0ZVJlZixcclxuICBWaWV3RW5jYXBzdWxhdGlvblxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBmcm9tRXZlbnQgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnXHJcbmltcG9ydCB7IEJ1dHRvblNpemUgfSBmcm9tICd0ZHMtdWkvY29yZS9jb25maWcnO1xyXG5pbXBvcnQgeyBURFNEZXN0cm95U2VydmljZSB9IGZyb20gJ3Rkcy11aS9jb3JlL3NlcnZpY2VzJztcclxuaW1wb3J0IHsgSW5wdXRCb29sZWFuIH0gZnJvbSAndGRzLXVpL3NoYXJlZC91dGlsaXR5JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAndGRzLW9wdGlvbi1pdGVtJyxcclxuICB0ZW1wbGF0ZTogYCAgXHJcbiAgICA8bmctY29udGFpbmVyPlxyXG4gICAgICA8bmctdGVtcGxhdGUgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwie2xhYmVsOmxhYmVsICx2YWx1ZTogdmFsdWUsICRpbXBsaWNpdDppdGVtLGl0ZW06aXRlbSxzZWxlY3RlZDpzZWxlY3RlZH1cIj5cclxuICAgICAgPC9uZy10ZW1wbGF0ZT5cclxuICAgIDwvbmctY29udGFpbmVyPlxyXG4gIGAsXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICBob3N0OiB7XHJcbiAgICAnW2F0dHIudGl0bGVdJzogJ2xhYmVsJyxcclxuICAgICdbY2xhc3MudGRzLXNlbGVjdC1pdGVtLW9wdGlvbi1ncm91cGVkXSc6ICdncm91cGVkJyxcclxuICAgICdbY2xhc3MuYmctbmV1dHJhbC0zLTUwXSc6ICcoc2VsZWN0ZWQgfHwgYWN0aXZhdGVkKSAmJiAhZGlzYWJsZWQnLFxyXG4gICAgJ1tjbGFzcy5kYXJrOmJnLWQtbmV1dHJhbC0zLTQwMF0nOiAnKHNlbGVjdGVkIHx8IGFjdGl2YXRlZCkgJiYgIWRpc2FibGVkJyxcclxuICAgICdbY2xhc3MuaG92ZXI6YmctbmV1dHJhbC0zLTQwMF0nOiAnIWRpc2FibGVkJyxcclxuICAgICdbY2xhc3MudGV4dC1uZXV0cmFsLTEtOTAwXSc6ICchZGlzYWJsZWQnLFxyXG4gICAgJ1tjbGFzcy5kYXJrOnRleHQtZC1uZXV0cmFsLTEtOTAwXSc6ICchZGlzYWJsZWQnLFxyXG4gICAgJ1tjbGFzcy5kYXJrOmhvdmVyOmJnLWQtbmV1dHJhbC0zLTQwMF0nOiAnIWRpc2FibGVkJyxcclxuICAgICdbY2xhc3MudGV4dC1uZXV0cmFsLTEtMzAwXSc6ICdkaXNhYmxlZCcsXHJcbiAgICAnW2NsYXNzLmRhcms6dGV4dC1kLW5ldXRyYWwtMS0zMDBdJzogJ2Rpc2FibGVkJyxcclxuICAgICdbY2xhc3MuY3Vyc29yLXBvaW50ZXJdJzogJyFkaXNhYmxlZCcsXHJcbiAgICAnW2NsYXNzLmN1cnNvci1ub3QtYWxsb3dlZF0nOiAnZGlzYWJsZWQnLFxyXG4gICAgJ1tjbGFzcy50ZHMtc2VsZWN0LWl0ZW0tb3B0aW9uLWFjdGl2ZV0nOiAnYWN0aXZhdGVkICYmICFkaXNhYmxlZCcsXHJcbiAgICAnW2NsYXNzLnB5LTEuNV0nOiBcInNpemUgPT09ICdzbSdcIixcclxuICAgICdbY2xhc3MucHktMl0nOiAnc2l6ZSA9PT0gXCJtZFwiJyxcclxuICAgICdbY2xhc3MucHktM10nOiAnc2l6ZSA9PT0gXCJsZ1wiJyxcclxuICAgICdbY2xhc3MuZmxleF0nOiAnIWhpZGVTZWxlY3RlZCB8fCAhc2VsZWN0ZWQnLFxyXG4gICAgJ1tjbGFzcy5oaWRkZW5dJzogJ2hpZGVTZWxlY3RlZCAmJiBzZWxlY3RlZCcsXHJcbiAgICAnW2NsYXNzLnBvaW50ZXItZXZlbnRzLW5vbmVdJzogJ2hpZGVTZWxlY3RlZCAmJiBzZWxlY3RlZCcsXHJcbiAgICAnY2xhc3MnOiBcInctZnVsbCBweC0zIHRleHQtYm9keS0yIGZvbnQtcmVndWxhciAganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciBtYi1weFwiXHJcbiAgfSxcclxuICBwcm92aWRlcnM6IFtcclxuICAgIFREU0Rlc3Ryb3lTZXJ2aWNlXHJcbiAgXVxyXG4gIFxyXG59KVxyXG5leHBvcnQgY2xhc3MgVERTT3B0aW9uSXRlbSBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XHJcbiAgc2VsZWN0ZWQgPSBmYWxzZTtcclxuICBhY3RpdmF0ZWQgPSBmYWxzZTtcclxuICBASW5wdXQoKSBpdGVtOiBhbnk7XHJcbiAgQElucHV0KCkgQElucHV0Qm9vbGVhbigpIGdyb3VwZWQgPSBmYWxzZTtcclxuICBASW5wdXQoKSBASW5wdXRCb29sZWFuKCkgZGlzYWJsZWQgPSBmYWxzZTtcclxuICBASW5wdXQoKSBASW5wdXRCb29sZWFuKCkgc2hvd1N0YXRlID0gZmFsc2U7XHJcbiAgQElucHV0KCkgbGFiZWw6IHN0cmluZyB8IG51bWJlciB8IG51bGwgPSBudWxsO1xyXG4gIEBJbnB1dCgpIHZhbHVlOiBhbnkgfCBudWxsID0gbnVsbDtcclxuICBASW5wdXQoKSBhY3RpdmF0ZWRWYWx1ZTogYW55IHwgbnVsbCA9IG51bGw7XHJcbiAgQElucHV0KCkgbGlzdE9mU2VsZWN0ZWRWYWx1ZTogYW55W10gPSBbXTtcclxuICBASW5wdXQoKSB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiB8IG51bGwgPSBudWxsO1xyXG4gIEBJbnB1dCgpIGNvbXBhcmVXaXRoITogKG8xOiBhbnksIG8yOiBhbnkpID0+IGJvb2xlYW47XHJcbiAgQElucHV0KCkgQElucHV0Qm9vbGVhbigpIGhpZGVTZWxlY3RlZCA9IGZhbHNlOyBcclxuICBASW5wdXQoKSAgc2l6ZSA6QnV0dG9uU2l6ZSA9J21kJztcclxuICBAT3V0cHV0KCkgcmVhZG9ubHkgaXRlbUNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHJlYWRvbmx5IGl0ZW1Ib3ZlciA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZjxIVE1MRWxlbWVudD4sXHJcbiAgICBwcml2YXRlIG5nWm9uZTogTmdab25lLFxyXG4gICAgcHJpdmF0ZSBkZXN0cm95JDogVERTRGVzdHJveVNlcnZpY2VcclxuICApIHtcclxuICAgIHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3Rkcy1zZWxlY3QtaXRlbScsICd0ZHMtc2VsZWN0LWl0ZW0tb3B0aW9uJyk7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IHZhbHVlLCBhY3RpdmF0ZWRWYWx1ZSwgbGlzdE9mU2VsZWN0ZWRWYWx1ZSB9ID0gY2hhbmdlcztcclxuICAgIGlmICh2YWx1ZSB8fCBsaXN0T2ZTZWxlY3RlZFZhbHVlKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0ZWQgPSB0aGlzLmxpc3RPZlNlbGVjdGVkVmFsdWUuc29tZSh2ID0+IHRoaXMuY29tcGFyZVdpdGgodiwgdGhpcy52YWx1ZSkpO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlIHx8IGFjdGl2YXRlZFZhbHVlKSB7XHJcbiAgICAgIHRoaXMuYWN0aXZhdGVkID0gdGhpcy5jb21wYXJlV2l0aCh0aGlzLmFjdGl2YXRlZFZhbHVlLCB0aGlzLnZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICBmcm9tRXZlbnQodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdjbGljaycpXHJcbiAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKVxyXG4gICAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLml0ZW1DbGljay5lbWl0KHRoaXMudmFsdWUpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIGZyb21FdmVudCh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ21vdXNlZW50ZXInKVxyXG4gICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcclxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5pdGVtSG92ZXIuZW1pdCh0aGlzLnZhbHVlKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59XHJcbiJdfQ==