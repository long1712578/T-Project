import { __decorate } from "tslib";
import { DOCUMENT } from '@angular/common';
import { ChangeDetectionStrategy, Component, EventEmitter, Inject, Input, Optional, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { Subject, Subscription } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { cancelRequestAnimationFrame, reqAnimFrame } from 'tds-ui/core/animation';
import { WithConfig } from 'tds-ui/core/config';
import { isStyleSupport, measure } from 'tds-ui/core/util';
import { InputBoolean, InputNumber } from 'tds-ui/shared/utility';
import { TDSTextCopyComponent } from './text-copy.component';
import { TDSTextEditComponent } from './text-edit.component';
import * as i0 from "@angular/core";
import * as i1 from "tds-ui/core/config";
import * as i2 from "@angular/cdk/platform";
import * as i3 from "tds-ui/i18n";
import * as i4 from "tds-ui/core/services";
import * as i5 from "@angular/cdk/bidi";
import * as i6 from "@angular/common";
import * as i7 from "tds-ui/core/outlet";
import * as i8 from "./text-edit.component";
import * as i9 from "./text-copy.component";
const _c0 = ["ellipsisContainer"];
const _c1 = ["expandable"];
const _c2 = ["contentTemplate"];
function TDSTypographyComponent_ng_template_0_ng_content_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵprojection(0, 0, ["*ngIf", "!content"]);
} }
function TDSTypographyComponent_ng_template_0_a_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "span", 7);
    i0.ɵɵtext(2);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r8 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", ctx_r8.contentCollapse, " ");
} }
function TDSTypographyComponent_ng_template_0_a_2_Template(rf, ctx) { if (rf & 1) {
    const _r10 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "a", 5);
    i0.ɵɵlistener("click", function TDSTypographyComponent_ng_template_0_a_2_Template_a_click_0_listener($event) { i0.ɵɵrestoreView(_r10); const ctx_r9 = i0.ɵɵnextContext(2); return ctx_r9.onCollapse($event); });
    i0.ɵɵtemplate(1, TDSTypographyComponent_ng_template_0_a_2_ng_container_1_Template, 3, 1, "ng-container", 6);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r7 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("tdsStringTemplateOutlet", ctx_r7.contentCollapse);
} }
function TDSTypographyComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵtemplate(0, TDSTypographyComponent_ng_template_0_ng_content_0_Template, 1, 0, "ng-content", 1);
    i0.ɵɵtext(1);
    i0.ɵɵtemplate(2, TDSTypographyComponent_ng_template_0_a_2_Template, 2, 1, "a", 4);
} if (rf & 2) {
    const content_r5 = ctx.content;
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵproperty("ngIf", !content_r5);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", content_r5, " ");
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r1.expandable && !ctx_r1.isEllipsis);
} }
function TDSTypographyComponent_ng_container_2_ng_container_1_ng_template_1_Template(rf, ctx) { }
function TDSTypographyComponent_ng_container_2_ng_container_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r15 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(ctx_r15.suffix);
} }
const _c3 = function (a0) { return { content: a0 }; };
function TDSTypographyComponent_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, TDSTypographyComponent_ng_container_2_ng_container_1_ng_template_1_Template, 0, 0, "ng-template", 10);
    i0.ɵɵtemplate(2, TDSTypographyComponent_ng_container_2_ng_container_1_ng_container_2_Template, 2, 1, "ng-container", 1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r11 = i0.ɵɵnextContext(2);
    const _r0 = i0.ɵɵreference(1);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", _r0)("ngTemplateOutletContext", i0.ɵɵpureFunction1(3, _c3, ctx_r11.content));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r11.suffix);
} }
function TDSTypographyComponent_ng_container_2_ng_template_2_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r17 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(ctx_r17.ellipsisStr);
} }
function TDSTypographyComponent_ng_container_2_ng_template_2_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r18 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(ctx_r18.suffix);
} }
function TDSTypographyComponent_ng_container_2_ng_template_2_a_4_Template(rf, ctx) { if (rf & 1) {
    const _r22 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "a", 13, 14);
    i0.ɵɵlistener("click", function TDSTypographyComponent_ng_container_2_ng_template_2_a_4_Template_a_click_0_listener($event) { i0.ɵɵrestoreView(_r22); const ctx_r21 = i0.ɵɵnextContext(3); return ctx_r21.onExpand($event); });
    i0.ɵɵtext(2);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r19 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", ctx_r19.locale == null ? null : ctx_r19.locale.expand, " ");
} }
function TDSTypographyComponent_ng_container_2_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "span", null, 11);
    i0.ɵɵtemplate(2, TDSTypographyComponent_ng_container_2_ng_template_2_ng_container_2_Template, 2, 1, "ng-container", 1);
    i0.ɵɵtemplate(3, TDSTypographyComponent_ng_container_2_ng_template_2_ng_container_3_Template, 2, 1, "ng-container", 1);
    i0.ɵɵtemplate(4, TDSTypographyComponent_ng_container_2_ng_template_2_a_4_Template, 3, 1, "a", 12);
} if (rf & 2) {
    const ctx_r13 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("ngIf", ctx_r13.isEllipsis);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r13.suffix);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r13.expandable && ctx_r13.isEllipsis);
} }
function TDSTypographyComponent_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, TDSTypographyComponent_ng_container_2_ng_container_1_Template, 3, 5, "ng-container", 8);
    i0.ɵɵtemplate(2, TDSTypographyComponent_ng_container_2_ng_template_2_Template, 5, 3, "ng-template", null, 9, i0.ɵɵtemplateRefExtractor);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const _r12 = i0.ɵɵreference(3);
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r2.expanded || !ctx_r2.hasOperationsWithEllipsis && ctx_r2.ellipsisRows === 1 && !ctx_r2.hasEllipsisObservers || ctx_r2.canCssEllipsis || ctx_r2.suffix && ctx_r2.expanded)("ngIfElse", _r12);
} }
function TDSTypographyComponent_tds_text_edit_3_Template(rf, ctx) { if (rf & 1) {
    const _r24 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "tds-text-edit", 15);
    i0.ɵɵlistener("endEditing", function TDSTypographyComponent_tds_text_edit_3_Template_tds_text_edit_endEditing_0_listener($event) { i0.ɵɵrestoreView(_r24); const ctx_r23 = i0.ɵɵnextContext(); return ctx_r23.onEndEditing($event); })("startEditing", function TDSTypographyComponent_tds_text_edit_3_Template_tds_text_edit_startEditing_0_listener() { i0.ɵɵrestoreView(_r24); const ctx_r25 = i0.ɵɵnextContext(); return ctx_r25.onStartEditing(); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext();
    i0.ɵɵproperty("text", ctx_r3.content)("icon", ctx_r3.editIcon)("tooltip", ctx_r3.editTooltip);
} }
function TDSTypographyComponent_tds_text_copy_4_Template(rf, ctx) { if (rf & 1) {
    const _r27 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "tds-text-copy", 16);
    i0.ɵɵlistener("textCopy", function TDSTypographyComponent_tds_text_copy_4_Template_tds_text_copy_textCopy_0_listener($event) { i0.ɵɵrestoreView(_r27); const ctx_r26 = i0.ɵɵnextContext(); return ctx_r26.onTextCopy($event); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext();
    i0.ɵɵproperty("text", ctx_r4.onCopyText)("tooltips", ctx_r4.copyTooltips)("icons", ctx_r4.copyIcons);
} }
const _c4 = ["*"];
const TDS_CONFIG_MODULE_NAME = 'typography';
const EXPAND_ELEMENT_CLASSNAME = 'tds-typography-expand';
export class TDSTypographyComponent {
    constructor(tdsConfigService, host, cdr, viewContainerRef, renderer, platform, i18n, document, resizeService, directionality) {
        this.tdsConfigService = tdsConfigService;
        this.host = host;
        this.cdr = cdr;
        this.viewContainerRef = viewContainerRef;
        this.renderer = renderer;
        this.platform = platform;
        this.i18n = i18n;
        this.resizeService = resizeService;
        this.directionality = directionality;
        this._tdsModuleName = TDS_CONFIG_MODULE_NAME;
        this.copyable = false;
        this.editable = false;
        this.disabled = false;
        this.expandable = false;
        this.ellipsis = false;
        this.copyTooltips = undefined;
        this.copyIcons = ['tdsi-copy-fill', 'tdsi-tick-fill'];
        this.editTooltip = undefined;
        this.editIcon = 'tdsi-edit-fill';
        this.ellipsisRows = 1;
        this.contentChange = new EventEmitter();
        this.copy = new EventEmitter();
        this.expandChange = new EventEmitter();
        // This is not a two-way binding output with {@link ellipsis}
        this.ellipsisChange = new EventEmitter();
        this.expandableBtnElementCache = null;
        this.editing = false;
        this.cssEllipsis = false;
        this.isEllipsis = true;
        this.expanded = false;
        this.ellipsisStr = '...';
        this.dir = 'ltr';
        this.viewInit = false;
        this.rfaId = -1;
        this.destroy$ = new Subject();
        this.windowResizeSubscription = Subscription.EMPTY;
        this.document = document;
    }
    get hasEllipsisObservers() {
        return this.ellipsisChange.observers.length > 0;
    }
    get canCssEllipsis() {
        return this.ellipsis && this.cssEllipsis && !this.expanded && !this.hasEllipsisObservers;
    }
    get hasOperationsWithEllipsis() {
        return (this.copyable || this.editable || this.expandable) && this.ellipsis;
    }
    get onCopyText() {
        return (typeof this.copyText === 'string' ? this.copyText : this.content);
    }
    onTextCopy(text) {
        this.copy.emit(text);
    }
    onStartEditing() {
        this.editing = true;
    }
    onEndEditing(text) {
        this.editing = false;
        this.contentChange.emit(text);
        if (this.content === text) {
            this.renderOnNextFrame();
        }
        this.cdr.markForCheck();
    }
    onExpand(event) {
        if (event) {
            event.preventDefault();
            event.stopImmediatePropagation();
        }
        this.isEllipsis = false;
        this.expanded = true;
        this.expandChange.emit();
        this.ellipsisChange.emit(false);
    }
    canUseCSSEllipsis() {
        if (this.editable || this.copyable || this.expandable || this.suffix) {
            return false;
        }
        // make sure {@link ellipsisChange} works, will force use JS to calculations
        if (this.hasEllipsisObservers) {
            return false;
        }
        if (this.ellipsisRows === 1) {
            return isStyleSupport('textOverflow');
        }
        else {
            return isStyleSupport('webkitLineClamp');
        }
    }
    renderOnNextFrame() {
        cancelRequestAnimationFrame(this.rfaId);
        if (!this.viewInit || !this.ellipsis || this.ellipsisRows < 0 || this.expanded || !this.platform.isBrowser) {
            return;
        }
        this.rfaId = reqAnimFrame(() => {
            this.syncEllipsis();
        });
    }
    getOriginContentViewRef() {
        const viewRef = this.viewContainerRef.createEmbeddedView(this.contentTemplate, {
            content: this.content
        });
        viewRef.detectChanges();
        return {
            viewRef,
            removeView: () => {
                this.viewContainerRef.remove(this.viewContainerRef.indexOf(viewRef));
            }
        };
    }
    syncEllipsis() {
        if (this.cssEllipsis) {
            return;
        }
        const { viewRef, removeView } = this.getOriginContentViewRef();
        const fixedNodes = [this.textCopyRef, this.textEditRef]
            .filter(e => e && e.nativeElement)
            .map(e => e.nativeElement);
        const expandableBtnElement = this.getExpandableBtnElement();
        if (expandableBtnElement) {
            fixedNodes.push(expandableBtnElement);
        }
        const { contentNodes, text, ellipsis } = measure(this.host.nativeElement, this.ellipsisRows, viewRef.rootNodes, fixedNodes, this.ellipsisStr, this.suffix);
        removeView();
        this.ellipsisText = text;
        if (ellipsis !== this.isEllipsis) {
            this.isEllipsis = ellipsis;
            this.ellipsisChange.emit(ellipsis);
        }
        const ellipsisContainerNativeElement = this.ellipsisContainer.nativeElement;
        while (ellipsisContainerNativeElement.firstChild) {
            this.renderer.removeChild(ellipsisContainerNativeElement, ellipsisContainerNativeElement.firstChild);
        }
        contentNodes.forEach(n => {
            this.renderer.appendChild(ellipsisContainerNativeElement, n.cloneNode(true));
        });
        this.cdr.markForCheck();
    }
    // Need to create the element for calculation size before view init
    getExpandableBtnElement() {
        if (this.expandable) {
            const expandText = this.locale ? this.locale.expand : '';
            const cache = this.expandableBtnElementCache;
            if (!cache || cache.innerText === expandText) {
                const el = this.document.createElement('a');
                el.className = EXPAND_ELEMENT_CLASSNAME;
                el.innerText = expandText;
                this.expandableBtnElementCache = el;
            }
            return this.expandableBtnElementCache;
        }
        else {
            this.expandableBtnElementCache = null;
            return null;
        }
    }
    renderAndSubscribeWindowResize() {
        if (this.platform.isBrowser) {
            this.windowResizeSubscription.unsubscribe();
            this.cssEllipsis = this.canUseCSSEllipsis();
            this.renderOnNextFrame();
            this.windowResizeSubscription = this.resizeService
                .subscribe()
                .pipe(takeUntil(this.destroy$))
                .subscribe(() => this.renderOnNextFrame());
        }
    }
    ngOnInit() {
        this.i18n.localeChange.pipe(takeUntil(this.destroy$)).subscribe(() => {
            this.locale = this.i18n.getLocaleData('Text');
            this.cdr.markForCheck();
        });
        this.directionality.change?.pipe(takeUntil(this.destroy$)).subscribe((direction) => {
            this.dir = direction;
            this.cdr.detectChanges();
        });
        this.dir = this.directionality.value;
    }
    ngAfterViewInit() {
        this.viewInit = true;
        this.renderAndSubscribeWindowResize();
    }
    ngOnChanges(changes) {
        const { copyable, editable, expandable, ellipsis, content, ellipsisRows, suffix } = changes;
        if (copyable || editable || expandable || ellipsis || content || ellipsisRows || suffix) {
            if (this.ellipsis) {
                if (this.expanded) {
                    this.windowResizeSubscription.unsubscribe();
                }
                else {
                    this.renderAndSubscribeWindowResize();
                }
            }
        }
    }
    onCollapse(event) {
        if (event) {
            event.preventDefault();
            event.stopImmediatePropagation();
        }
        if (this.expanded && !this.isEllipsis) {
            this.expanded = false;
            this.isEllipsis = true;
            this.ellipsis = true;
            this.ellipsisChange.emit(true);
            this.renderAndSubscribeWindowResize();
        }
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
        this.expandableBtnElementCache = null;
        this.windowResizeSubscription.unsubscribe();
    }
}
TDSTypographyComponent.ɵfac = function TDSTypographyComponent_Factory(t) { return new (t || TDSTypographyComponent)(i0.ɵɵdirectiveInject(i1.TDSConfigService), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ViewContainerRef), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i2.Platform), i0.ɵɵdirectiveInject(i3.TDSI18nService), i0.ɵɵdirectiveInject(DOCUMENT), i0.ɵɵdirectiveInject(i4.TDSResizeService), i0.ɵɵdirectiveInject(i5.Directionality, 8)); };
TDSTypographyComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TDSTypographyComponent, selectors: [["tds-typography"], ["", "tds-typography", ""], ["p", "tds-paragraph", ""], ["span", "tds-text", ""], ["h1", "tds-title", ""], ["h2", "tds-title", ""], ["h3", "tds-title", ""], ["h4", "tds-title", ""]], viewQuery: function TDSTypographyComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(TDSTextEditComponent, 5);
        i0.ɵɵviewQuery(TDSTextCopyComponent, 5);
        i0.ɵɵviewQuery(_c0, 5);
        i0.ɵɵviewQuery(_c1, 5);
        i0.ɵɵviewQuery(_c2, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.textEditRef = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.textCopyRef = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.ellipsisContainer = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.expandableBtn = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.contentTemplate = _t.first);
    } }, hostVars: 34, hostBindings: function TDSTypographyComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵstyleProp("-webkit-line-clamp", ctx.canCssEllipsis && ctx.ellipsisRows > 1 ? ctx.ellipsisRows : null);
        i0.ɵɵclassProp("tds-typography", !ctx.editing)("break-words", !ctx.editing)("tds-typography-rtl", ctx.dir === "rtl")("tds-typography-edit-content", ctx.editing)("text-neutral-1-400", ctx.color === "secondary")("text-warning-400", ctx.color === "warning")("text-error-400", ctx.color === "danger")("text-success-400", ctx.color === "success")("tds-typography-disabled", ctx.disabled)("tds-typography-ellipsis", ctx.ellipsis && !ctx.expanded)("tds-typography-single-line", ctx.ellipsis && ctx.ellipsisRows === 1)("whitespace-nowrap", ctx.ellipsis && ctx.ellipsisRows === 1)("tds-typography-ellipsis-single-line", ctx.canCssEllipsis && ctx.ellipsisRows === 1)("overflow-hidden", ctx.canCssEllipsis && ctx.ellipsisRows === 1)("overflow-ellipsis", ctx.canCssEllipsis && ctx.ellipsisRows === 1)("tds-typography-ellipsis-multiple-line", ctx.canCssEllipsis && ctx.ellipsisRows > 1);
    } }, inputs: { copyable: "copyable", editable: "editable", disabled: "disabled", expandable: "expandable", ellipsis: "ellipsis", copyTooltips: "copyTooltips", copyIcons: "copyIcons", editTooltip: "editTooltip", editIcon: "editIcon", content: "content", ellipsisRows: "ellipsisRows", color: "color", copyText: "copyText", suffix: "suffix", contentCollapse: "contentCollapse" }, outputs: { contentChange: "contentChange", copy: "copy", expandChange: "expandChange", ellipsisChange: "ellipsisChange" }, exportAs: ["tdsTypography"], features: [i0.ɵɵNgOnChangesFeature], ngContentSelectors: _c4, decls: 5, vars: 3, consts: [["contentTemplate", ""], [4, "ngIf"], [3, "text", "icon", "tooltip", "endEditing", "startEditing", 4, "ngIf"], [3, "text", "tooltips", "icons", "textCopy", 4, "ngIf"], ["class", "inline-block", 3, "click", 4, "ngIf"], [1, "inline-block", 3, "click"], [4, "tdsStringTemplateOutlet"], [1, "tds-typography-collapse", "text-info-500", "cursor-pointer", "text-body-2"], [4, "ngIf", "ngIfElse"], ["jsEllipsis", ""], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["ellipsisContainer", ""], ["class", "tds-typography-expand text-info-500 cursor-pointer text-body-2", 3, "click", 4, "ngIf"], [1, "tds-typography-expand", "text-info-500", "cursor-pointer", "text-body-2", 3, "click"], ["expandable", ""], [3, "text", "icon", "tooltip", "endEditing", "startEditing"], [3, "text", "tooltips", "icons", "textCopy"]], template: function TDSTypographyComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵprojectionDef();
        i0.ɵɵtemplate(0, TDSTypographyComponent_ng_template_0_Template, 3, 3, "ng-template", null, 0, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(2, TDSTypographyComponent_ng_container_2_Template, 4, 2, "ng-container", 1);
        i0.ɵɵtemplate(3, TDSTypographyComponent_tds_text_edit_3_Template, 1, 3, "tds-text-edit", 2);
        i0.ɵɵtemplate(4, TDSTypographyComponent_tds_text_copy_4_Template, 1, 3, "tds-text-copy", 3);
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngIf", !ctx.editing);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.editable);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.copyable && !ctx.editing);
    } }, directives: [i6.NgIf, i7.TDSStringTemplateOutletDirective, i6.NgTemplateOutlet, i8.TDSTextEditComponent, i9.TDSTextCopyComponent], encapsulation: 2, changeDetection: 0 });
__decorate([
    InputBoolean()
], TDSTypographyComponent.prototype, "copyable", void 0);
__decorate([
    InputBoolean()
], TDSTypographyComponent.prototype, "editable", void 0);
__decorate([
    InputBoolean()
], TDSTypographyComponent.prototype, "disabled", void 0);
__decorate([
    InputBoolean()
], TDSTypographyComponent.prototype, "expandable", void 0);
__decorate([
    InputBoolean()
], TDSTypographyComponent.prototype, "ellipsis", void 0);
__decorate([
    WithConfig()
], TDSTypographyComponent.prototype, "copyTooltips", void 0);
__decorate([
    WithConfig()
], TDSTypographyComponent.prototype, "copyIcons", void 0);
__decorate([
    WithConfig()
], TDSTypographyComponent.prototype, "editTooltip", void 0);
__decorate([
    WithConfig()
], TDSTypographyComponent.prototype, "editIcon", void 0);
__decorate([
    WithConfig(),
    InputNumber()
], TDSTypographyComponent.prototype, "ellipsisRows", void 0);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSTypographyComponent, [{
        type: Component,
        args: [{
                selector: `
  tds-typography,
  [tds-typography],
  p[tds-paragraph],
  span[tds-text],
  h1[tds-title], h2[tds-title], h3[tds-title], h4[tds-title]
  `,
                exportAs: 'tdsTypography',
                template: `
    <ng-template #contentTemplate let-content="content">
      <ng-content *ngIf="!content"></ng-content>
      {{ content }}    
      <a *ngIf="expandable && !isEllipsis" class="inline-block" (click)="onCollapse($event)">      
      <ng-container *tdsStringTemplateOutlet="contentCollapse">
      <span
        class="tds-typography-collapse text-info-500 cursor-pointer text-body-2">
        {{ contentCollapse }}
      </span>
     
      </ng-container>
    </a>
    </ng-template>
    <ng-container *ngIf="!editing">
      <ng-container
        *ngIf="
          expanded ||
            (!hasOperationsWithEllipsis && ellipsisRows === 1 && !hasEllipsisObservers) ||
            canCssEllipsis ||
            (suffix && expanded);
          else jsEllipsis
        "
      >
        <ng-template
          [ngTemplateOutlet]="contentTemplate"
          [ngTemplateOutletContext]="{ content: content }"
        ></ng-template>
        <ng-container *ngIf="suffix">{{ suffix }}</ng-container>
      </ng-container>
      <ng-template #jsEllipsis>
        <span #ellipsisContainer></span>
        <ng-container *ngIf="isEllipsis">{{ ellipsisStr }}</ng-container>
        <ng-container *ngIf="suffix">{{ suffix }}</ng-container>
        <a #expandable *ngIf="expandable && isEllipsis" class="tds-typography-expand text-info-500 cursor-pointer text-body-2" (click)="onExpand($event)">
          {{ locale?.expand }}
        </a>
      </ng-template>
    </ng-container>

    <tds-text-edit
      *ngIf="editable"
      [text]="content"
      [icon]="editIcon"
      [tooltip]="editTooltip"
      (endEditing)="onEndEditing($event)"
      (startEditing)="onStartEditing()"
     
    ></tds-text-edit>

    <tds-text-copy
      *ngIf="copyable && !editing"
      [text]="onCopyText"
      [tooltips]="copyTooltips"
      [icons]="copyIcons"
      (textCopy)="onTextCopy($event)"
    ></tds-text-copy>
  `,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                preserveWhitespaces: false,
                host: {
                    '[class.tds-typography]': '!editing',
                    '[class.break-words]': '!editing',
                    '[class.tds-typography-rtl]': 'dir === "rtl"',
                    '[class.tds-typography-edit-content]': 'editing',
                    '[class.text-neutral-1-400]': 'color === "secondary"',
                    '[class.text-warning-400]': 'color === "warning"',
                    '[class.text-error-400]': 'color === "danger"',
                    '[class.text-success-400]': 'color === "success"',
                    '[class.tds-typography-disabled]': 'disabled',
                    '[class.tds-typography-ellipsis]': 'ellipsis && !expanded',
                    '[class.tds-typography-single-line]': 'ellipsis && ellipsisRows === 1',
                    '[class.whitespace-nowrap]': 'ellipsis && ellipsisRows === 1',
                    '[class.tds-typography-ellipsis-single-line]': 'canCssEllipsis && ellipsisRows === 1',
                    '[class.overflow-hidden]': 'canCssEllipsis && ellipsisRows === 1',
                    '[class.overflow-ellipsis]': 'canCssEllipsis && ellipsisRows === 1',
                    '[class.tds-typography-ellipsis-multiple-line]': 'canCssEllipsis && ellipsisRows > 1',
                    '[style.-webkit-line-clamp]': '(canCssEllipsis && ellipsisRows > 1) ? ellipsisRows : null'
                }
            }]
    }], function () { return [{ type: i1.TDSConfigService }, { type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: i0.ViewContainerRef }, { type: i0.Renderer2 }, { type: i2.Platform }, { type: i3.TDSI18nService }, { type: undefined, decorators: [{
                type: Inject,
                args: [DOCUMENT]
            }] }, { type: i4.TDSResizeService }, { type: i5.Directionality, decorators: [{
                type: Optional
            }] }]; }, { copyable: [{
            type: Input
        }], editable: [{
            type: Input
        }], disabled: [{
            type: Input
        }], expandable: [{
            type: Input
        }], ellipsis: [{
            type: Input
        }], copyTooltips: [{
            type: Input
        }], copyIcons: [{
            type: Input
        }], editTooltip: [{
            type: Input
        }], editIcon: [{
            type: Input
        }], content: [{
            type: Input
        }], ellipsisRows: [{
            type: Input
        }], color: [{
            type: Input
        }], copyText: [{
            type: Input
        }], suffix: [{
            type: Input
        }], contentCollapse: [{
            type: Input
        }], contentChange: [{
            type: Output
        }], copy: [{
            type: Output
        }], expandChange: [{
            type: Output
        }], ellipsisChange: [{
            type: Output
        }], textEditRef: [{
            type: ViewChild,
            args: [TDSTextEditComponent, { static: false }]
        }], textCopyRef: [{
            type: ViewChild,
            args: [TDSTextCopyComponent, { static: false }]
        }], ellipsisContainer: [{
            type: ViewChild,
            args: ['ellipsisContainer', { static: false }]
        }], expandableBtn: [{
            type: ViewChild,
            args: ['expandable', { static: false }]
        }], contentTemplate: [{
            type: ViewChild,
            args: ['contentTemplate', { static: false }]
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwb2dyYXBoeS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy90ZHMtdWkvdHlwb2dyYXBoeS90eXBvZ3JhcGh5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBS0EsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFFTCx1QkFBdUIsRUFFdkIsU0FBUyxFQUdULFlBQVksRUFDWixNQUFNLEVBQ04sS0FBSyxFQUlMLFFBQVEsRUFDUixNQUFNLEVBSU4sU0FBUyxFQUVULGlCQUFpQixFQUNsQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUM3QyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0MsT0FBTyxFQUFFLDJCQUEyQixFQUFFLFlBQVksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2xGLE9BQU8sRUFBNkMsVUFBVSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFFM0YsT0FBTyxFQUFFLGNBQWMsRUFBRSxPQUFPLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUUzRCxPQUFPLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBYyxNQUFNLHVCQUF1QixDQUFDO0FBRzlFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzdELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7SUFnQnZELDRDQUEwQzs7O0lBRzFDLDZCQUF5RDtJQUN6RCwrQkFDMkU7SUFDekUsWUFDRjtJQUFBLGlCQUFPO0lBRVAsMEJBQWU7OztJQUhiLGVBQ0Y7SUFERSx1REFDRjs7OztJQUxBLDRCQUF1RjtJQUE3QixrTEFBUyx5QkFBa0IsSUFBQztJQUN0RiwyR0FNZTtJQUNqQixpQkFBSTs7O0lB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O2tCQUF4RCxTQUFTO21CQUFDLFlBQVksRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUU7WUFDTyxlQUFlO2tCQUEvRCxTQUFTO21CQUFDLGlCQUFpQixFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuaW1wb3J0IHsgRGlyZWN0aW9uLCBEaXJlY3Rpb25hbGl0eSB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9iaWRpJztcclxuaW1wb3J0IHsgQm9vbGVhbklucHV0LCBOdW1iZXJJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2VyY2lvbic7XHJcbmltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL3BsYXRmb3JtJztcclxuaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQge1xyXG4gIEFmdGVyVmlld0luaXQsXHJcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXHJcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgQ29tcG9uZW50LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgRW1iZWRkZWRWaWV3UmVmLFxyXG4gIEV2ZW50RW1pdHRlcixcclxuICBJbmplY3QsXHJcbiAgSW5wdXQsXHJcbiAgT25DaGFuZ2VzLFxyXG4gIE9uRGVzdHJveSxcclxuICBPbkluaXQsXHJcbiAgT3B0aW9uYWwsXHJcbiAgT3V0cHV0LFxyXG4gIFJlbmRlcmVyMixcclxuICBTaW1wbGVDaGFuZ2VzLFxyXG4gIFRlbXBsYXRlUmVmLFxyXG4gIFZpZXdDaGlsZCxcclxuICBWaWV3Q29udGFpbmVyUmVmLFxyXG4gIFZpZXdFbmNhcHN1bGF0aW9uXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFN1YmplY3QsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IGNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSwgcmVxQW5pbUZyYW1lIH0gZnJvbSAndGRzLXVpL2NvcmUvYW5pbWF0aW9uJztcclxuaW1wb3J0IHsgVERTQ29uZmlnS2V5LCBURFNDb25maWdTZXJ2aWNlLCBURFNUU1R5cGUsIFdpdGhDb25maWcgfSBmcm9tICd0ZHMtdWkvY29yZS9jb25maWcnO1xyXG5pbXBvcnQgeyBURFNSZXNpemVTZXJ2aWNlIH0gZnJvbSAndGRzLXVpL2NvcmUvc2VydmljZXMnO1xyXG5pbXBvcnQgeyBpc1N0eWxlU3VwcG9ydCwgbWVhc3VyZSB9IGZyb20gJ3Rkcy11aS9jb3JlL3V0aWwnO1xyXG5pbXBvcnQgeyBURFNJMThuU2VydmljZSwgVERTVGV4dEkxOG5JbnRlcmZhY2UgfSBmcm9tICd0ZHMtdWkvaTE4bic7XHJcbmltcG9ydCB7IElucHV0Qm9vbGVhbiwgSW5wdXROdW1iZXIsIFREU1NhZmVBbnkgfSBmcm9tICd0ZHMtdWkvc2hhcmVkL3V0aWxpdHknO1xyXG5cclxuXHJcbmltcG9ydCB7IFREU1RleHRDb3B5Q29tcG9uZW50IH0gZnJvbSAnLi90ZXh0LWNvcHkuY29tcG9uZW50JztcclxuaW1wb3J0IHsgVERTVGV4dEVkaXRDb21wb25lbnQgfSBmcm9tICcuL3RleHQtZWRpdC5jb21wb25lbnQnO1xyXG5cclxuY29uc3QgVERTX0NPTkZJR19NT0RVTEVfTkFNRTogVERTQ29uZmlnS2V5ID0gJ3R5cG9ncmFwaHknO1xyXG5jb25zdCBFWFBBTkRfRUxFTUVOVF9DTEFTU05BTUUgPSAndGRzLXR5cG9ncmFwaHktZXhwYW5kJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiBgXHJcbiAgdGRzLXR5cG9ncmFwaHksXHJcbiAgW3Rkcy10eXBvZ3JhcGh5XSxcclxuICBwW3Rkcy1wYXJhZ3JhcGhdLFxyXG4gIHNwYW5bdGRzLXRleHRdLFxyXG4gIGgxW3Rkcy10aXRsZV0sIGgyW3Rkcy10aXRsZV0sIGgzW3Rkcy10aXRsZV0sIGg0W3Rkcy10aXRsZV1cclxuICBgLFxyXG4gIGV4cG9ydEFzOiAndGRzVHlwb2dyYXBoeScsXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgIDxuZy10ZW1wbGF0ZSAjY29udGVudFRlbXBsYXRlIGxldC1jb250ZW50PVwiY29udGVudFwiPlxyXG4gICAgICA8bmctY29udGVudCAqbmdJZj1cIiFjb250ZW50XCI+PC9uZy1jb250ZW50PlxyXG4gICAgICB7eyBjb250ZW50IH19ICAgIFxyXG4gICAgICA8YSAqbmdJZj1cImV4cGFuZGFibGUgJiYgIWlzRWxsaXBzaXNcIiBjbGFzcz1cImlubGluZS1ibG9ja1wiIChjbGljayk9XCJvbkNvbGxhcHNlKCRldmVudClcIj4gICAgICBcclxuICAgICAgPG5nLWNvbnRhaW5lciAqdGRzU3RyaW5nVGVtcGxhdGVPdXRsZXQ9XCJjb250ZW50Q29sbGFwc2VcIj5cclxuICAgICAgPHNwYW5cclxuICAgICAgICBjbGFzcz1cInRkcy10eXBvZ3JhcGh5LWNvbGxhcHNlIHRleHQtaW5mby01MDAgY3Vyc29yLXBvaW50ZXIgdGV4dC1ib2R5LTJcIj5cclxuICAgICAgICB7eyBjb250ZW50Q29sbGFwc2UgfX1cclxuICAgICAgPC9zcGFuPlxyXG4gICAgIFxyXG4gICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgIDwvYT5cclxuICAgIDwvbmctdGVtcGxhdGU+XHJcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWVkaXRpbmdcIj5cclxuICAgICAgPG5nLWNvbnRhaW5lclxyXG4gICAgICAgICpuZ0lmPVwiXHJcbiAgICAgICAgICBleHBhbmRlZCB8fFxyXG4gICAgICAgICAgICAoIWhhc09wZXJhdGlvbnNXaXRoRWxsaXBzaXMgJiYgZWxsaXBzaXNSb3dzID09PSAxICYmICFoYXNFbGxpcHNpc09ic2VydmVycykgfHxcclxuICAgICAgICAgICAgY2FuQ3NzRWxsaXBzaXMgfHxcclxuICAgICAgICAgICAgKHN1ZmZpeCAmJiBleHBhbmRlZCk7XHJcbiAgICAgICAgICBlbHNlIGpzRWxsaXBzaXNcclxuICAgICAgICBcIlxyXG4gICAgICA+XHJcbiAgICAgICAgPG5nLXRlbXBsYXRlXHJcbiAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldF09XCJjb250ZW50VGVtcGxhdGVcIlxyXG4gICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgY29udGVudDogY29udGVudCB9XCJcclxuICAgICAgICA+PC9uZy10ZW1wbGF0ZT5cclxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwic3VmZml4XCI+e3sgc3VmZml4IH19PC9uZy1jb250YWluZXI+XHJcbiAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgICA8bmctdGVtcGxhdGUgI2pzRWxsaXBzaXM+XHJcbiAgICAgICAgPHNwYW4gI2VsbGlwc2lzQ29udGFpbmVyPjwvc3Bhbj5cclxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaXNFbGxpcHNpc1wiPnt7IGVsbGlwc2lzU3RyIH19PC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInN1ZmZpeFwiPnt7IHN1ZmZpeCB9fTwvbmctY29udGFpbmVyPlxyXG4gICAgICAgIDxhICNleHBhbmRhYmxlICpuZ0lmPVwiZXhwYW5kYWJsZSAmJiBpc0VsbGlwc2lzXCIgY2xhc3M9XCJ0ZHMtdHlwb2dyYXBoeS1leHBhbmQgdGV4dC1pbmZvLTUwMCBjdXJzb3ItcG9pbnRlciB0ZXh0LWJvZHktMlwiIChjbGljayk9XCJvbkV4cGFuZCgkZXZlbnQpXCI+XHJcbiAgICAgICAgICB7eyBsb2NhbGU/LmV4cGFuZCB9fVxyXG4gICAgICAgIDwvYT5cclxuICAgICAgPC9uZy10ZW1wbGF0ZT5cclxuICAgIDwvbmctY29udGFpbmVyPlxyXG5cclxuICAgIDx0ZHMtdGV4dC1lZGl0XHJcbiAgICAgICpuZ0lmPVwiZWRpdGFibGVcIlxyXG4gICAgICBbdGV4dF09XCJjb250ZW50XCJcclxuICAgICAgW2ljb25dPVwiZWRpdEljb25cIlxyXG4gICAgICBbdG9vbHRpcF09XCJlZGl0VG9vbHRpcFwiXHJcbiAgICAgIChlbmRFZGl0aW5nKT1cIm9uRW5kRWRpdGluZygkZXZlbnQpXCJcclxuICAgICAgKHN0YXJ0RWRpdGluZyk9XCJvblN0YXJ0RWRpdGluZygpXCJcclxuICAgICBcclxuICAgID48L3Rkcy10ZXh0LWVkaXQ+XHJcblxyXG4gICAgPHRkcy10ZXh0LWNvcHlcclxuICAgICAgKm5nSWY9XCJjb3B5YWJsZSAmJiAhZWRpdGluZ1wiXHJcbiAgICAgIFt0ZXh0XT1cIm9uQ29weVRleHRcIlxyXG4gICAgICBbdG9vbHRpcHNdPVwiY29weVRvb2x0aXBzXCJcclxuICAgICAgW2ljb25zXT1cImNvcHlJY29uc1wiXHJcbiAgICAgICh0ZXh0Q29weSk9XCJvblRleHRDb3B5KCRldmVudClcIlxyXG4gICAgPjwvdGRzLXRleHQtY29weT5cclxuICBgLFxyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxyXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgcHJlc2VydmVXaGl0ZXNwYWNlczogZmFsc2UsXHJcbiAgaG9zdDoge1xyXG4gICAgJ1tjbGFzcy50ZHMtdHlwb2dyYXBoeV0nOiAnIWVkaXRpbmcnLFxyXG4gICAgJ1tjbGFzcy5icmVhay13b3Jkc10nOiAnIWVkaXRpbmcnLFxyXG4gICAgJ1tjbGFzcy50ZHMtdHlwb2dyYXBoeS1ydGxdJzogJ2RpciA9PT0gXCJydGxcIicsXHJcbiAgICAnW2NsYXNzLnRkcy10eXBvZ3JhcGh5LWVkaXQtY29udGVudF0nOiAnZWRpdGluZycsXHJcbiAgICAnW2NsYXNzLnRleHQtbmV1dHJhbC0xLTQwMF0nOiAnY29sb3IgPT09IFwic2Vjb25kYXJ5XCInLFxyXG4gICAgJ1tjbGFzcy50ZXh0LXdhcm5pbmctNDAwXSc6ICdjb2xvciA9PT0gXCJ3YXJuaW5nXCInLFxyXG4gICAgJ1tjbGFzcy50ZXh0LWVycm9yLTQwMF0nOiAnY29sb3IgPT09IFwiZGFuZ2VyXCInLFxyXG4gICAgJ1tjbGFzcy50ZXh0LXN1Y2Nlc3MtNDAwXSc6ICdjb2xvciA9PT0gXCJzdWNjZXNzXCInLFxyXG4gICAgJ1tjbGFzcy50ZHMtdHlwb2dyYXBoeS1kaXNhYmxlZF0nOiAnZGlzYWJsZWQnLFxyXG4gICAgJ1tjbGFzcy50ZHMtdHlwb2dyYXBoeS1lbGxpcHNpc10nOiAnZWxsaXBzaXMgJiYgIWV4cGFuZGVkJyxcclxuXHJcbiAgICAnW2NsYXNzLnRkcy10eXBvZ3JhcGh5LXNpbmdsZS1saW5lXSc6ICdlbGxpcHNpcyAmJiBlbGxpcHNpc1Jvd3MgPT09IDEnLFxyXG4gICAgJ1tjbGFzcy53aGl0ZXNwYWNlLW5vd3JhcF0nOiAnZWxsaXBzaXMgJiYgZWxsaXBzaXNSb3dzID09PSAxJyxcclxuXHJcbiAgICAnW2NsYXNzLnRkcy10eXBvZ3JhcGh5LWVsbGlwc2lzLXNpbmdsZS1saW5lXSc6ICdjYW5Dc3NFbGxpcHNpcyAmJiBlbGxpcHNpc1Jvd3MgPT09IDEnLFxyXG4gICAgJ1tjbGFzcy5vdmVyZmxvdy1oaWRkZW5dJzogJ2NhbkNzc0VsbGlwc2lzICYmIGVsbGlwc2lzUm93cyA9PT0gMScsXHJcbiAgICAnW2NsYXNzLm92ZXJmbG93LWVsbGlwc2lzXSc6ICdjYW5Dc3NFbGxpcHNpcyAmJiBlbGxpcHNpc1Jvd3MgPT09IDEnLFxyXG5cclxuICAgICdbY2xhc3MudGRzLXR5cG9ncmFwaHktZWxsaXBzaXMtbXVsdGlwbGUtbGluZV0nOiAnY2FuQ3NzRWxsaXBzaXMgJiYgZWxsaXBzaXNSb3dzID4gMScsXHJcbiAgICAnW3N0eWxlLi13ZWJraXQtbGluZS1jbGFtcF0nOiAnKGNhbkNzc0VsbGlwc2lzICYmIGVsbGlwc2lzUm93cyA+IDEpID8gZWxsaXBzaXNSb3dzIDogbnVsbCdcclxuICB9XHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBURFNUeXBvZ3JhcGh5Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3ksIE9uQ2hhbmdlcyB7XHJcbiAgcmVhZG9ubHkgX3Rkc01vZHVsZU5hbWU6IFREU0NvbmZpZ0tleSA9IFREU19DT05GSUdfTU9EVUxFX05BTUU7XHJcblxyXG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9jb3B5YWJsZTogQm9vbGVhbklucHV0O1xyXG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9lZGl0YWJsZTogQm9vbGVhbklucHV0O1xyXG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9kaXNhYmxlZDogQm9vbGVhbklucHV0O1xyXG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9leHBhbmRhYmxlOiBCb29sZWFuSW5wdXQ7XHJcbiAgc3RhdGljIG5nQWNjZXB0SW5wdXRUeXBlX2VsbGlwc2lzOiBCb29sZWFuSW5wdXQ7XHJcbiAgc3RhdGljIG5nQWNjZXB0SW5wdXRUeXBlX2VsbGlwc2lzUm93czogTnVtYmVySW5wdXQ7XHJcbiAgQElucHV0KCkgQElucHV0Qm9vbGVhbigpIGNvcHlhYmxlID0gZmFsc2U7XHJcbiAgQElucHV0KCkgQElucHV0Qm9vbGVhbigpIGVkaXRhYmxlID0gZmFsc2U7XHJcbiAgQElucHV0KCkgQElucHV0Qm9vbGVhbigpIGRpc2FibGVkID0gZmFsc2U7XHJcbiAgQElucHV0KCkgQElucHV0Qm9vbGVhbigpIGV4cGFuZGFibGUgPSBmYWxzZTtcclxuICBASW5wdXQoKSBASW5wdXRCb29sZWFuKCkgZWxsaXBzaXMgPSBmYWxzZTtcclxuICBASW5wdXQoKSBAV2l0aENvbmZpZygpIGNvcHlUb29sdGlwcz86IFtURFNUU1R5cGUsIFREU1RTVHlwZV0gfCBudWxsID0gdW5kZWZpbmVkO1xyXG4gIEBJbnB1dCgpIEBXaXRoQ29uZmlnKCkgY29weUljb25zOiBbVERTVFNUeXBlLCBURFNUU1R5cGVdID0gWyd0ZHNpLWNvcHktZmlsbCcsICd0ZHNpLXRpY2stZmlsbCddO1xyXG4gIEBJbnB1dCgpIEBXaXRoQ29uZmlnKCkgZWRpdFRvb2x0aXA/OiBudWxsIHwgVERTVFNUeXBlID0gdW5kZWZpbmVkO1xyXG4gIEBJbnB1dCgpIEBXaXRoQ29uZmlnKCkgZWRpdEljb246IFREU1RTVHlwZSA9ICd0ZHNpLWVkaXQtZmlsbCc7XHJcbiAgQElucHV0KCkgY29udGVudD86IHN0cmluZztcclxuICBASW5wdXQoKSBAV2l0aENvbmZpZygpIEBJbnB1dE51bWJlcigpIGVsbGlwc2lzUm93czogbnVtYmVyID0gMTtcclxuICBASW5wdXQoKSBjb2xvcjogJ3NlY29uZGFyeScgfCAnd2FybmluZycgfCAnZXJyb3InIHwgJ3N1Y2Nlc3MnIHwgdW5kZWZpbmVkO1xyXG4gIEBJbnB1dCgpIGNvcHlUZXh0OiBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgQElucHV0KCkgc3VmZml4OiBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgQElucHV0KCkgY29udGVudENvbGxhcHNlITogc3RyaW5nIHwgVGVtcGxhdGVSZWY8VERTU2FmZUFueT47XHJcbiAgQE91dHB1dCgpIHJlYWRvbmx5IGNvbnRlbnRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZz4oKTtcclxuICBAT3V0cHV0KCkgcmVhZG9ubHkgY29weSA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xyXG4gIEBPdXRwdXQoKSByZWFkb25seSBleHBhbmRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcbiAgLy8gVGhpcyBpcyBub3QgYSB0d28td2F5IGJpbmRpbmcgb3V0cHV0IHdpdGgge0BsaW5rIGVsbGlwc2lzfVxyXG4gIEBPdXRwdXQoKSByZWFkb25seSBlbGxpcHNpc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcclxuXHJcbiAgQFZpZXdDaGlsZChURFNUZXh0RWRpdENvbXBvbmVudCwgeyBzdGF0aWM6IGZhbHNlIH0pIHRleHRFZGl0UmVmPzogVERTVGV4dEVkaXRDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZChURFNUZXh0Q29weUNvbXBvbmVudCwgeyBzdGF0aWM6IGZhbHNlIH0pIHRleHRDb3B5UmVmPzogVERTVGV4dENvcHlDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnZWxsaXBzaXNDb250YWluZXInLCB7IHN0YXRpYzogZmFsc2UgfSkgZWxsaXBzaXNDb250YWluZXI/OiBFbGVtZW50UmVmPEhUTUxTcGFuRWxlbWVudD47XHJcbiAgQFZpZXdDaGlsZCgnZXhwYW5kYWJsZScsIHsgc3RhdGljOiBmYWxzZSB9KSBleHBhbmRhYmxlQnRuPzogRWxlbWVudFJlZjxIVE1MU3BhbkVsZW1lbnQ+O1xyXG4gIEBWaWV3Q2hpbGQoJ2NvbnRlbnRUZW1wbGF0ZScsIHsgc3RhdGljOiBmYWxzZSB9KSBjb250ZW50VGVtcGxhdGU/OiBUZW1wbGF0ZVJlZjx7IGNvbnRlbnQ6IHN0cmluZyB9PjtcclxuXHJcbiAgbG9jYWxlITogVERTVGV4dEkxOG5JbnRlcmZhY2U7XHJcbiAgZG9jdW1lbnQ6IERvY3VtZW50O1xyXG4gIGV4cGFuZGFibGVCdG5FbGVtZW50Q2FjaGU6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgZWRpdGluZyA9IGZhbHNlO1xyXG4gIGVsbGlwc2lzVGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gIGNzc0VsbGlwc2lzOiBib29sZWFuID0gZmFsc2U7XHJcbiAgaXNFbGxpcHNpczogYm9vbGVhbiA9IHRydWU7XHJcbiAgZXhwYW5kZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBlbGxpcHNpc1N0ciA9ICcuLi4nO1xyXG4gIGRpcjogRGlyZWN0aW9uID0gJ2x0cic7XHJcblxyXG4gIGdldCBoYXNFbGxpcHNpc09ic2VydmVycygpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmVsbGlwc2lzQ2hhbmdlLm9ic2VydmVycy5sZW5ndGggPiAwO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNhbkNzc0VsbGlwc2lzKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZWxsaXBzaXMgJiYgdGhpcy5jc3NFbGxpcHNpcyAmJiAhdGhpcy5leHBhbmRlZCAmJiAhdGhpcy5oYXNFbGxpcHNpc09ic2VydmVycztcclxuICB9XHJcblxyXG4gIGdldCBoYXNPcGVyYXRpb25zV2l0aEVsbGlwc2lzKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICh0aGlzLmNvcHlhYmxlIHx8IHRoaXMuZWRpdGFibGUgfHwgdGhpcy5leHBhbmRhYmxlKSAmJiB0aGlzLmVsbGlwc2lzO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB2aWV3SW5pdCA9IGZhbHNlO1xyXG4gIHByaXZhdGUgcmZhSWQ6IG51bWJlciA9IC0xO1xyXG4gIHByaXZhdGUgZGVzdHJveSQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xyXG4gIHByaXZhdGUgd2luZG93UmVzaXplU3Vic2NyaXB0aW9uID0gU3Vic2NyaXB0aW9uLkVNUFRZO1xyXG4gIGdldCBvbkNvcHlUZXh0KCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiB0aGlzLmNvcHlUZXh0ID09PSAnc3RyaW5nJyA/IHRoaXMuY29weVRleHQgOiB0aGlzLmNvbnRlbnQpITtcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHRkc0NvbmZpZ1NlcnZpY2U6IFREU0NvbmZpZ1NlcnZpY2UsXHJcbiAgICBwcml2YXRlIGhvc3Q6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LFxyXG4gICAgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgcHJpdmF0ZSB2aWV3Q29udGFpbmVyUmVmOiBWaWV3Q29udGFpbmVyUmVmLFxyXG4gICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxyXG4gICAgcHJpdmF0ZSBwbGF0Zm9ybTogUGxhdGZvcm0sXHJcbiAgICBwcml2YXRlIGkxOG46IFREU0kxOG5TZXJ2aWNlLFxyXG4gICAgQEluamVjdChET0NVTUVOVCkgZG9jdW1lbnQ6IFREU1NhZmVBbnksXHJcbiAgICBwcml2YXRlIHJlc2l6ZVNlcnZpY2U6IFREU1Jlc2l6ZVNlcnZpY2UsXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGRpcmVjdGlvbmFsaXR5OiBEaXJlY3Rpb25hbGl0eVxyXG4gICkge1xyXG4gICAgdGhpcy5kb2N1bWVudCA9IGRvY3VtZW50O1xyXG4gIH1cclxuXHJcbiAgb25UZXh0Q29weSh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuY29weS5lbWl0KHRleHQpO1xyXG4gIH1cclxuXHJcbiAgb25TdGFydEVkaXRpbmcoKTogdm9pZCB7XHJcbiAgICB0aGlzLmVkaXRpbmcgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgb25FbmRFZGl0aW5nKHRleHQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5lZGl0aW5nID0gZmFsc2U7XHJcbiAgICB0aGlzLmNvbnRlbnRDaGFuZ2UuZW1pdCh0ZXh0KTtcclxuICAgIGlmICh0aGlzLmNvbnRlbnQgPT09IHRleHQpIHtcclxuICAgICAgdGhpcy5yZW5kZXJPbk5leHRGcmFtZSgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgfVxyXG5cclxuICBvbkV4cGFuZChldmVudDogTW91c2VFdmVudCB8IG51bGwpOiB2b2lkIHtcclxuICAgIGlmKGV2ZW50KVxyXG4gICAge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuICAgIH1cclxuICAgIHRoaXMuaXNFbGxpcHNpcyA9IGZhbHNlO1xyXG4gICAgdGhpcy5leHBhbmRlZCA9IHRydWU7XHJcbiAgICB0aGlzLmV4cGFuZENoYW5nZS5lbWl0KCk7XHJcbiAgICB0aGlzLmVsbGlwc2lzQ2hhbmdlLmVtaXQoZmFsc2UpO1xyXG4gIH1cclxuXHJcbiAgY2FuVXNlQ1NTRWxsaXBzaXMoKTogYm9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy5lZGl0YWJsZSB8fCB0aGlzLmNvcHlhYmxlIHx8IHRoaXMuZXhwYW5kYWJsZSB8fCB0aGlzLnN1ZmZpeCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvLyBtYWtlIHN1cmUge0BsaW5rIGVsbGlwc2lzQ2hhbmdlfSB3b3Jrcywgd2lsbCBmb3JjZSB1c2UgSlMgdG8gY2FsY3VsYXRpb25zXHJcbiAgICBpZiAodGhpcy5oYXNFbGxpcHNpc09ic2VydmVycykge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5lbGxpcHNpc1Jvd3MgPT09IDEpIHtcclxuICAgICAgcmV0dXJuIGlzU3R5bGVTdXBwb3J0KCd0ZXh0T3ZlcmZsb3cnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBpc1N0eWxlU3VwcG9ydCgnd2Via2l0TGluZUNsYW1wJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXJPbk5leHRGcmFtZSgpOiB2b2lkIHtcclxuICAgIGNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJmYUlkKTtcclxuICAgIGlmICghdGhpcy52aWV3SW5pdCB8fCAhdGhpcy5lbGxpcHNpcyB8fCB0aGlzLmVsbGlwc2lzUm93cyA8IDAgfHwgdGhpcy5leHBhbmRlZCB8fCAhdGhpcy5wbGF0Zm9ybS5pc0Jyb3dzZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5yZmFJZCA9IHJlcUFuaW1GcmFtZSgoKSA9PiB7XHJcbiAgICAgIHRoaXMuc3luY0VsbGlwc2lzKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldE9yaWdpbkNvbnRlbnRWaWV3UmVmKCk6IHsgdmlld1JlZjogRW1iZWRkZWRWaWV3UmVmPHsgY29udGVudDogc3RyaW5nIH0+OyByZW1vdmVWaWV3KCk6IHZvaWQgfSB7XHJcbiAgICBjb25zdCB2aWV3UmVmID0gdGhpcy52aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUVtYmVkZGVkVmlldzx7IGNvbnRlbnQ6IHN0cmluZyB9Pih0aGlzLmNvbnRlbnRUZW1wbGF0ZSEsIHtcclxuICAgICAgY29udGVudDogdGhpcy5jb250ZW50IVxyXG4gICAgfSk7XHJcbiAgICB2aWV3UmVmLmRldGVjdENoYW5nZXMoKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHZpZXdSZWYsXHJcbiAgICAgIHJlbW92ZVZpZXc6ICgpID0+IHtcclxuICAgICAgICB0aGlzLnZpZXdDb250YWluZXJSZWYucmVtb3ZlKHRoaXMudmlld0NvbnRhaW5lclJlZi5pbmRleE9mKHZpZXdSZWYpKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHN5bmNFbGxpcHNpcygpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmNzc0VsbGlwc2lzKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHsgdmlld1JlZiwgcmVtb3ZlVmlldyB9ID0gdGhpcy5nZXRPcmlnaW5Db250ZW50Vmlld1JlZigpO1xyXG4gICAgY29uc3QgZml4ZWROb2RlcyA9IFt0aGlzLnRleHRDb3B5UmVmLCB0aGlzLnRleHRFZGl0UmVmXVxyXG4gICAgICAuZmlsdGVyKGUgPT4gZSAmJiBlLm5hdGl2ZUVsZW1lbnQpXHJcbiAgICAgIC5tYXAoZSA9PiBlIS5uYXRpdmVFbGVtZW50KTtcclxuICAgIGNvbnN0IGV4cGFuZGFibGVCdG5FbGVtZW50ID0gdGhpcy5nZXRFeHBhbmRhYmxlQnRuRWxlbWVudCgpO1xyXG4gICAgaWYgKGV4cGFuZGFibGVCdG5FbGVtZW50KSB7XHJcbiAgICAgIGZpeGVkTm9kZXMucHVzaChleHBhbmRhYmxlQnRuRWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IGNvbnRlbnROb2RlcywgdGV4dCwgZWxsaXBzaXMgfSA9IG1lYXN1cmUoXHJcbiAgICAgIHRoaXMuaG9zdC5uYXRpdmVFbGVtZW50LFxyXG4gICAgICB0aGlzLmVsbGlwc2lzUm93cyxcclxuICAgICAgdmlld1JlZi5yb290Tm9kZXMsXHJcbiAgICAgIGZpeGVkTm9kZXMsXHJcbiAgICAgIHRoaXMuZWxsaXBzaXNTdHIsXHJcbiAgICAgIHRoaXMuc3VmZml4XHJcbiAgICApO1xyXG5cclxuICAgIHJlbW92ZVZpZXcoKTtcclxuXHJcbiAgICB0aGlzLmVsbGlwc2lzVGV4dCA9IHRleHQ7XHJcbiAgICBpZiAoZWxsaXBzaXMgIT09IHRoaXMuaXNFbGxpcHNpcykge1xyXG4gICAgICB0aGlzLmlzRWxsaXBzaXMgPSBlbGxpcHNpcztcclxuICAgICAgdGhpcy5lbGxpcHNpc0NoYW5nZS5lbWl0KGVsbGlwc2lzKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGVsbGlwc2lzQ29udGFpbmVyTmF0aXZlRWxlbWVudCA9IHRoaXMuZWxsaXBzaXNDb250YWluZXIhLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICB3aGlsZSAoZWxsaXBzaXNDb250YWluZXJOYXRpdmVFbGVtZW50LmZpcnN0Q2hpbGQpIHtcclxuICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDaGlsZChlbGxpcHNpc0NvbnRhaW5lck5hdGl2ZUVsZW1lbnQsIGVsbGlwc2lzQ29udGFpbmVyTmF0aXZlRWxlbWVudC5maXJzdENoaWxkKTtcclxuICAgIH1cclxuICAgIGNvbnRlbnROb2Rlcy5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKGVsbGlwc2lzQ29udGFpbmVyTmF0aXZlRWxlbWVudCwgbi5jbG9uZU5vZGUodHJ1ZSkpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICB9XHJcblxyXG4gIC8vIE5lZWQgdG8gY3JlYXRlIHRoZSBlbGVtZW50IGZvciBjYWxjdWxhdGlvbiBzaXplIGJlZm9yZSB2aWV3IGluaXRcclxuICBwcml2YXRlIGdldEV4cGFuZGFibGVCdG5FbGVtZW50KCk6IEhUTUxFbGVtZW50IHwgbnVsbCB7XHJcbiAgICBpZiAodGhpcy5leHBhbmRhYmxlKSB7XHJcbiAgICAgIGNvbnN0IGV4cGFuZFRleHQgPSB0aGlzLmxvY2FsZSA/IHRoaXMubG9jYWxlLmV4cGFuZCA6ICcnO1xyXG4gICAgICBjb25zdCBjYWNoZSA9IHRoaXMuZXhwYW5kYWJsZUJ0bkVsZW1lbnRDYWNoZTtcclxuICAgICAgaWYgKCFjYWNoZSB8fCBjYWNoZS5pbm5lclRleHQgPT09IGV4cGFuZFRleHQpIHtcclxuICAgICAgICBjb25zdCBlbCA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIGVsLmNsYXNzTmFtZSA9IEVYUEFORF9FTEVNRU5UX0NMQVNTTkFNRTtcclxuICAgICAgICBlbC5pbm5lclRleHQgPSBleHBhbmRUZXh0O1xyXG4gICAgICAgIHRoaXMuZXhwYW5kYWJsZUJ0bkVsZW1lbnRDYWNoZSA9IGVsO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLmV4cGFuZGFibGVCdG5FbGVtZW50Q2FjaGU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmV4cGFuZGFibGVCdG5FbGVtZW50Q2FjaGUgPSBudWxsO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVuZGVyQW5kU3Vic2NyaWJlV2luZG93UmVzaXplKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMucGxhdGZvcm0uaXNCcm93c2VyKSB7XHJcbiAgICAgIHRoaXMud2luZG93UmVzaXplU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgIHRoaXMuY3NzRWxsaXBzaXMgPSB0aGlzLmNhblVzZUNTU0VsbGlwc2lzKCk7XHJcbiAgICAgIHRoaXMucmVuZGVyT25OZXh0RnJhbWUoKTtcclxuICAgICAgdGhpcy53aW5kb3dSZXNpemVTdWJzY3JpcHRpb24gPSB0aGlzLnJlc2l6ZVNlcnZpY2VcclxuICAgICAgICAuc3Vic2NyaWJlKClcclxuICAgICAgICAucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpXHJcbiAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLnJlbmRlck9uTmV4dEZyYW1lKCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmkxOG4ubG9jYWxlQ2hhbmdlLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICB0aGlzLmxvY2FsZSA9IHRoaXMuaTE4bi5nZXRMb2NhbGVEYXRhKCdUZXh0Jyk7XHJcbiAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5kaXJlY3Rpb25hbGl0eS5jaGFuZ2U/LnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKS5zdWJzY3JpYmUoKGRpcmVjdGlvbjogRGlyZWN0aW9uKSA9PiB7XHJcbiAgICAgIHRoaXMuZGlyID0gZGlyZWN0aW9uO1xyXG4gICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmRpciA9IHRoaXMuZGlyZWN0aW9uYWxpdHkudmFsdWU7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnZpZXdJbml0ID0gdHJ1ZTtcclxuICAgIHRoaXMucmVuZGVyQW5kU3Vic2NyaWJlV2luZG93UmVzaXplKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvcHlhYmxlLCBlZGl0YWJsZSwgZXhwYW5kYWJsZSwgZWxsaXBzaXMsIGNvbnRlbnQsIGVsbGlwc2lzUm93cywgc3VmZml4IH0gPSBjaGFuZ2VzO1xyXG4gICAgaWYgKGNvcHlhYmxlIHx8IGVkaXRhYmxlIHx8IGV4cGFuZGFibGUgfHwgZWxsaXBzaXMgfHwgY29udGVudCB8fCBlbGxpcHNpc1Jvd3MgfHwgc3VmZml4KSB7XHJcbiAgICAgIGlmICh0aGlzLmVsbGlwc2lzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZXhwYW5kZWQpIHtcclxuICAgICAgICAgIHRoaXMud2luZG93UmVzaXplU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMucmVuZGVyQW5kU3Vic2NyaWJlV2luZG93UmVzaXplKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBvbkNvbGxhcHNlKGV2ZW50Ok1vdXNlRXZlbnQgfCBudWxsKSB7XHJcbiAgICBpZihldmVudClcclxuICAgIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBpZiAodGhpcy5leHBhbmRlZCAmJiAhdGhpcy5pc0VsbGlwc2lzKSB7XHJcbiAgICAgIHRoaXMuZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgdGhpcy5pc0VsbGlwc2lzID0gdHJ1ZTtcclxuICAgICAgdGhpcy5lbGxpcHNpcyA9IHRydWU7XHJcbiAgICAgIHRoaXMuZWxsaXBzaXNDaGFuZ2UuZW1pdCh0cnVlKTtcclxuICAgICAgdGhpcy5yZW5kZXJBbmRTdWJzY3JpYmVXaW5kb3dSZXNpemUoKTtcclxuICAgIH1cclxuICB9XHJcbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcclxuICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuICAgIHRoaXMuZXhwYW5kYWJsZUJ0bkVsZW1lbnRDYWNoZSA9IG51bGw7XHJcbiAgICB0aGlzLndpbmRvd1Jlc2l6ZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gIH1cclxufVxyXG4iXX0=