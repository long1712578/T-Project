import { __decorate } from "tslib";
import { Directive, Input, Optional } from "@angular/core";
import { fromEvent, Subject } from "rxjs";
import { takeUntil } from "rxjs/operators";
import { InputBoolean } from "tds-ui/shared/utility";
import * as i0 from "@angular/core";
import * as i1 from "./button-group.component";
export class TDSButtonBase {
    constructor(ngZone, elementRef, cdr, _buttonGroup) {
        this.ngZone = ngZone;
        this.elementRef = elementRef;
        this.cdr = cdr;
        this._buttonGroup = _buttonGroup;
        this.loading = false;
        this.color = 'primary';
        this.size = 'md';
        this.disabled = false;
        this.rounded = 'rounded-md';
        this.cssClass = '';
        this.spinerColor = 'white';
        this.loadingCss = '';
        this.destroy$ = new Subject();
    }
    ngOnInit() {
        this.buildCss();
        this.ngZone.runOutsideAngular(() => {
            // Caretaker note: this event listener could've been added through `host.click` or `HostListener`.
            // The compiler generates the `ɵɵlistener` instruction which wraps the actual listener internally into the
            // function, which runs `markDirty()` before running the actual listener (the decorated class method).
            // Since we're preventing the default behavior and stopping event propagation this doesn't require Angular to run the change detection.
            fromEvent(this.elementRef.nativeElement, 'click', { capture: true })
                .pipe(takeUntil(this.destroy$))
                .subscribe(event => {
                if ((this.disabled && event.target?.tagName === 'A') || this.loading) {
                    event.preventDefault();
                    event.stopImmediatePropagation();
                }
            });
        });
    }
    ngOnChanges(changes) {
        const { size, loading, color, loadingTemplate, disabled } = changes;
        if ((size && !size.firstChange) || (loading && !loading.firstChange) || (color && !color.firstChange) || (disabled && !disabled.firstChange)) {
            this.buildCss();
            this.cdr.markForCheck();
        }
        if (loadingTemplate && !loadingTemplate.firstChange) {
            this.cdr.markForCheck();
        }
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
    getClassCssLoading() {
        return `absolute -inset-px opacity-[.35] bg-white cursor-progress dark:bg-d-neutral-3-50 ${this.getClassCssButtonGroup()}`;
    }
    getClassCssDisabled() {
        return 'cursor-not-allowed border text-neutral-1-300 border-neutral-2-200 bg-neutral-3-50 dark:text-d-neutral-1-300 dark:border-d-neutral-2-200 dark:bg-d-neutral-3-200 ';
    }
    getClassCssActive() {
        let result = 'focus:ring focus:outline-none cursor-pointer';
        switch (this.color) {
            case "primary":
                result += ` text-white ring-primary-1 border-primary-1 bg-primary-1 hover:bg-primary-2 focus:bg-primary-1 hover:border-primary-2 focus:border-primary-1 dark:ring-d-primary-1 dark:border-d-primary-1 dark:bg-d-primary-1 dark:hover:bg-d-primary-2 dark:focus:bg-d-primary-1 dark:hover:border-d-primary-2 dark:focus:border-d-primary-1 `;
                break;
            case "secondary":
                result += ` text-neutral-1-900 dark:text-d-neutral-1-900  ring-primary-1 dark:ring-d-primary-1 border-neutral-2-200 dark:border-d-neutral-2-200 bg-white hover:bg-neutral-3-50 focus:bg-white dark:focus:bg-d-neutral-3-300 focus:border-primary-1 dark:focus:border-d-primary-1 dark:bg-d-neutral-3-300 dark:hover:bg-d-neutral-3-400 `;
                break;
            case 'info':
                result += ` text-white ring-info-400 border-info-400 bg-info-400 hover:bg-info-500 focus:bg-info-400 hover:border-info-500 focus:border-info-400  dark:ring-d-info-400 dark:border-d-info-400 dark:bg-d-info-400 dark:hover:bg-d-info-500 dark:focus:bg-d-info-400 dark:hover:border-d-info-500 dark:focus:border-d-info-400`;
                break;
            case 'success':
                result += ` text-white ring-success-400 border-success-400 bg-success-400 hover:bg-success-500 focus:bg-success-400 hover:border-success-500 focus:border-success-400  dark:ring-d-success-400 dark:border-d-success-400 dark:bg-d-success-400 dark:hover:bg-d-success-500 dark:focus:bg-d-success-400 dark:hover:border-d-success-500 dark:focus:border-d-success-400 `;
                break;
            case 'warning':
                result += ` text-white ring-warning-400 border-warning-400 bg-warning-400 hover:bg-warning-500 focus:bg-warning-400 hover:border-warning-500 focus:border-warning-400 dark:ring-d-warning-400 dark:border-d-warning-400 dark:bg-d-warning-400 dark:hover:bg-d-warning-500 dark:focus:bg-d-warning-400 dark:hover:border-d-warning-500 dark:focus:border-d-warning-400 `;
                break;
            case 'error':
                result += ` text-white ring-error-400 border-error-400 bg-error-400 hover:bg-error-500 focus:bg-error-400 hover:border-error-500 focus:border-error-400 dark:ring-d-error-400 dark:border-d-error-400 dark:bg-d-error-400 dark:hover:bg-d-error-500 dark:focus:bg-d-error-400 dark:hover:border-d-error-500 dark:focus:border-d-error-400 `;
                break;
            case 'red':
                result += ' text-white ring-base-red-500 border-base-red-500 bg-base-red-500 hover:bg-base-red-600 focus:bg-base-red-500 hover:border-base-red-600 focus:border-base-red-500 dark:ring-d-base-red-500 dark:border-d-base-red-500 dark:bg-d-base-red-500 dark:hover:bg-d-base-red-600 dark:focus:bg-d-base-red-500 dark:hover:border-d-base-red-600 dark:focus:border-d-base-red-500 ';
                break;
            case 'yellow':
                result += ' text-white ring-base-yellow-500 border-base-yellow-500 bg-base-yellow-500 hover:bg-base-yellow-600 focus:bg-base-yellow-500 hover:border-base-yellow-600 focus:border-base-yellow-500 dark:ring-d-base-yellow-500 dark:border-d-base-yellow-500 dark:bg-d-base-yellow-500 dark:hover:bg-d-base-yellow-600 dark:focus:bg-d-base-yellow-500 dark:hover:border-d-base-yellow-600 dark:focus:border-d-base-yellow-500 ';
                break;
            case 'green':
                result += ' text-white ring-base-green-500 border-base-green-500 bg-base-green-500 hover:bg-base-green-600 focus:bg-base-green-500 hover:border-base-green-600 focus:border-base-green-500 dark:ring-d-base-green-500 dark:border-d-base-green-500 dark:bg-d-base-green-500 dark:hover:bg-d-base-green-600 dark:focus:bg-d-base-green-500 dark:hover:border-d-base-green-600 dark:focus:border-d-base-green-500 ';
                break;
            case 'blue':
                result += ' text-white ring-base-blue-500 border-base-blue-500 bg-base-blue-500 hover:bg-base-blue-600 focus:bg-base-blue-500 hover:border-base-blue-600 focus:border-base-blue-500 dark:ring-d-base-blue-500 dark:border-d-base-blue-500 dark:bg-d-base-blue-500 dark:hover:bg-d-base-blue-600 dark:focus:bg-d-base-blue-500 dark:hover:border-d-base-blue-600 dark:focus:border-d-base-blue-500 ';
                break;
            case 'indigo':
                result += ' text-white ring-base-indigo-500 border-base-indigo-500 bg-base-indigo-500 hover:bg-base-indigo-600 focus:bg-base-indigo-500 hover:border-base-indigo-600 focus:border-base-indigo-500 dark:ring-d-base-indigo-500 dark:border-d-base-indigo-500 dark:bg-d-base-indigo-500 dark:hover:bg-d-base-indigo-600 dark:focus:bg-d-base-indigo-500 dark:hover:border-d-base-indigo-600 dark:focus:border-d-base-indigo-500 ';
                break;
            case 'purple':
                result += ' text-white ring-base-purple-500 border-base-purple-500 bg-base-purple-500 hover:bg-base-purple-600 focus:bg-base-purple-500 hover:border-base-purple-600 focus:border-base-purple-500 dark:ring-d-base-purple-500 dark:border-d-base-purple-500 dark:bg-d-base-purple-500 dark:hover:bg-d-base-purple-600 dark:focus:bg-d-base-purple-500 dark:hover:border-d-base-purple-600 dark:focus:border-d-base-purple-500 ';
                break;
            case 'pink':
                result += ' text-white ring-base-pink-500 border-base-pink-500 bg-base-pink-500 hover:bg-base-pink-600 focus:bg-base-pink-500 hover:border-base-pink-600 focus:border-base-pink-500 dark:ring-d-base-pink-500 dark:border-d-base-pink-500 dark:bg-d-base-pink-500 dark:hover:bg-d-base-pink-600 dark:focus:bg-d-base-pink-500 dark:hover:border-d-base-pink-600 dark:focus:border-d-base-pink-500 ';
                break;
            case 'amber':
                result += ' text-white ring-base-amber-500 border-base-amber-500 bg-base-amber-500 hover:bg-base-amber-600 focus:bg-base-amber-500 hover:border-base-amber-600 focus:border-base-amber-500 dark:ring-d-base-amber-500 dark:border-d-base-amber-500 dark:bg-d-base-amber-500 dark:hover:bg-d-base-amber-600 dark:focus:bg-d-base-amber-500 dark:hover:border-d-base-amber-600 dark:focus:border-d-base-amber-500 ';
                break;
            case 'sky':
                result += ' text-white ring-base-sky-500 border-base-sky-500 bg-base-sky-500 hover:bg-base-sky-600 focus:bg-base-sky-500 hover:border-base-sky-600 focus:border-base-sky-500 dark:ring-d-base-sky-500 dark:border-d-base-sky-500 dark:bg-d-base-sky-500 dark:hover:bg-d-base-sky-600 dark:focus:bg-d-base-sky-500 dark:hover:border-d-base-sky-600 dark:focus:border-d-base-sky-500 ';
                break;
            case 'lime':
                result += ' text-white ring-base-lime-500 border-base-lime-500 bg-base-lime-500 hover:bg-base-lime-600 focus:bg-base-lime-500 hover:border-base-lime-600 focus:border-base-lime-500 dark:ring-d-base-lime-500 dark:border-d-base-lime-500 dark:bg-d-base-lime-500 dark:hover:bg-d-base-lime-600 dark:focus:bg-d-base-lime-500 dark:hover:border-d-base-lime-600 dark:focus:border-d-base-lime-500 ';
                break;
            case 'teal':
                result += ' text-white ring-base-teal-500 border-base-teal-500 bg-base-teal-500 hover:bg-base-teal-600 focus:bg-base-teal-500 hover:border-base-teal-600 focus:border-base-teal-500 dark:ring-d-base-teal-500 dark:border-d-base-teal-500 dark:bg-d-base-teal-500 dark:hover:bg-d-base-teal-600 dark:focus:bg-d-base-teal-500 dark:hover:border-d-base-teal-600 dark:focus:border-d-base-teal-500 ';
                break;
            case 'orange':
                result += ' text-white ring-base-orange-500 border-base-orange-500 bg-base-orange-500 hover:bg-base-orange-600 focus:bg-base-orange-500 hover:border-base-orange-600 focus:border-base-orange-500 dark:ring-d-base-orange-500 dark:border-d-base-orange-500 dark:bg-d-base-orange-500 dark:hover:bg-d-base-orange-600 dark:focus:bg-d-base-orange-500 dark:hover:border-d-base-orange-600 dark:focus:border-d-base-orange-500 ';
                break;
            // custom : dev tự style theo thiết kế
            case 'custom':
                result += '';
                break;
        }
        return result;
    }
    defaultClassCss() {
        let result = 'font-semibold box-border whitespace-nowrap border ring-opacity-20 dark:ring-opacity-20 relative text-body-2';
        return result;
    }
    getClassCssBySize(size) {
        let result = '';
        switch (size) {
            case "sm":
                result = 'py-1 px-2.5  h-sm';
                break;
            case "md":
                result = 'py-1.5 px-3  h-md';
                break;
            case "lg":
                result = 'py-2 px-4 h-lg';
                break;
            case "xl":
                result = 'py-2.5 px-4.5 h-xl';
                break;
        }
        return result;
    }
    getClassCssButtonGroup() {
        let result = '';
        if (this._buttonGroup) {
            result = 'first:rounded-l-md last:rounded-r-md first:border-l last:border-r';
        }
        else {
            result = this.rounded;
        }
        return result;
    }
    buildCss() {
        this.cssClass = this.builClassCssButton();
        this.spinerColor = this.buildSpinerColor();
        this.loadingCss = this.getClassCssLoading();
    }
    builClassCssButton() {
        let result = '';
        if (this.elementRef.nativeElement.tagName === 'A') {
            result = 'inline-block ';
        }
        result += this.defaultClassCss();
        result += ` ${this.getClassCssBySize(this.size)}`;
        result += ` ${this.getClassCssButtonGroup()}`;
        if (this.disabled) {
            result += ` ${this.getClassCssDisabled()}`;
        }
        else {
            // custom : dev tự style theo thiết kế
            if (this.color != 'custom')
                result += ` ${this.getClassCssActive()}`;
        }
        return result;
    }
    buildSpinerColor() {
        let result = 'white';
        if (this.color == 'secondary') {
            result = 'primary';
        }
        return result;
    }
}
TDSButtonBase.ɵfac = function TDSButtonBase_Factory(t) { return new (t || TDSButtonBase)(i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i1.TDSButtonGroupComponent, 8)); };
TDSButtonBase.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: TDSButtonBase, inputs: { loading: "loading", color: "color", size: "size", loadingTemplate: "loadingTemplate", disabled: "disabled", rounded: "rounded" }, features: [i0.ɵɵNgOnChangesFeature] });
__decorate([
    InputBoolean()
], TDSButtonBase.prototype, "loading", void 0);
__decorate([
    InputBoolean()
], TDSButtonBase.prototype, "disabled", void 0);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSButtonBase, [{
        type: Directive
    }], function () { return [{ type: i0.NgZone }, { type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: i1.TDSButtonGroupComponent, decorators: [{
                type: Optional
            }] }]; }, { loading: [{
            type: Input
        }], color: [{
            type: Input
        }], size: [{
            type: Input
        }], loadingTemplate: [{
            type: Input
        }], disabled: [{
            type: Input
        }], rounded: [{
            type: Input
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnV0dG9uLmJhc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy90ZHMtdWkvYnV0dG9uL2J1dHRvbi5iYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQXFCLFNBQVMsRUFBYyxLQUFLLEVBQXdDLFFBQVEsRUFBOEIsTUFBTSxlQUFlLENBQUM7QUFDNUosT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDMUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTNDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQzs7O0FBSXJELE1BQU0sT0FBTyxhQUFhO0lBV3RCLFlBQ1csTUFBYyxFQUNkLFVBQXNCLEVBQ3RCLEdBQXNCLEVBQ1YsWUFBcUM7UUFIakQsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsUUFBRyxHQUFILEdBQUcsQ0FBbUI7UUFDVixpQkFBWSxHQUFaLFlBQVksQ0FBeUI7UUFkbkMsWUFBTyxHQUFZLEtBQUssQ0FBQztRQUN6QyxVQUFLLEdBQW1CLFNBQVMsQ0FBQztRQUNsQyxTQUFJLEdBQWUsSUFBSSxDQUFDO1FBRVIsYUFBUSxHQUFZLEtBQUssQ0FBQztRQUMxQyxZQUFPLEdBQVcsWUFBWSxDQUFDO1FBQ3hDLGFBQVEsR0FBVyxFQUFFLENBQUM7UUFDdEIsZ0JBQVcsR0FBb0IsT0FBTyxDQUFDO1FBQ3ZDLGVBQVUsR0FBVyxFQUFFLENBQUM7UUFDaEIsYUFBUSxHQUFHLElBQUksT0FBTyxFQUFRLENBQUM7SUFNdkMsQ0FBQztJQUVELFFBQVE7UUFDSixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDaEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7WUFDL0Isa0dBQWtHO1lBQ2xHLDBHQUEwRztZQUMxRyxzR0FB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LEdBQW1CLE9BQU8sQ0FBQztRQUNyQyxJQUFJLElBQUksQ0FBQyxLQUFLLElBQUksV0FBVyxFQUFFO1lBQzNCLE1BQU0sR0FBRyxTQUFTLENBQUM7U0FDdEI7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDOzswRUF4TFEsYUFBYTtnRUFBYixhQUFhO0FBQ0c7SUFBZixZQUFZLEVBQUU7OENBQTBCO0FBSXpCO0lBQWYsWUFBWSxFQUFFOytDQUEyQjt1RkFMMUMsYUFBYTtjQUR6QixTQUFTOztzQkFnQkQsUUFBUTt3QkFkWSxPQUFPO2tCQUEvQixLQUFLO1lBQ0csS0FBSztrQkFBYixLQUFLO1lBQ0csSUFBSTtrQkFBWixLQUFLO1lBQ0csZUFBZTtrQkFBdkIsS0FBSztZQUNtQixRQUFRO2tCQUFoQyxLQUFLO1lBQ0csT0FBTztrQkFBZixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0b3JSZWYsIERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgSW5wdXQsIE5nWm9uZSwgT25DaGFuZ2VzLCBPbkRlc3Ryb3ksIE9uSW5pdCwgT3B0aW9uYWwsIFNpbXBsZUNoYW5nZXMsIFRlbXBsYXRlUmVmIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgZnJvbUV2ZW50LCBTdWJqZWN0IH0gZnJvbSBcInJ4anNcIjtcclxuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSBcInJ4anMvb3BlcmF0b3JzXCI7XHJcbmltcG9ydCB7IFREU0J1dHRvbkNvbG9yLCBURFNUaGVtZVBhbGV0dGUgfSBmcm9tIFwidGRzLXVpL3NoYXJlZC9jb21tb25cIjtcclxuaW1wb3J0IHsgSW5wdXRCb29sZWFuIH0gZnJvbSBcInRkcy11aS9zaGFyZWQvdXRpbGl0eVwiO1xyXG5pbXBvcnQgeyBCdXR0b25TaXplIH0gZnJvbSBcInRkcy11aS9jb3JlL2NvbmZpZ1wiO1xyXG5pbXBvcnQgeyBURFNCdXR0b25Hcm91cENvbXBvbmVudCB9IGZyb20gXCIuL2J1dHRvbi1ncm91cC5jb21wb25lbnRcIjtcclxuQERpcmVjdGl2ZSgpXHJcbmV4cG9ydCBjbGFzcyBURFNCdXR0b25CYXNlIGltcGxlbWVudHMgT25EZXN0cm95LCBPbkNoYW5nZXMsIE9uSW5pdCB7XHJcbiAgICBASW5wdXQoKSBASW5wdXRCb29sZWFuKCkgbG9hZGluZzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgY29sb3I6IFREU0J1dHRvbkNvbG9yID0gJ3ByaW1hcnknO1xyXG4gICAgQElucHV0KCkgc2l6ZTogQnV0dG9uU2l6ZSA9ICdtZCc7XHJcbiAgICBASW5wdXQoKSBsb2FkaW5nVGVtcGxhdGU/OiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjx2b2lkPjtcclxuICAgIEBJbnB1dCgpIEBJbnB1dEJvb2xlYW4oKSBkaXNhYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgcm91bmRlZDogc3RyaW5nID0gJ3JvdW5kZWQtbWQnO1xyXG4gICAgY3NzQ2xhc3M6IHN0cmluZyA9ICcnO1xyXG4gICAgc3BpbmVyQ29sb3I6IFREU1RoZW1lUGFsZXR0ZSA9ICd3aGl0ZSc7XHJcbiAgICBsb2FkaW5nQ3NzOiBzdHJpbmcgPSAnJztcclxuICAgIHByaXZhdGUgZGVzdHJveSQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIG5nWm9uZTogTmdab25lLFxyXG4gICAgICAgIHB1YmxpYyBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHB1YmxpYyBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBfYnV0dG9uR3JvdXA6IFREU0J1dHRvbkdyb3VwQ29tcG9uZW50KSB7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5idWlsZENzcygpO1xyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gQ2FyZXRha2VyIG5vdGU6IHRoaXMgZXZlbnQgbGlzdGVuZXIgY291bGQndmUgYmVlbiBhZGRlZCB0aHJvdWdoIGBob3N0LmNsaWNrYCBvciBgSG9zdExpc3RlbmVyYC5cclxuICAgICAgICAgICAgLy8gVGhlIGNvbXBpbGVyIGdlbmVyYXRlcyB0aGUgYMm1ybVsaXN0ZW5lcmAgaW5zdHJ1Y3Rpb24gd2hpY2ggd3JhcHMgdGhlIGFjdHVhbCBsaXN0ZW5lciBpbnRlcm5hbGx5IGludG8gdGhlXHJcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uLCB3aGljaCBydW5zIGBtYXJrRGlydHkoKWAgYmVmb3JlIHJ1bm5pbmcgdGhlIGFjdHVhbCBsaXN0ZW5lciAodGhlIGRlY29yYXRlZCBjbGFzcyBtZXRob2QpLlxyXG4gICAgICAgICAgICAvLyBTaW5jZSB3ZSdyZSBwcmV2ZW50aW5nIHRoZSBkZWZhdWx0IGJlaGF2aW9yIGFuZCBzdG9wcGluZyBldmVudCBwcm9wYWdhdGlvbiB0aGlzIGRvZXNuJ3QgcmVxdWlyZSBBbmd1bGFyIHRvIHJ1biB0aGUgY2hhbmdlIGRldGVjdGlvbi5cclxuICAgICAgICAgICAgZnJvbUV2ZW50PE1vdXNlRXZlbnQ+KHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnY2xpY2snLCB7IGNhcHR1cmU6IHRydWUgfSlcclxuICAgICAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcclxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZXZlbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgodGhpcy5kaXNhYmxlZCAmJiAoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KT8udGFnTmFtZSA9PT0gJ0EnKSB8fCB0aGlzLmxvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB7IHNpemUsIGxvYWRpbmcsIGNvbG9yLCBsb2FkaW5nVGVtcGxhdGUsIGRpc2FibGVkIH0gPSBjaGFuZ2VzO1xyXG4gICAgICAgIGlmICgoc2l6ZSAmJiAhc2l6ZS5maXJzdENoYW5nZSkgfHwgKGxvYWRpbmcgJiYgIWxvYWRpbmcuZmlyc3RDaGFuZ2UpIHx8IChjb2xvciAmJiAhY29sb3IuZmlyc3RDaGFuZ2UpIHx8IChkaXNhYmxlZCAmJiAhZGlzYWJsZWQuZmlyc3RDaGFuZ2UpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnVpbGRDc3MoKTtcclxuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsb2FkaW5nVGVtcGxhdGUgJiYgIWxvYWRpbmdUZW1wbGF0ZS5maXJzdENoYW5nZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcclxuICAgICAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XHJcbiAgICB9XHJcbiAgICBnZXRDbGFzc0Nzc0xvYWRpbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuIGBhYnNvbHV0ZSAtaW5zZXQtcHggb3BhY2l0eS1bLjM1XSBiZy13aGl0ZSBjdXJzb3ItcHJvZ3Jlc3MgZGFyazpiZy1kLW5ldXRyYWwtMy01MCAke3RoaXMuZ2V0Q2xhc3NDc3NCdXR0b25Hcm91cCgpfWA7XHJcbiAgICB9XHJcbiAgICBnZXRDbGFzc0Nzc0Rpc2FibGVkKCkge1xyXG4gICAgICAgIHJldHVybiAnY3Vyc29yLW5vdC1hbGxvd2VkIGJvcmRlciB0ZXh0LW5ldXRyYWwtMS0zMDAgYm9yZGVyLW5ldXRyYWwtMi0yMDAgYmctbmV1dHJhbC0zLTUwIGRhcms6dGV4dC1kLW5ldXRyYWwtMS0zMDAgZGFyazpib3JkZXItZC1uZXV0cmFsLTItMjAwIGRhcms6YmctZC1uZXV0cmFsLTMtMjAwICc7XHJcbiAgICB9XHJcbiAgICBnZXRDbGFzc0Nzc0FjdGl2ZSgpIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gJ2ZvY3VzOnJpbmcgZm9jdXM6b3V0bGluZS1ub25lIGN1cnNvci1wb2ludGVyJztcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuY29sb3IpIHtcclxuICAgICAgICAgICAgY2FzZSBcInByaW1hcnlcIjpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBgIHRleHQtd2hpdGUgcmluZy1wcmltYXJ5LTEgYm9yZGVyLXByaW1hcnktMSBiZy1wcmltYXJ5LTEgaG92ZXI6YmctcHJpbWFyeS0yIGZvY3VzOmJnLXByaW1hcnktMSBob3Zlcjpib3JkZXItcHJpbWFyeS0yIGZvY3VzOmJvcmRlci1wcmltYXJ5LTEgZGFyazpyaW5nLWQtcHJpbWFyeS0xIGRhcms6Ym9yZGVyLWQtcHJpbWFyeS0xIGRhcms6YmctZC1wcmltYXJ5LTEgZGFyazpob3ZlcjpiZy1kLXByaW1hcnktMiBkYXJrOmZvY3VzOmJnLWQtcHJpbWFyeS0xIGRhcms6aG92ZXI6Ym9yZGVyLWQtcHJpbWFyeS0yIGRhcms6Zm9jdXM6Ym9yZGVyLWQtcHJpbWFyeS0xIGA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInNlY29uZGFyeVwiOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGAgdGV4dC1uZXV0cmFsLTEtOTAwIGRhcms6dGV4dC1kLW5ldXRyYWwtMS05MDAgIHJpbmctcHJpbWFyeS0xIGRhcms6cmluZy1kLXByaW1hcnktMSBib3JkZXItbmV1dHJhbC0yLTIwMCBkYXJrOmJvcmRlci1kLW5ldXRyYWwtMi0yMDAgYmctd2hpdGUgaG92ZXI6YmctbmV1dHJhbC0zLTUwIGZvY3VzOmJnLXdoaXRlIGRhcms6Zm9jdXM6YmctZC1uZXV0cmFsLTMtMzAwIGZvY3VzOmJvcmRlci1wcmltYXJ5LTEgZGFyazpmb2N1czpib3JkZXItZC1wcmltYXJ5LTEgZGFyazpiZy1kLW5ldXRyYWwtMy0zMDAgZGFyazpob3ZlcjpiZy1kLW5ldXRyYWwtMy00MDAgYDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdpbmZvJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBgIHRleHQtd2hpdGUgcmluZy1pbmZvLTQwMCBib3JkZXItaW5mby00MDAgYmctaW5mby00MDAgaG92ZXI6YmctaW5mby01MDAgZm9jdXM6YmctaW5mby00MDAgaG92ZXI6Ym9yZGVyLWluZm8tNTAwIGZvY3VzOmJvcmRlci1pbmZvLTQwMCAgZGFyazpyaW5nLWQtaW5mby00MDAgZGFyazpib3JkZXItZC1pbmZvLTQwMCBkYXJrOmJnLWQtaW5mby00MDAgZGFyazpob3ZlcjpiZy1kLWluZm8tNTAwIGRhcms6Zm9jdXM6YmctZC1pbmZvLTQwMCBkYXJrOmhvdmVyOmJvcmRlci1kLWluZm8tNTAwIGRhcms6Zm9jdXM6Ym9yZGVyLWQtaW5mby00MDBgO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3N1Y2Nlc3MnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGAgdGV4dC13aGl0ZSByaW5nLXN1Y2Nlc3MtNDAwIGJvcmRlci1zdWNjZXNzLTQwMCBiZy1zdWNjZXNzLTQwMCBob3ZlcjpiZy1zdWNjZXNzLTUwMCBmb2N1czpiZy1zdWNjZXNzLTQwMCBob3Zlcjpib3JkZXItc3VjY2Vzcy01MDAgZm9jdXM6Ym9yZGVyLXN1Y2Nlc3MtNDAwICBkYXJrOnJpbmctZC1zdWNjZXNzLTQwMCBkYXJrOmJvcmRlci1kLXN1Y2Nlc3MtNDAwIGRhcms6YmctZC1zdWNjZXNzLTQwMCBkYXJrOmhvdmVyOmJnLWQtc3VjY2Vzcy01MDAgZGFyazpmb2N1czpiZy1kLXN1Y2Nlc3MtNDAwIGRhcms6aG92ZXI6Ym9yZGVyLWQtc3VjY2Vzcy01MDAgZGFyazpmb2N1czpib3JkZXItZC1zdWNjZXNzLTQwMCBgO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3dhcm5pbmcnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGAgdGV4dC13aGl0ZSByaW5nLXdhcm5pbmctNDAwIGJvcmRlci13YXJuaW5nLTQwMCBiZy13YXJuaW5nLTQwMCBob3ZlcjpiZy13YXJuaW5nLTUwMCBmb2N1czpiZy13YXJuaW5nLTQwMCBob3Zlcjpib3JkZXItd2FybmluZy01MDAgZm9jdXM6Ym9yZGVyLXdhcm5pbmctNDAwIGRhcms6cmluZy1kLXdhcm5pbmctNDAwIGRhcms6Ym9yZGVyLWQtd2FybmluZy00MDAgZGFyazpiZy1kLXdhcm5pbmctNDAwIGRhcms6aG92ZXI6YmctZC13YXJuaW5nLTUwMCBkYXJrOmZvY3VzOmJnLWQtd2FybmluZy00MDAgZGFyazpob3Zlcjpib3JkZXItZC13YXJuaW5nLTUwMCBkYXJrOmZvY3VzOmJvcmRlci1kLXdhcm5pbmctNDAwIGA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZXJyb3InOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGAgdGV4dC13aGl0ZSByaW5nLWVycm9yLTQwMCBib3JkZXItZXJyb3ItNDAwIGJnLWVycm9yLTQwMCBob3ZlcjpiZy1lcnJvci01MDAgZm9jdXM6YmctZXJyb3ItNDAwIGhvdmVyOmJvcmRlci1lcnJvci01MDAgZm9jdXM6Ym9yZGVyLWVycm9yLTQwMCBkYXJrOnJpbmctZC1lcnJvci00MDAgZGFyazpib3JkZXItZC1lcnJvci00MDAgZGFyazpiZy1kLWVycm9yLTQwMCBkYXJrOmhvdmVyOmJnLWQtZXJyb3ItNTAwIGRhcms6Zm9jdXM6YmctZC1lcnJvci00MDAgZGFyazpob3Zlcjpib3JkZXItZC1lcnJvci01MDAgZGFyazpmb2N1czpib3JkZXItZC1lcnJvci00MDAgYDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdyZWQnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgdGV4dC13aGl0ZSByaW5nLWJhc2UtcmVkLTUwMCBib3JkZXItYmFzZS1yZWQtNTAwIGJnLWJhc2UtcmVkLTUwMCBob3ZlcjpiZy1iYXNlLXJlZC02MDAgZm9jdXM6YmctYmFzZS1yZWQtNTAwIGhvdmVyOmJvcmRlci1iYXNlLXJlZC02MDAgZm9jdXM6Ym9yZGVyLWJhc2UtcmVkLTUwMCBkYXJrOnJpbmctZC1iYXNlLXJlZC01MDAgZGFyazpib3JkZXItZC1iYXNlLXJlZC01MDAgZGFyazpiZy1kLWJhc2UtcmVkLTUwMCBkYXJrOmhvdmVyOmJnLWQtYmFzZS1yZWQtNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLXJlZC01MDAgZGFyazpob3Zlcjpib3JkZXItZC1iYXNlLXJlZC02MDAgZGFyazpmb2N1czpib3JkZXItZC1iYXNlLXJlZC01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrOyBjYXNlICd5ZWxsb3cnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgdGV4dC13aGl0ZSByaW5nLWJhc2UteWVsbG93LTUwMCBib3JkZXItYmFzZS15ZWxsb3ctNTAwIGJnLWJhc2UteWVsbG93LTUwMCBob3ZlcjpiZy1iYXNlLXllbGxvdy02MDAgZm9jdXM6YmctYmFzZS15ZWxsb3ctNTAwIGhvdmVyOmJvcmRlci1iYXNlLXllbGxvdy02MDAgZm9jdXM6Ym9yZGVyLWJhc2UteWVsbG93LTUwMCBkYXJrOnJpbmctZC1iYXNlLXllbGxvdy01MDAgZGFyazpib3JkZXItZC1iYXNlLXllbGxvdy01MDAgZGFyazpiZy1kLWJhc2UteWVsbG93LTUwMCBkYXJrOmhvdmVyOmJnLWQtYmFzZS15ZWxsb3ctNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLXllbGxvdy01MDAgZGFyazpob3Zlcjpib3JkZXItZC1iYXNlLXllbGxvdy02MDAgZGFyazpmb2N1czpib3JkZXItZC1iYXNlLXllbGxvdy01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdncmVlbic6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gJyB0ZXh0LXdoaXRlIHJpbmctYmFzZS1ncmVlbi01MDAgYm9yZGVyLWJhc2UtZ3JlZW4tNTAwIGJnLWJhc2UtZ3JlZW4tNTAwIGhvdmVyOmJnLWJhc2UtZ3JlZW4tNjAwIGZvY3VzOmJnLWJhc2UtZ3JlZW4tNTAwIGhvdmVyOmJvcmRlci1iYXNlLWdyZWVuLTYwMCBmb2N1czpib3JkZXItYmFzZS1ncmVlbi01MDAgZGFyazpyaW5nLWQtYmFzZS1ncmVlbi01MDAgZGFyazpib3JkZXItZC1iYXNlLWdyZWVuLTUwMCBkYXJrOmJnLWQtYmFzZS1ncmVlbi01MDAgZGFyazpob3ZlcjpiZy1kLWJhc2UtZ3JlZW4tNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLWdyZWVuLTUwMCBkYXJrOmhvdmVyOmJvcmRlci1kLWJhc2UtZ3JlZW4tNjAwIGRhcms6Zm9jdXM6Ym9yZGVyLWQtYmFzZS1ncmVlbi01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdibHVlJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnIHRleHQtd2hpdGUgcmluZy1iYXNlLWJsdWUtNTAwIGJvcmRlci1iYXNlLWJsdWUtNTAwIGJnLWJhc2UtYmx1ZS01MDAgaG92ZXI6YmctYmFzZS1ibHVlLTYwMCBmb2N1czpiZy1iYXNlLWJsdWUtNTAwIGhvdmVyOmJvcmRlci1iYXNlLWJsdWUtNjAwIGZvY3VzOmJvcmRlci1iYXNlLWJsdWUtNTAwIGRhcms6cmluZy1kLWJhc2UtYmx1ZS01MDAgZGFyazpib3JkZXItZC1iYXNlLWJsdWUtNTAwIGRhcms6YmctZC1iYXNlLWJsdWUtNTAwIGRhcms6aG92ZXI6YmctZC1iYXNlLWJsdWUtNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLWJsdWUtNTAwIGRhcms6aG92ZXI6Ym9yZGVyLWQtYmFzZS1ibHVlLTYwMCBkYXJrOmZvY3VzOmJvcmRlci1kLWJhc2UtYmx1ZS01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdpbmRpZ28nOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgdGV4dC13aGl0ZSByaW5nLWJhc2UtaW5kaWdvLTUwMCBib3JkZXItYmFzZS1pbmRpZ28tNTAwIGJnLWJhc2UtaW5kaWdvLTUwMCBob3ZlcjpiZy1iYXNlLWluZGlnby02MDAgZm9jdXM6YmctYmFzZS1pbmRpZ28tNTAwIGhvdmVyOmJvcmRlci1iYXNlLWluZGlnby02MDAgZm9jdXM6Ym9yZGVyLWJhc2UtaW5kaWdvLTUwMCBkYXJrOnJpbmctZC1iYXNlLWluZGlnby01MDAgZGFyazpib3JkZXItZC1iYXNlLWluZGlnby01MDAgZGFyazpiZy1kLWJhc2UtaW5kaWdvLTUwMCBkYXJrOmhvdmVyOmJnLWQtYmFzZS1pbmRpZ28tNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLWluZGlnby01MDAgZGFyazpob3Zlcjpib3JkZXItZC1iYXNlLWluZGlnby02MDAgZGFyazpmb2N1czpib3JkZXItZC1iYXNlLWluZGlnby01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdwdXJwbGUnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgdGV4dC13aGl0ZSByaW5nLWJhc2UtcHVycGxlLTUwMCBib3JkZXItYmFzZS1wdXJwbGUtNTAwIGJnLWJhc2UtcHVycGxlLTUwMCBob3ZlcjpiZy1iYXNlLXB1cnBsZS02MDAgZm9jdXM6YmctYmFzZS1wdXJwbGUtNTAwIGhvdmVyOmJvcmRlci1iYXNlLXB1cnBsZS02MDAgZm9jdXM6Ym9yZGVyLWJhc2UtcHVycGxlLTUwMCBkYXJrOnJpbmctZC1iYXNlLXB1cnBsZS01MDAgZGFyazpib3JkZXItZC1iYXNlLXB1cnBsZS01MDAgZGFyazpiZy1kLWJhc2UtcHVycGxlLTUwMCBkYXJrOmhvdmVyOmJnLWQtYmFzZS1wdXJwbGUtNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLXB1cnBsZS01MDAgZGFyazpob3Zlcjpib3JkZXItZC1iYXNlLXB1cnBsZS02MDAgZGFyazpmb2N1czpib3JkZXItZC1iYXNlLXB1cnBsZS01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdwaW5rJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnIHRleHQtd2hpdGUgcmluZy1iYXNlLXBpbmstNTAwIGJvcmRlci1iYXNlLXBpbmstNTAwIGJnLWJhc2UtcGluay01MDAgaG92ZXI6YmctYmFzZS1waW5rLTYwMCBmb2N1czpiZy1iYXNlLXBpbmstNTAwIGhvdmVyOmJvcmRlci1iYXNlLXBpbmstNjAwIGZvY3VzOmJvcmRlci1iYXNlLXBpbmstNTAwIGRhcms6cmluZy1kLWJhc2UtcGluay01MDAgZGFyazpib3JkZXItZC1iYXNlLXBpbmstNTAwIGRhcms6YmctZC1iYXNlLXBpbmstNTAwIGRhcms6aG92ZXI6YmctZC1iYXNlLXBpbmstNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLXBpbmstNTAwIGRhcms6aG92ZXI6Ym9yZGVyLWQtYmFzZS1waW5rLTYwMCBkYXJrOmZvY3VzOmJvcmRlci1kLWJhc2UtcGluay01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdhbWJlcic6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gJyB0ZXh0LXdoaXRlIHJpbmctYmFzZS1hbWJlci01MDAgYm9yZGVyLWJhc2UtYW1iZXItNTAwIGJnLWJhc2UtYW1iZXItNTAwIGhvdmVyOmJnLWJhc2UtYW1iZXItNjAwIGZvY3VzOmJnLWJhc2UtYW1iZXItNTAwIGhvdmVyOmJvcmRlci1iYXNlLWFtYmVyLTYwMCBmb2N1czpib3JkZXItYmFzZS1hbWJlci01MDAgZGFyazpyaW5nLWQtYmFzZS1hbWJlci01MDAgZGFyazpib3JkZXItZC1iYXNlLWFtYmVyLTUwMCBkYXJrOmJnLWQtYmFzZS1hbWJlci01MDAgZGFyazpob3ZlcjpiZy1kLWJhc2UtYW1iZXItNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLWFtYmVyLTUwMCBkYXJrOmhvdmVyOmJvcmRlci1kLWJhc2UtYW1iZXItNjAwIGRhcms6Zm9jdXM6Ym9yZGVyLWQtYmFzZS1hbWJlci01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdza3knOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgdGV4dC13aGl0ZSByaW5nLWJhc2Utc2t5LTUwMCBib3JkZXItYmFzZS1za3ktNTAwIGJnLWJhc2Utc2t5LTUwMCBob3ZlcjpiZy1iYXNlLXNreS02MDAgZm9jdXM6YmctYmFzZS1za3ktNTAwIGhvdmVyOmJvcmRlci1iYXNlLXNreS02MDAgZm9jdXM6Ym9yZGVyLWJhc2Utc2t5LTUwMCBkYXJrOnJpbmctZC1iYXNlLXNreS01MDAgZGFyazpib3JkZXItZC1iYXNlLXNreS01MDAgZGFyazpiZy1kLWJhc2Utc2t5LTUwMCBkYXJrOmhvdmVyOmJnLWQtYmFzZS1za3ktNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLXNreS01MDAgZGFyazpob3Zlcjpib3JkZXItZC1iYXNlLXNreS02MDAgZGFyazpmb2N1czpib3JkZXItZC1iYXNlLXNreS01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdsaW1lJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnIHRleHQtd2hpdGUgcmluZy1iYXNlLWxpbWUtNTAwIGJvcmRlci1iYXNlLWxpbWUtNTAwIGJnLWJhc2UtbGltZS01MDAgaG92ZXI6YmctYmFzZS1saW1lLTYwMCBmb2N1czpiZy1iYXNlLWxpbWUtNTAwIGhvdmVyOmJvcmRlci1iYXNlLWxpbWUtNjAwIGZvY3VzOmJvcmRlci1iYXNlLWxpbWUtNTAwIGRhcms6cmluZy1kLWJhc2UtbGltZS01MDAgZGFyazpib3JkZXItZC1iYXNlLWxpbWUtNTAwIGRhcms6YmctZC1iYXNlLWxpbWUtNTAwIGRhcms6aG92ZXI6YmctZC1iYXNlLWxpbWUtNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLWxpbWUtNTAwIGRhcms6aG92ZXI6Ym9yZGVyLWQtYmFzZS1saW1lLTYwMCBkYXJrOmZvY3VzOmJvcmRlci1kLWJhc2UtbGltZS01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd0ZWFsJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnIHRleHQtd2hpdGUgcmluZy1iYXNlLXRlYWwtNTAwIGJvcmRlci1iYXNlLXRlYWwtNTAwIGJnLWJhc2UtdGVhbC01MDAgaG92ZXI6YmctYmFzZS10ZWFsLTYwMCBmb2N1czpiZy1iYXNlLXRlYWwtNTAwIGhvdmVyOmJvcmRlci1iYXNlLXRlYWwtNjAwIGZvY3VzOmJvcmRlci1iYXNlLXRlYWwtNTAwIGRhcms6cmluZy1kLWJhc2UtdGVhbC01MDAgZGFyazpib3JkZXItZC1iYXNlLXRlYWwtNTAwIGRhcms6YmctZC1iYXNlLXRlYWwtNTAwIGRhcms6aG92ZXI6YmctZC1iYXNlLXRlYWwtNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLXRlYWwtNTAwIGRhcms6aG92ZXI6Ym9yZGVyLWQtYmFzZS10ZWFsLTYwMCBkYXJrOmZvY3VzOmJvcmRlci1kLWJhc2UtdGVhbC01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdvcmFuZ2UnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgdGV4dC13aGl0ZSByaW5nLWJhc2Utb3JhbmdlLTUwMCBib3JkZXItYmFzZS1vcmFuZ2UtNTAwIGJnLWJhc2Utb3JhbmdlLTUwMCBob3ZlcjpiZy1iYXNlLW9yYW5nZS02MDAgZm9jdXM6YmctYmFzZS1vcmFuZ2UtNTAwIGhvdmVyOmJvcmRlci1iYXNlLW9yYW5nZS02MDAgZm9jdXM6Ym9yZGVyLWJhc2Utb3JhbmdlLTUwMCBkYXJrOnJpbmctZC1iYXNlLW9yYW5nZS01MDAgZGFyazpib3JkZXItZC1iYXNlLW9yYW5nZS01MDAgZGFyazpiZy1kLWJhc2Utb3JhbmdlLTUwMCBkYXJrOmhvdmVyOmJnLWQtYmFzZS1vcmFuZ2UtNjAwIGRhcms6Zm9jdXM6YmctZC1iYXNlLW9yYW5nZS01MDAgZGFyazpob3Zlcjpib3JkZXItZC1iYXNlLW9yYW5nZS02MDAgZGFyazpmb2N1czpib3JkZXItZC1iYXNlLW9yYW5nZS01MDAgJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgLy8gY3VzdG9tIDogZGV2IHThu7Egc3R5bGUgdGhlbyB0aGnhur90IGvhur9cclxuICAgICAgICAgICAgY2FzZSAnY3VzdG9tJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPScnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBkZWZhdWx0Q2xhc3NDc3MoKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9ICdmb250LXNlbWlib2xkIGJveC1ib3JkZXIgd2hpdGVzcGFjZS1ub3dyYXAgYm9yZGVyIHJpbmctb3BhY2l0eS0yMCBkYXJrOnJpbmctb3BhY2l0eS0yMCByZWxhdGl2ZSB0ZXh0LWJvZHktMic7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIGdldENsYXNzQ3NzQnlTaXplKHNpemU6IEJ1dHRvblNpemUpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCByZXN1bHQ6IHN0cmluZyA9ICcnO1xyXG4gICAgICAgIHN3aXRjaCAoc2l6ZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwic21cIjpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9ICdweS0xIHB4LTIuNSAgaC1zbSc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcIm1kXCI6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSAncHktMS41IHB4LTMgIGgtbWQnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJsZ1wiOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gJ3B5LTIgcHgtNCBoLWxnJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwieGxcIjpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9ICdweS0yLjUgcHgtNC41IGgteGwnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBnZXRDbGFzc0Nzc0J1dHRvbkdyb3VwKCkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSAnJztcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2J1dHRvbkdyb3VwKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9ICdmaXJzdDpyb3VuZGVkLWwtbWQgbGFzdDpyb3VuZGVkLXItbWQgZmlyc3Q6Ym9yZGVyLWwgbGFzdDpib3JkZXItcidcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLnJvdW5kZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcblxyXG4gICAgfVxyXG4gICAgYnVpbGRDc3MoKSB7XHJcbiAgICAgICAgdGhpcy5jc3NDbGFzcyA9IHRoaXMuYnVpbENsYXNzQ3NzQnV0dG9uKCk7XHJcbiAgICAgICAgdGhpcy5zcGluZXJDb2xvciA9IHRoaXMuYnVpbGRTcGluZXJDb2xvcigpO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ0NzcyA9IHRoaXMuZ2V0Q2xhc3NDc3NMb2FkaW5nKCk7XHJcbiAgICB9XHJcbiAgICBidWlsQ2xhc3NDc3NCdXR0b24oKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9ICcnO1xyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC50YWdOYW1lID09PSAnQScpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gJ2lubGluZS1ibG9jayAnXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc3VsdCArPSB0aGlzLmRlZmF1bHRDbGFzc0NzcygpO1xyXG4gICAgICAgIHJlc3VsdCArPSBgICR7dGhpcy5nZXRDbGFzc0Nzc0J5U2l6ZSh0aGlzLnNpemUpfWA7XHJcbiAgICAgICAgcmVzdWx0ICs9IGAgJHt0aGlzLmdldENsYXNzQ3NzQnV0dG9uR3JvdXAoKX1gO1xyXG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCArPSBgICR7dGhpcy5nZXRDbGFzc0Nzc0Rpc2FibGVkKCl9YDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgLy8gY3VzdG9tIDogZGV2IHThu7Egc3R5bGUgdGhlbyB0aGnhur90IGvhur9cclxuICAgICAgICAgICAgaWYodGhpcy5jb2xvciAhPSAnY3VzdG9tJylcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBgICR7dGhpcy5nZXRDbGFzc0Nzc0FjdGl2ZSgpfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBidWlsZFNwaW5lckNvbG9yKCk6VERTVGhlbWVQYWxldHRlIHtcclxuICAgICAgICBsZXQgcmVzdWx0OlREU1RoZW1lUGFsZXR0ZSA9ICd3aGl0ZSc7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sb3IgPT0gJ3NlY29uZGFyeScpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gJ3ByaW1hcnknO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxufSJdfQ==