import { ChangeDetectionStrategy, Component, Input, ViewEncapsulation } from '@angular/core';
import { zoomBadgeMotion } from 'tds-ui/core/animation';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "tds-ui/core/no-animation";
function TDSBadgeSupComponent_ng_container_0_span_1_ng_container_1_p_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "p", 6);
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const p_r8 = ctx.$implicit;
    const i_r5 = i0.ɵɵnextContext(2).index;
    const ctx_r7 = i0.ɵɵnextContext(2);
    i0.ɵɵclassProp("current", p_r8 === ctx_r7.countArray[i_r5]);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", p_r8, " ");
} }
function TDSBadgeSupComponent_ng_container_0_span_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, TDSBadgeSupComponent_ng_container_0_span_1_ng_container_1_p_1_Template, 2, 3, "p", 5);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r6 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngForOf", ctx_r6.countSingleArray);
} }
function TDSBadgeSupComponent_ng_container_0_span_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 3);
    i0.ɵɵtemplate(1, TDSBadgeSupComponent_ng_container_0_span_1_ng_container_1_Template, 2, 1, "ng-container", 4);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const i_r5 = ctx.index;
    const ctx_r3 = i0.ɵɵnextContext(2);
    i0.ɵɵstyleProp("transform", "translateY(" + -ctx_r3.countArray[i_r5] * 100 + "%)");
    i0.ɵɵproperty("noAnimation", ctx_r3.noAnimation);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", !ctx_r3.dot && ctx_r3.countArray[i_r5] !== undefined);
} }
function TDSBadgeSupComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, TDSBadgeSupComponent_ng_container_0_span_1_Template, 2, 4, "span", 2);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngForOf", ctx_r0.maxNumberArray);
} }
function TDSBadgeSupComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵtext(0);
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵtextInterpolate1("", ctx_r2.overflowCount, "+");
} }
export class TDSBadgeSupComponent {
    constructor(elementRef) {
        this.elementRef = elementRef;
        this.tdsStyle = null;
        this.dot = false;
        this.overflowCount = 99;
        this.disableAnimation = false;
        this.noAnimation = false;
        this.standalone = false;
        this.size = 'md';
        this.placement = 'topRight';
        // @Input() tdsClass: string | null = null;
        this._cls = '';
        this.maxNumberArray = [];
        this.countArray = [];
        this._count = 0;
        this.countSingleArray = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
        // TODO: move to host after View Engine deprecation
        this.elementRef.nativeElement.classList.add('tds-scroll-number');
    }
    generateMaxNumberArray() {
        this.maxNumberArray = this.overflowCount.toString().split('');
    }
    ngOnInit() {
        this.generateMaxNumberArray();
        this.buildCls();
    }
    get cls() {
        return this._cls;
    }
    ngOnChanges(changes) {
        const { overflowCount, count, standalone, tdsStyle, tdsClass } = changes;
        if (count && typeof count.currentValue === 'number') {
            this._count = Math.max(0, count.currentValue);
            this.countArray = this._count
                .toString()
                .split('')
                .map(item => +item);
        }
        if (overflowCount) {
            this.generateMaxNumberArray();
        }
        // if (bgColor) {
        //   this.buildCls();
        // }
    }
    buildCls() {
        let placement = this.getPlacement();
        let str = "overflow-hidden  min-w-5 h-5 py-0 text-xs  text-center font-semibold whitespace-nowrap rounded-full  leading-5 ";
        if (!this.dot) {
            if (!this.standalone)
                this._cls = str + " absolute " + placement;
            else {
                this._cls = str + " relative block ";
            }
        }
        else {
            this._cls = "absolute z-auto overflow-hidden py-0  rounded-full ";
            switch (this.size) {
                case 'sm':
                    this._cls += 'h-1.5 w-1.5 ';
                    break;
                case 'md':
                    this._cls += 'h-2 w-2 ';
                    break;
                case 'lg':
                    this._cls += 'h-2.5 w-2.5 ';
                    break;
                default:
                    this._cls += 'h-2 w-2 ';
                    break;
            }
            this._cls += placement;
        }
        // if (this.tdsClass) {
        //   this._cls = this._cls + this.tdsClass;
        // }
    }
    get styleCss() {
        let style = null;
        if (!this.standalone) {
            switch (this.placement) {
                case 'topRight':
                    style = {
                        ['transform']: 'translate(50%,-50%)',
                        ['transform-origin']: '100% 0'
                    };
                    break;
                case 'topLeft':
                    style = {
                        ['transform']: 'translate(-50%,-50%)',
                        ['transform-origin']: '0 0'
                    };
                    break;
                case 'bottomLeft':
                    style = {
                        ['transform']: 'translate(-50%,50%)',
                        ['transform-origin']: '100% 0'
                    };
                    break;
                case 'bottomRight':
                    style = {
                        ['transform']: 'translate(50%,50%)',
                        ['transform-origin']: '0 100%'
                    };
                    break;
                default:
                    style = {
                        ['transform']: 'translate(-50%,50%)',
                        ['transform-origin']: '100% 0'
                    };
                    break;
            }
        }
        if (!!this.tdsStyle) {
            if (style != null)
                return Object.assign({}, style, this.tdsStyle);
            return this.tdsStyle;
        }
        return style;
    }
    getPlacement() {
        let result = "top-0 right-0";
        switch (this.placement) {
            case 'topRight':
                result = "top-0 right-0";
                break;
            case 'topLeft':
                result = "top-0 left-0";
                break;
            case 'bottomLeft':
                result = "bottom-0 left-0";
                break;
            case 'bottomRight':
                result = "bottom-0 right-0";
                break;
            default:
                result = "top-0 right-0";
                break;
        }
        return result;
    }
}
TDSBadgeSupComponent.ɵfac = function TDSBadgeSupComponent_Factory(t) { return new (t || TDSBadgeSupComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
TDSBadgeSupComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TDSBadgeSupComponent, selectors: [["tds-badge-sup"]], hostVars: 21, hostBindings: function TDSBadgeSupComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵattribute("title", ctx.title === null ? "" : ctx.title || ctx.count);
        i0.ɵɵsyntheticHostProperty("@.disabled", ctx.disableAnimation)("@zoomBadgeMotion", undefined);
        i0.ɵɵstyleMap(ctx.styleCss);
        i0.ɵɵclassMap(ctx.cls);
        i0.ɵɵstyleProp("right", ctx.offset && ctx.offset[0] ? -ctx.offset[0] : null, "px")("margin-top", ctx.offset && ctx.offset[1] ? ctx.offset[1] : null, "px");
        i0.ɵɵclassProp("tds-badge-count", !ctx.dot)("tds-badge-dot", ctx.dot)("tds-badge-multiple-words", ctx.countArray.length >= 2)("px-1", !ctx.dot && ctx.countArray.length < 2)("px-2", !ctx.dot && ctx.countArray.length >= 2);
    } }, inputs: { offset: "offset", title: "title", tdsStyle: "tdsStyle", dot: "dot", overflowCount: "overflowCount", disableAnimation: "disableAnimation", count: "count", noAnimation: "noAnimation", standalone: "standalone", size: "size", placement: "placement" }, exportAs: ["tdsBadgeSup"], features: [i0.ɵɵNgOnChangesFeature], decls: 3, vars: 2, consts: [[4, "ngIf", "ngIfElse"], ["overflowTemplate", ""], ["class", "tds-scroll-number-only relative inline-block h-5", "style", "transition: all .3s cubic-bezier(.645,.045,.355,1)", 3, "noAnimation", "transform", 4, "ngFor", "ngForOf"], [1, "tds-scroll-number-only", "relative", "inline-block", "h-5", 2, "transition", "all .3s cubic-bezier(.645,.045,.355,1)", 3, "noAnimation"], [4, "ngIf"], ["class", "tds-scroll-number-only-unit h-5 m-0 ", 3, "current", 4, "ngFor", "ngForOf"], [1, "tds-scroll-number-only-unit", "h-5", "m-0"]], template: function TDSBadgeSupComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, TDSBadgeSupComponent_ng_container_0_Template, 2, 1, "ng-container", 0);
        i0.ɵɵtemplate(1, TDSBadgeSupComponent_ng_template_1_Template, 1, 1, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = i0.ɵɵreference(2);
        i0.ɵɵproperty("ngIf", ctx._count <= ctx.overflowCount)("ngIfElse", _r1);
    } }, directives: [i1.NgIf, i1.NgForOf, i2.TDSNoAnimationDirective], encapsulation: 2, data: { animation: [zoomBadgeMotion] }, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSBadgeSupComponent, [{
        type: Component,
        args: [{
                selector: 'tds-badge-sup',
                exportAs: 'tdsBadgeSup',
                preserveWhitespaces: false,
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                animations: [zoomBadgeMotion],
                template: `
    <ng-container *ngIf="_count <= overflowCount; else overflowTemplate">
      <span
        [noAnimation]="noAnimation"
        *ngFor="let n of maxNumberArray; let i = index"
        class="tds-scroll-number-only relative inline-block h-5"
        [style.transform]="'translateY(' + -countArray[i] * 100 + '%)'"
        style="transition: all .3s cubic-bezier(.645,.045,.355,1)"
      >
        <ng-container *ngIf="!dot && countArray[i] !== undefined">
          <p
            *ngFor="let p of countSingleArray"
            class="tds-scroll-number-only-unit h-5 m-0 " 
            [class.current]="p === countArray[i]"
          >
            {{ p }}
          </p>
        </ng-container>
      </span>
    </ng-container>
    <ng-template #overflowTemplate>{{ overflowCount }}+</ng-template>
  `,
                host: {
                    '[@.disabled]': `disableAnimation`,
                    '[@zoomBadgeMotion]': '',
                    '[attr.title]': `title === null ? '' : title || count`,
                    '[style]': `styleCss`,
                    '[style.right.px]': `offset && offset[0] ? -offset[0] : null`,
                    '[style.margin-top.px]': `offset && offset[1] ? offset[1] : null`,
                    '[class.tds-badge-count]': `!dot`,
                    '[class.tds-badge-dot]': `dot`,
                    '[class.tds-badge-multiple-words]': `countArray.length >= 2`,
                    '[class.px-1.5]': `!dot && countArray.length < 2`,
                    '[class.px-2]': `!dot && countArray.length >= 2`,
                    '[class]': "cls"
                }
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { offset: [{
            type: Input
        }], title: [{
            type: Input
        }], tdsStyle: [{
            type: Input
        }], dot: [{
            type: Input
        }], overflowCount: [{
            type: Input
        }], disableAnimation: [{
            type: Input
        }], count: [{
            type: Input
        }], noAnimation: [{
            type: Input
        }], standalone: [{
            type: Input
        }], size: [{
            type: Input
        }], placement: [{
            type: Input
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFkZ2Utc3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL3Rkcy11aS9iYWRnZXMvYmFkZ2Utc3VwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQ0wsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFFVCxLQUFLLEVBS0wsaUJBQWlCLEVBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBR3ZCLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQzs7Ozs7SUFrQjlDLDRCQUlDO0lBQ0MsWUFDRjtJQUFBLGlCQUFJOzs7OztJQUhGLDJEQUFxQztJQUVyQyxlQUNGO0lBREUscUNBQ0Y7OztJQVBGLDZCQUEwRDtJQUN4RCxzR0FNSTtJQUNOLDBCQUFlOzs7SUFORyxlQUFtQjtJQUFuQixpREFBbUI7OztJQVR2QywrQkFNQztJQUNDLDZHQVFlO0lBQ2pCLGlCQUFPOzs7O0lBWkwsa0ZBQStEO0lBSC9ELGdEQUEyQjtJQU1aLGVBQXlDO0lBQXpDLDJFQUF5Qzs7O0lBUjVELDZCQUFxRTtJQUNuRSxzRkFnQk87SUFDVCwwQkFBZTs7O0lBZkcsZUFBbUI7SUFBbkIsK0NBQW1COzs7SUFnQk4sWUFBb0I7OztJQUFwQixvREFBb0I7O0FBaUJ2RCxNQUFNLE9BQU8sb0JBQW9CO0lBbUIvQixZQUFvQixVQUFzQjtRQUF0QixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBaEJqQyxhQUFRLEdBQXFDLElBQUksQ0FBQztRQUNsRCxRQUFHLEdBQUcsS0FBSyxDQUFDO1FBQ1osa0JBQWEsR0FBVyxFQUFFLENBQUM7UUFDM0IscUJBQWdCLEdBQUcsS0FBSyxDQUFDO1FBRXpCLGdCQUFXLEdBQUcsS0FBSyxDQUFDO1FBQ3BCLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDbkIsU0FBSSxHQUFlLElBQUksQ0FBQztRQUN4QixjQUFTLEdBQTBELFVBQVUsQ0FBQztRQUN2RiwyQ0FBMkM7UUFDM0Ms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LEVBQUUsS0FBSztvQkFDOUIsa0NBQWtDLEVBQUUsd0JBQXdCO29CQUM1RCxnQkFBZ0IsRUFBRSwrQkFBK0I7b0JBQ2pELGNBQWMsRUFBRSxnQ0FBZ0M7b0JBQ2hELFNBQVMsRUFBRSxLQUFLO2lCQUNqQjthQUNGOzZEQUVVLE1BQU07a0JBQWQsS0FBSztZQUNHLEtBQUs7a0JBQWIsS0FBSztZQUNHLFFBQVE7a0JBQWhCLEtBQUs7WUFDRyxHQUFHO2tCQUFYLEtBQUs7WUFDRyxhQUFhO2tCQUFyQixLQUFLO1lBQ0csZ0JBQWdCO2tCQUF4QixLQUFLO1lBQ0csS0FBSztrQkFBYixLQUFLO1lBQ0csV0FBVztrQkFBbkIsS0FBSztZQUNHLFVBQVU7a0JBQWxCLEtBQUs7WUFDRyxJQUFJO2tCQUFaLEtBQUs7WUFDRyxTQUFTO2tCQUFqQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiXHJcblxyXG5pbXBvcnQge1xyXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxyXG4gIENvbXBvbmVudCxcclxuICBFbGVtZW50UmVmLFxyXG4gIElucHV0LFxyXG4gIE9uQ2hhbmdlcyxcclxuICBPbkluaXQsXHJcbiAgU2ltcGxlQ2hhbmdlcyxcclxuICBUZW1wbGF0ZVJlZixcclxuICBWaWV3RW5jYXBzdWxhdGlvblxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBURFNTYWZlQW55IH0gZnJvbSAndGRzLXVpL3NoYXJlZC91dGlsaXR5JztcclxuaW1wb3J0IHsgQnV0dG9uU2l6ZSB9IGZyb20gXCJ0ZHMtdWkvY29yZS9jb25maWdcIjtcclxuaW1wb3J0IHsgem9vbUJhZGdlTW90aW9uIH0gZnJvbSAndGRzLXVpL2NvcmUvYW5pbWF0aW9uJztcclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICd0ZHMtYmFkZ2Utc3VwJyxcclxuICBleHBvcnRBczogJ3Rkc0JhZGdlU3VwJyxcclxuICBwcmVzZXJ2ZVdoaXRlc3BhY2VzOiBmYWxzZSxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxyXG4gIGFuaW1hdGlvbnM6IFt6b29tQmFkZ2VNb3Rpb25dLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiX2NvdW50IDw9IG92ZXJmbG93Q291bnQ7IGVsc2Ugb3ZlcmZsb3dUZW1wbGF0ZVwiPlxyXG4gICAgICA8c3BhblxyXG4gICAgICAgIFtub0FuaW1hdGlvbl09XCJub0FuaW1hdGlvblwiXHJcbiAgICAgICAgKm5nRm9yPVwibGV0IG4gb2YgbWF4TnVtYmVyQXJyYXk7IGxldCBpID0gaW5kZXhcIlxyXG4gICAgICAgIGNsYXNzPVwidGRzLXNjcm9sbC1udW1iZXItb25seSByZWxhdGl2ZSBpbmxpbmUtYmxvY2sgaC01XCJcclxuICAgICAgICBbc3R5bGUudHJhbnNmb3JtXT1cIid0cmFuc2xhdGVZKCcgKyAtY291bnRBcnJheVtpXSAqIDEwMCArICclKSdcIlxyXG4gICAgICAgIHN0eWxlPVwidHJhbnNpdGlvbjogYWxsIC4zcyBjdWJpYy1iZXppZXIoLjY0NSwuMDQ1LC4zNTUsMSlcIlxyXG4gICAgICA+XHJcbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiFkb3QgJiYgY291bnRBcnJheVtpXSAhPT0gdW5kZWZpbmVkXCI+XHJcbiAgICAgICAgICA8cFxyXG4gICAgICAgICAgICAqbmdGb3I9XCJsZXQgcCBvZiBjb3VudFNpbmdsZUFycmF5XCJcclxuICAgICAgICAgICAgY2xhc3M9XCJ0ZHMtc2Nyb2xsLW51bWJlci1vbmx5LXVuaXQgaC01IG0tMCBcIiBcclxuICAgICAgICAgICAgW2NsYXNzLmN1cnJlbnRdPVwicCA9PT0gY291bnRBcnJheVtpXVwiXHJcbiAgICAgICAgICA+XHJcbiAgICAgICAgICAgIHt7IHAgfX1cclxuICAgICAgICAgIDwvcD5cclxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgPC9zcGFuPlxyXG4gICAgPC9uZy1jb250YWluZXI+XHJcbiAgICA8bmctdGVtcGxhdGUgI292ZXJmbG93VGVtcGxhdGU+e3sgb3ZlcmZsb3dDb3VudCB9fSs8L25nLXRlbXBsYXRlPlxyXG4gIGAsXHJcbiAgaG9zdDoge1xyXG4gICAgJ1tALmRpc2FibGVkXSc6IGBkaXNhYmxlQW5pbWF0aW9uYCxcclxuICAgICdbQHpvb21CYWRnZU1vdGlvbl0nOiAnJyxcclxuICAgICdbYXR0ci50aXRsZV0nOiBgdGl0bGUgPT09IG51bGwgPyAnJyA6IHRpdGxlIHx8IGNvdW50YCxcclxuICAgICdbc3R5bGVdJzogYHN0eWxlQ3NzYCxcclxuICAgICdbc3R5bGUucmlnaHQucHhdJzogYG9mZnNldCAmJiBvZmZzZXRbMF0gPyAtb2Zmc2V0WzBdIDogbnVsbGAsXHJcbiAgICAnW3N0eWxlLm1hcmdpbi10b3AucHhdJzogYG9mZnNldCAmJiBvZmZzZXRbMV0gPyBvZmZzZXRbMV0gOiBudWxsYCxcclxuICAgICdbY2xhc3MudGRzLWJhZGdlLWNvdW50XSc6IGAhZG90YCxcclxuICAgICdbY2xhc3MudGRzLWJhZGdlLWRvdF0nOiBgZG90YCxcclxuICAgICdbY2xhc3MudGRzLWJhZGdlLW11bHRpcGxlLXdvcmRzXSc6IGBjb3VudEFycmF5Lmxlbmd0aCA+PSAyYCxcclxuICAgICdbY2xhc3MucHgtMS41XSc6IGAhZG90ICYmIGNvdW50QXJyYXkubGVuZ3RoIDwgMmAsXHJcbiAgICAnW2NsYXNzLnB4LTJdJzogYCFkb3QgJiYgY291bnRBcnJheS5sZW5ndGggPj0gMmAsXHJcbiAgICAnW2NsYXNzXSc6IFwiY2xzXCJcclxuICB9XHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBURFNCYWRnZVN1cENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuICBASW5wdXQoKSBvZmZzZXQ/OiBbbnVtYmVyLCBudW1iZXJdO1xyXG4gIEBJbnB1dCgpIHRpdGxlPzogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcclxuICBASW5wdXQoKSB0ZHNTdHlsZTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSB8IG51bGwgPSBudWxsO1xyXG4gIEBJbnB1dCgpIGRvdCA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIG92ZXJmbG93Q291bnQ6IG51bWJlciA9IDk5O1xyXG4gIEBJbnB1dCgpIGRpc2FibGVBbmltYXRpb24gPSBmYWxzZTtcclxuICBASW5wdXQoKSBjb3VudD86IG51bWJlciB8IFRlbXBsYXRlUmVmPFREU1NhZmVBbnk+O1xyXG4gIEBJbnB1dCgpIG5vQW5pbWF0aW9uID0gZmFsc2U7XHJcbiAgQElucHV0KCkgc3RhbmRhbG9uZSA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHNpemU6IEJ1dHRvblNpemUgPSAnbWQnO1xyXG4gIEBJbnB1dCgpIHBsYWNlbWVudDogJ3RvcExlZnQnIHwgJ3RvcFJpZ2h0JyB8ICdib3R0b21MZWZ0JyB8ICdib3R0b21SaWdodCcgPSAndG9wUmlnaHQnO1xyXG4gIC8vIEBJbnB1dCgpIHRkc0NsYXNzOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICBfY2xzOiBzdHJpbmcgPSAnJztcclxuICBtYXhOdW1iZXJBcnJheTogc3RyaW5nW10gPSBbXTtcclxuICBjb3VudEFycmF5OiBudW1iZXJbXSA9IFtdO1xyXG4gIF9jb3VudDogbnVtYmVyID0gMDtcclxuICBjb3VudFNpbmdsZUFycmF5ID0gWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDldO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYpIHtcclxuICAgIC8vIFRPRE86IG1vdmUgdG8gaG9zdCBhZnRlciBWaWV3IEVuZ2luZSBkZXByZWNhdGlvblxyXG4gICAgdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgndGRzLXNjcm9sbC1udW1iZXInKTtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlTWF4TnVtYmVyQXJyYXkoKTogdm9pZCB7XHJcbiAgICB0aGlzLm1heE51bWJlckFycmF5ID0gdGhpcy5vdmVyZmxvd0NvdW50LnRvU3RyaW5nKCkuc3BsaXQoJycpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmdlbmVyYXRlTWF4TnVtYmVyQXJyYXkoKTtcclxuICAgIHRoaXMuYnVpbGRDbHMoKTtcclxuICB9XHJcbiAgZ2V0IGNscygpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NscztcclxuICB9XHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgY29uc3QgeyBvdmVyZmxvd0NvdW50LCBjb3VudCwgc3RhbmRhbG9uZSwgdGRzU3R5bGUsIHRkc0NsYXNzIH0gPSBjaGFuZ2VzO1xyXG4gICAgaWYgKGNvdW50ICYmIHR5cGVvZiBjb3VudC5jdXJyZW50VmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgIHRoaXMuX2NvdW50ID0gTWF0aC5tYXgoMCwgY291bnQuY3VycmVudFZhbHVlKTtcclxuICAgICAgdGhpcy5jb3VudEFycmF5ID0gdGhpcy5fY291bnRcclxuICAgICAgICAudG9TdHJpbmcoKVxyXG4gICAgICAgIC5zcGxpdCgnJylcclxuICAgICAgICAubWFwKGl0ZW0gPT4gK2l0ZW0pO1xyXG4gICAgfVxyXG4gICAgaWYgKG92ZXJmbG93Q291bnQpIHtcclxuICAgICAgdGhpcy5nZW5lcmF0ZU1heE51bWJlckFycmF5KCk7XHJcbiAgICB9XHJcbiAgICAvLyBpZiAoYmdDb2xvcikge1xyXG4gICAgLy8gICB0aGlzLmJ1aWxkQ2xzKCk7XHJcbiAgICAvLyB9XHJcbiAgfVxyXG4gIGJ1aWxkQ2xzKCkge1xyXG4gICAgXHJcbiAgICBsZXQgcGxhY2VtZW50ID0gdGhpcy5nZXRQbGFjZW1lbnQoKTtcclxuICAgIGxldCBzdHIgPSBcIm92ZXJmbG93LWhpZGRlbiAgbWluLXctNSBoLTUgcHktMCB0ZXh0LXhzICB0ZXh0LWNlbnRlciBmb250LXNlbWlib2xkIHdoaXRlc3BhY2Utbm93cmFwIHJvdW5kZWQtZnVsbCAgbGVhZGluZy01IFwiXHJcbiAgICBpZiAoIXRoaXMuZG90KSB7XHJcbiAgICAgIGlmICghdGhpcy5zdGFuZGFsb25lKVxyXG4gICAgICAgIHRoaXMuX2NscyA9IHN0ciArIFwiIGFic29sdXRlIFwiICsgcGxhY2VtZW50O1xyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aGlzLl9jbHMgPSBzdHIgKyBcIiByZWxhdGl2ZSBibG9jayBcIjtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fY2xzID0gXCJhYnNvbHV0ZSB6LWF1dG8gb3ZlcmZsb3ctaGlkZGVuIHB5LTAgIHJvdW5kZWQtZnVsbCBcIjtcclxuICAgICAgc3dpdGNoICh0aGlzLnNpemUpIHtcclxuICAgICAgICBjYXNlICdzbSc6XHJcbiAgICAgICAgICB0aGlzLl9jbHMgKz0gJ2gtMS41IHctMS41ICc7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdtZCc6XHJcbiAgICAgICAgICB0aGlzLl9jbHMgKz0gJ2gtMiB3LTIgJztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2xnJzpcclxuICAgICAgICAgIHRoaXMuX2NscyArPSAnaC0yLjUgdy0yLjUgJztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICB0aGlzLl9jbHMgKz0gJ2gtMiB3LTIgJztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuX2NscyArPSBwbGFjZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gaWYgKHRoaXMudGRzQ2xhc3MpIHtcclxuICAgIC8vICAgdGhpcy5fY2xzID0gdGhpcy5fY2xzICsgdGhpcy50ZHNDbGFzcztcclxuICAgIC8vIH1cclxuICB9XHJcbiAgZ2V0IHN0eWxlQ3NzKCk6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gfCBudWxsIHtcclxuICAgIGxldCBzdHlsZTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSB8IG51bGwgPSBudWxsO1xyXG4gICAgaWYgKCF0aGlzLnN0YW5kYWxvbmUpIHtcclxuICAgICAgc3dpdGNoICh0aGlzLnBsYWNlbWVudCkge1xyXG4gICAgICAgIGNhc2UgJ3RvcFJpZ2h0JzpcclxuICAgICAgICAgIHN0eWxlID0ge1xyXG4gICAgICAgICAgICBbJ3RyYW5zZm9ybSddOiAndHJhbnNsYXRlKDUwJSwtNTAlKScsXHJcbiAgICAgICAgICAgIFsndHJhbnNmb3JtLW9yaWdpbiddOiAnMTAwJSAwJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAndG9wTGVmdCc6XHJcbiAgICAgICAgICBzdHlsZSA9IHtcclxuICAgICAgICAgICAgWyd0cmFuc2Zvcm0nXTogJ3RyYW5zbGF0ZSgtNTAlLC01MCUpJyxcclxuICAgICAgICAgICAgWyd0cmFuc2Zvcm0tb3JpZ2luJ106ICcwIDAnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdib3R0b21MZWZ0JzpcclxuICAgICAgICAgIHN0eWxlID0ge1xyXG4gICAgICAgICAgICBbJ3RyYW5zZm9ybSddOiAndHJhbnNsYXRlKC01MCUsNTAlKScsXHJcbiAgICAgICAgICAgIFsndHJhbnNmb3JtLW9yaWdpbiddOiAnMTAwJSAwJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnYm90dG9tUmlnaHQnOlxyXG4gICAgICAgICAgc3R5bGUgPSB7XHJcbiAgICAgICAgICAgIFsndHJhbnNmb3JtJ106ICd0cmFuc2xhdGUoNTAlLDUwJSknLFxyXG4gICAgICAgICAgICBbJ3RyYW5zZm9ybS1vcmlnaW4nXTogJzAgMTAwJSdcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBzdHlsZSA9IHtcclxuICAgICAgICAgICAgWyd0cmFuc2Zvcm0nXTogJ3RyYW5zbGF0ZSgtNTAlLDUwJSknLFxyXG4gICAgICAgICAgICBbJ3RyYW5zZm9ybS1vcmlnaW4nXTogJzEwMCUgMCdcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgXHJcbiAgICB9XHJcbiAgICBpZiAoISF0aGlzLnRkc1N0eWxlKSB7XHJcbiAgICAgIGlmIChzdHlsZSAhPSBudWxsKVxyXG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBzdHlsZSwgdGhpcy50ZHNTdHlsZSk7XHJcbiAgICAgIHJldHVybiB0aGlzLnRkc1N0eWxlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN0eWxlXHJcbiAgfVxyXG4gIGdldFBsYWNlbWVudCgpIHtcclxuICAgIGxldCByZXN1bHQgPSBcInRvcC0wIHJpZ2h0LTBcIlxyXG4gICAgc3dpdGNoICh0aGlzLnBsYWNlbWVudCkge1xyXG4gICAgICBjYXNlICd0b3BSaWdodCc6XHJcbiAgICAgICAgcmVzdWx0ID0gXCJ0b3AtMCByaWdodC0wXCJcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAndG9wTGVmdCc6XHJcbiAgICAgICAgcmVzdWx0ID0gXCJ0b3AtMCBsZWZ0LTBcIlxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdib3R0b21MZWZ0JzpcclxuICAgICAgICByZXN1bHQgPSBcImJvdHRvbS0wIGxlZnQtMFwiXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2JvdHRvbVJpZ2h0JzpcclxuICAgICAgICByZXN1bHQgPSBcImJvdHRvbS0wIHJpZ2h0LTBcIlxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJlc3VsdCA9IFwidG9wLTAgcmlnaHQtMFwiXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxufVxyXG4iXX0=