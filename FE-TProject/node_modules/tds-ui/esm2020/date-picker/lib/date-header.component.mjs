import { ChangeDetectionStrategy, Component, ViewEncapsulation } from '@angular/core';
import { CandyDate } from 'tds-ui/core/time';
import { AbstractPanelHeader } from './abstract-panel-header';
import { transCompatFormat } from './util';
import * as i0 from "@angular/core";
import * as i1 from "tds-ui/i18n";
import * as i2 from "@angular/common";
import * as i3 from "tds-ui/select";
import * as i4 from "@angular/forms";
function DateHeaderComponent_button_1_Template(rf, ctx) { if (rf & 1) {
    const _r4 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "button", 2);
    i0.ɵɵlistener("click", function DateHeaderComponent_button_1_Template_button_click_0_listener() { i0.ɵɵrestoreView(_r4); const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.superPrevious(); });
    i0.ɵɵelement(1, "span", 6);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵclassMapInterpolate1("", ctx_r0.prefixCls, "-super-prev-btn text-xl text-neutral-1-500 dark:text-d-neutral-1-500 p-1.5 flex items-center justify-center border border-transparent");
    i0.ɵɵstyleProp("visibility", ctx_r0.showSuperPreBtn ? "visible" : "hidden");
    i0.ɵɵpropertyInterpolate("title", ctx_r0.superPreviousTitle());
} }
function DateHeaderComponent_ng_container_5_button_1_Template(rf, ctx) { if (rf & 1) {
    const _r11 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "button", 9);
    i0.ɵɵlistener("click", function DateHeaderComponent_ng_container_5_button_1_Template_button_click_0_listener($event) { i0.ɵɵrestoreView(_r11); const selector_r5 = i0.ɵɵnextContext().$implicit; return selector_r5.onClick($event); });
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const selector_r5 = i0.ɵɵnextContext().$implicit;
    i0.ɵɵclassMap(selector_r5.className);
    i0.ɵɵpropertyInterpolate("title", selector_r5.title || null);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", selector_r5.label, " \u00A0 ");
} }
function DateHeaderComponent_ng_container_5_div_2_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵtext(0);
} if (rf & 2) {
    const item_r15 = ctx.item;
    i0.ɵɵtextInterpolate1(" ", item_r15.name, " ");
} }
const _c0 = function (a0, a1) { return { "w-[85px]": a0, "flex-auto": a1 }; };
function DateHeaderComponent_ng_container_5_div_2_Template(rf, ctx) { if (rf & 1) {
    const _r20 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 10)(1, "tds-select", 11);
    i0.ɵɵlistener("ngModelChange", function DateHeaderComponent_ng_container_5_div_2_Template_tds_select_ngModelChange_1_listener($event) { i0.ɵɵrestoreView(_r20); const selector_r5 = i0.ɵɵnextContext().$implicit; return selector_r5.onClick($event); });
    i0.ɵɵtemplate(2, DateHeaderComponent_ng_container_5_div_2_ng_template_2_Template, 1, 1, "ng-template", 12);
    i0.ɵɵelementEnd()();
} if (rf & 2) {
    const ctx_r21 = i0.ɵɵnextContext();
    const indx_r6 = ctx_r21.index;
    const selector_r5 = ctx_r21.$implicit;
    const ctx_r8 = i0.ɵɵnextContext();
    i0.ɵɵclassMap(i0.ɵɵpureFunction2(6, _c0, ctx_r8.selectors.length == 1, ctx_r8.selectors.length > 1 && indx_r6 == 0));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("placeholder", selector_r5.title)("ngModel", selector_r5.value)("data", selector_r5.data)("allowSearch", false);
} }
function DateHeaderComponent_ng_container_5_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, DateHeaderComponent_ng_container_5_button_1_Template, 2, 5, "button", 7);
    i0.ɵɵtemplate(2, DateHeaderComponent_ng_container_5_div_2_Template, 3, 9, "div", 8);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const selector_r5 = ctx.$implicit;
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", !selector_r5.data);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", selector_r5.data);
} }
function DateHeaderComponent_button_8_Template(rf, ctx) { if (rf & 1) {
    const _r23 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "button", 2);
    i0.ɵɵlistener("click", function DateHeaderComponent_button_8_Template_button_click_0_listener() { i0.ɵɵrestoreView(_r23); const ctx_r22 = i0.ɵɵnextContext(); return ctx_r22.superNext(); });
    i0.ɵɵelement(1, "span", 13);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵclassMapInterpolate1("", ctx_r2.prefixCls, "-super-next-btn text-xl text-neutral-1-500 dark:text-d-neutral-1-500 p-1.5 flex items-center justify-center border border-transparent");
    i0.ɵɵstyleProp("visibility", ctx_r2.showSuperNextBtn ? "visible" : "hidden");
    i0.ɵɵpropertyInterpolate("title", ctx_r2.superNextTitle());
} }
export class DateHeaderComponent extends AbstractPanelHeader {
    constructor(dateHelper) {
        super();
        this.dateHelper = dateHelper;
    }
    getSelectors() {
        let lstMonth = this.getMonths();
        const label = this.dateHelper.format(this.value.nativeDate, this.locale.monthFormat || 'MMMM');
        const value = lstMonth.find(f => { return f.name === label; })?.id;
        let that = this;
        let year = this.getYears();
        const labelyear = this.dateHelper.format(this.value.nativeDate, transCompatFormat(this.locale.yearFormat));
        const valueYear = year.find(f => { return f.name === labelyear; })?.id;
        return [
            {
                className: `${this.prefixCls}-month-btn`,
                title: this.locale.monthSelect,
                onClick: (data) => {
                    that.changeValue(that.value.setMonth(data));
                },
                label: label,
                value: value,
                data: lstMonth,
            },
            {
                className: `${this.prefixCls}-year-btn`,
                title: this.locale.yearSelect,
                onClick: (data) => {
                    that.changeValue(that.value.setYear(data)); // this.changeMode('year')
                },
                label: labelyear,
                value: valueYear,
                data: year,
            },
        ];
    }
    getMonths() {
        let result = [];
        const activeDate = new CandyDate(this.value.nativeDate);
        for (let monthValue = 0; monthValue < 12; monthValue++) {
            const month = activeDate.setMonth(monthValue);
            const content = this.dateHelper.format(month.nativeDate, 'MMMM');
            result.push({ id: monthValue, name: content });
        }
        return result;
    }
    getYears() {
        let result = [];
        const activeDate = new CandyDate(this.value.nativeDate);
        for (let year = 50; year > 0; year--) {
            if (activeDate.getYear() - year > 0)
                result.push({ id: activeDate.getYear() - year, name: `${activeDate.getYear() - year}` });
        }
        result.push({ id: activeDate.getYear(), name: `${activeDate.getYear()}` });
        for (let year = 1; year <= 50; year++) {
            result.push({ id: activeDate.getYear() + year, name: `${activeDate.getYear() + year}` });
        }
        return result;
    }
}
DateHeaderComponent.ɵfac = function DateHeaderComponent_Factory(t) { return new (t || DateHeaderComponent)(i0.ɵɵdirectiveInject(i1.DateHelperService)); };
DateHeaderComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: DateHeaderComponent, selectors: [["date-header"]], hostAttrs: [1, "block"], exportAs: ["dateHeader"], features: [i0.ɵɵInheritDefinitionFeature], decls: 9, vars: 19, consts: [[1, "flex", "py-2", "px-0.5", "w-full", 3, "ngClass"], ["role", "button", "tabindex", "-1", 3, "visibility", "class", "title", "click", 4, "ngIf"], ["role", "button", "tabindex", "-1", 3, "title", "click"], [1, "tdsi-arrow-left-line"], [4, "ngFor", "ngForOf"], [1, "tdsi-arrow-right-line"], [1, "tdsi-arrow-previous-fill"], ["role", "button", "type", "button", 3, "class", "title", "click", 4, "ngIf"], ["class", "px-0.5", 3, "class", 4, "ngIf"], ["role", "button", "type", "button", 3, "title", "click"], [1, "px-0.5"], ["valueField", "id", "textField", "name", 3, "placeholder", "ngModel", "data", "allowSearch", "ngModelChange"], ["tds-option-tmp", ""], [1, "tdsi-arrow-next-fill"]], template: function DateHeaderComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵtemplate(1, DateHeaderComponent_button_1_Template, 2, 6, "button", 1);
        i0.ɵɵelementStart(2, "button", 2);
        i0.ɵɵlistener("click", function DateHeaderComponent_Template_button_click_2_listener() { return ctx.previous(); });
        i0.ɵɵelement(3, "span", 3);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(4, "div");
        i0.ɵɵtemplate(5, DateHeaderComponent_ng_container_5_Template, 3, 2, "ng-container", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(6, "button", 2);
        i0.ɵɵlistener("click", function DateHeaderComponent_Template_button_click_6_listener() { return ctx.next(); });
        i0.ɵɵelement(7, "span", 5);
        i0.ɵɵelementEnd();
        i0.ɵɵtemplate(8, DateHeaderComponent_button_8_Template, 2, 6, "button", 1);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("ngClass", ctx.prefixCls);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.showSuperPreBtn);
        i0.ɵɵadvance(1);
        i0.ɵɵclassMapInterpolate1("", ctx.prefixCls, "-prev-btn p-1.5 text-xl text-neutral-1-500 dark:text-d-neutral-1-500 flex items-center justify-center border border-transparent");
        i0.ɵɵstyleProp("visibility", ctx.showPreBtn ? "visible" : "hidden");
        i0.ɵɵpropertyInterpolate("title", ctx.previousTitle());
        i0.ɵɵadvance(2);
        i0.ɵɵclassMapInterpolate1("", ctx.prefixCls, "-view flex-auto flex items-center justify-center font-semibold text-title-1 text-neutral-1-900 dark:text-d-neutral-1-900");
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngForOf", ctx.selectors);
        i0.ɵɵadvance(1);
        i0.ɵɵclassMapInterpolate1("", ctx.prefixCls, "-next-btn text-xl text-neutral-1-500 dark:text-d-neutral-1-500 p-1.5 flex items-center justify-center border border-transparent");
        i0.ɵɵstyleProp("visibility", ctx.showNextBtn ? "visible" : "hidden");
        i0.ɵɵpropertyInterpolate("title", ctx.nextTitle());
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngIf", ctx.showSuperNextBtn);
    } }, directives: [i2.NgClass, i2.NgIf, i2.NgForOf, i3.TDSSelect, i4.NgControlStatus, i4.NgModel, i3.TDSOptionTemplateDirective], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DateHeaderComponent, [{
        type: Component,
        args: [{ encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, selector: 'date-header', exportAs: 'dateHeader', host: {
                    class: "block"
                }, template: "<div class=\"flex py-2 px-0.5 w-full\" [ngClass]=\"prefixCls\">\r\n  <button *ngIf=\"showSuperPreBtn\" [style.visibility]=\"showSuperPreBtn ? 'visible' : 'hidden'\"\r\n    class=\"{{ prefixCls }}-super-prev-btn text-xl text-neutral-1-500 dark:text-d-neutral-1-500 p-1.5 flex items-center justify-center border border-transparent\"\r\n    role=\"button\" tabindex=\"-1\" title=\"{{ superPreviousTitle() }}\" (click)=\"superPrevious()\">\r\n    <span class=\"tdsi-arrow-previous-fill\"></span>\r\n  </button>\r\n  <button [style.visibility]=\"showPreBtn ? 'visible' : 'hidden'\"\r\n    class=\"{{ prefixCls }}-prev-btn p-1.5 text-xl text-neutral-1-500 dark:text-d-neutral-1-500 flex items-center justify-center border border-transparent\"\r\n    role=\"button\" title=\"{{ previousTitle() }}\" tabindex=\"-1\" (click)=\"previous()\">\r\n    <span class=\"tdsi-arrow-left-line\"></span>\r\n  </button>\r\n\r\n  <div\r\n    class=\"{{ prefixCls }}-view flex-auto flex items-center justify-center font-semibold text-title-1 text-neutral-1-900 dark:text-d-neutral-1-900\">\r\n    <ng-container *ngFor=\"let selector of selectors; let indx= index\">\r\n      <button *ngIf=\"!selector.data\" class=\"{{ selector.className }}\" role=\"button\" type=\"button\"\r\n        title=\"{{ selector.title || null }}\" (click)=\"selector.onClick($event)\">\r\n        {{ selector.label }} &nbsp;\r\n      </button>\r\n      <div *ngIf=\"selector.data\" class=\"px-0.5\"\r\n        [class]=\"{'w-[85px]':selectors.length == 1,'flex-auto':selectors.length > 1 && indx == 0}\">\r\n        <tds-select valueField=\"id\" textField=\"name\" [placeholder]='selector.title!' [ngModel]=\"selector.value\"\r\n          (ngModelChange)=\"selector.onClick($event)\" [data]=\"selector.data\" [allowSearch]=\"false\" >\r\n          <ng-template tds-option-tmp let-label='label' let-item=\"item\" let-value='value' let-selected=\"selected\">\r\n            {{item.name}}\r\n          </ng-template>\r\n        </tds-select>\r\n      </div>\r\n    </ng-container>\r\n  </div>\r\n  <button [style.visibility]=\"showNextBtn ? 'visible' : 'hidden'\"\r\n    class=\"{{ prefixCls }}-next-btn text-xl text-neutral-1-500 dark:text-d-neutral-1-500 p-1.5 flex items-center justify-center border border-transparent\"\r\n    role=\"button\" tabindex=\"-1\" title=\"{{ nextTitle() }}\" (click)=\"next()\">\r\n    <span class=\"tdsi-arrow-right-line\"></span>\r\n  </button>\r\n  <button *ngIf=\"showSuperNextBtn\" [style.visibility]=\"showSuperNextBtn ? 'visible' : 'hidden'\"\r\n    class=\"{{ prefixCls }}-super-next-btn text-xl text-neutral-1-500 dark:text-d-neutral-1-500 p-1.5 flex items-center justify-center border border-transparent\"\r\n    role=\"button\" tabindex=\"-1\" title=\"{{ superNextTitle() }}\" (click)=\"superNext()\">\r\n    <span class=\"tdsi-arrow-next-fill\"></span>\r\n  </button>\r\n</div>" }]
    }], function () { return [{ type: i1.DateHelperService }]; }, null); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1oZWFkZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdGRzLXVpL2RhdGUtcGlja2VyL2xpYi9kYXRlLWhlYWRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy90ZHMtdWkvZGF0ZS1waWNrZXIvbGliL2Fic3RyYWN0LXBhbmVsLWhlYWRlci5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdEYsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBSTdDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRTlELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLFFBQVEsQ0FBQzs7Ozs7Ozs7SUNSekMsaUNBRTJGO0lBQTFCLG1LQUFTLHNCQUFlLElBQUM7SUFDeEYsMEJBQThDO0lBQ2hELGlCQUFTOzs7SUFIUCx3TEFBNEo7SUFEOUgsMkVBQTJEO0lBRTdELDhEQUFrQzs7OztJQVk1RCxpQ0FDMEU7SUFBbkMsd01BQVMsMkJBQXdCLElBQUM7SUFDdkUsWUFDRjtJQUFBLGlCQUFTOzs7SUFIc0Isb0NBQWdDO0lBQzdELDREQUFvQztJQUNwQyxlQUNGO0lBREUseURBQ0Y7OztJQU1NLFlBQ0Y7OztJQURFLDhDQUNGOzs7OztJQU5KLCtCQUM2RixxQkFBQTtJQUV6Rix5TkFBaUIsMkJBQXdCLElBQUM7SUFDMUMsMEdBRWM7SUFDaEIsaUJBQWEsRUFBQTs7Ozs7O0lBTmIsb0hBQTBGO0lBQzdDLGVBQStCO0lBQS9CLCtDQUErQiw4QkFBQSwwQkFBQSxzQkFBQTs7O0lBUGhGLDZCQUFrRTtJQUNoRSx5RkFHUztJQUNULG1GQVFNO0lBQ1IsMEJBQWU7OztJQWJKLGVBQW9CO0lBQXBCLHdDQUFvQjtJ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bUI7c0VBQW5CLG1CQUFtQjtRQ3JCaEMsOEJBQTJEO1FBQ3pELDBFQUlTO1FBQ1QsaUNBRWlGO1FBQXJCLGdHQUFTLGNBQVUsSUFBQztRQUM5RSwwQkFBMEM7UUFDNUMsaUJBQVM7UUFFVCwyQkFDa0o7UUFDaEosc0ZBY2U7UUFDakIsaUJBQU07UUFDTixpQ0FFeUU7UUFBakIsZ0dBQVMsVUFBTSxJQUFDO1FBQ3RFLDBCQUEyQztRQUM3QyxpQkFBUztRQUNULDBFQUlTO1FBQ1gsaUJBQU07O1FBeEMrQix1Q0FBcUI7UUFDL0MsZUFBcUI7UUFBckIsMENBQXFCO1FBTTVCLGVBQXNKO1FBQXRKLCtLQUFzSjtRQURoSixtRUFBc0Q7UUFFOUMsc0RBQTZCO1FBSzNDLGVBQStJO1FBQS9JLHdLQUErSTtRQUM1RyxlQUFjO1FBQWQsdUNBQWM7UUFpQmpELGVBQXNKO1FBQXRKLCtLQUFzSjtRQURoSixvRUFBdUQ7UUFFakMsa0RBQXlCO1FBRzlDLGVBQXNCO1FBQXRCLDJDQUFzQjs7dUZEZHBCLG1CQUFtQjtjQVYvQixTQUFTO2dDQUNPLGlCQUFpQixDQUFDLElBQUksbUJBQ3BCLHVCQUF1QixDQUFDLE1BQU0sWUFDckMsYUFBYSxZQUNiLFlBQVksUUFFaEI7b0JBQ0osS0FBSyxFQUFFLE9BQU87aUJBQ2YiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIFZpZXdFbmNhcHN1bGF0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENhbmR5RGF0ZSB9IGZyb20gJ3Rkcy11aS9jb3JlL3RpbWUnO1xyXG5pbXBvcnQgeyBEYXRlSGVscGVyU2VydmljZSB9IGZyb20gJ3Rkcy11aS9pMThuJztcclxuaW1wb3J0IHsgVERTU2FmZUFueSB9IGZyb20gJ3Rkcy11aS9zaGFyZWQvdXRpbGl0eSc7XHJcblxyXG5pbXBvcnQgeyBBYnN0cmFjdFBhbmVsSGVhZGVyIH0gZnJvbSAnLi9hYnN0cmFjdC1wYW5lbC1oZWFkZXInO1xyXG5pbXBvcnQgeyBQYW5lbFNlbGVjdG9yIH0gZnJvbSAnLi9pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyB0cmFuc0NvbXBhdEZvcm1hdCB9IGZyb20gJy4vdXRpbCc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxyXG4gIHNlbGVjdG9yOiAnZGF0ZS1oZWFkZXInLCAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxyXG4gIGV4cG9ydEFzOiAnZGF0ZUhlYWRlcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2Fic3RyYWN0LXBhbmVsLWhlYWRlci5odG1sJyxcclxuICBob3N0OiB7XHJcbiAgICBjbGFzczogXCJibG9ja1wiXHJcbiAgfVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRGF0ZUhlYWRlckNvbXBvbmVudCBleHRlbmRzIEFic3RyYWN0UGFuZWxIZWFkZXIge1xyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0ZUhlbHBlcjogRGF0ZUhlbHBlclNlcnZpY2UpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgfVxyXG5cclxuICBnZXRTZWxlY3RvcnMoKTogUGFuZWxTZWxlY3RvcltdIHtcclxuICAgIGxldCBsc3RNb250aCA9IHRoaXMuZ2V0TW9udGhzKCk7XHJcbiAgICBjb25zdCBsYWJlbCA9IHRoaXMuZGF0ZUhlbHBlci5mb3JtYXQodGhpcy52YWx1ZS5uYXRpdmVEYXRlLCB0aGlzLmxvY2FsZS5tb250aEZvcm1hdCB8fCAnTU1NTScpO1xyXG4gICAgY29uc3QgdmFsdWUgPSBsc3RNb250aC5maW5kKGYgPT4geyByZXR1cm4gZi5uYW1lID09PSBsYWJlbCB9KT8uaWQ7XHJcbiAgICBsZXQgdGhhdCA9IHRoaXM7XHJcbiAgICBsZXQgeWVhciA9IHRoaXMuZ2V0WWVhcnMoKTtcclxuICAgIGNvbnN0IGxhYmVseWVhciA9IHRoaXMuZGF0ZUhlbHBlci5mb3JtYXQodGhpcy52YWx1ZS5uYXRpdmVEYXRlLCB0cmFuc0NvbXBhdEZvcm1hdCh0aGlzLmxvY2FsZS55ZWFyRm9ybWF0KSk7XHJcbiAgICBjb25zdCB2YWx1ZVllYXIgPSB5ZWFyLmZpbmQoZiA9PiB7IHJldHVybiBmLm5hbWUgPT09IGxhYmVseWVhciB9KT8uaWQ7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB7XHJcbiAgICAgICAgY2xhc3NOYW1lOiBgJHt0aGlzLnByZWZpeENsc30tbW9udGgtYnRuYCxcclxuICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGUubW9udGhTZWxlY3QsXHJcbiAgICAgICAgb25DbGljazogKGRhdGE6IFREU1NhZmVBbnkpID0+IHtcclxuICAgICAgICAgIHRoYXQuY2hhbmdlVmFsdWUodGhhdC52YWx1ZS5zZXRNb250aChkYXRhKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsYWJlbDogbGFiZWwsXHJcbiAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgIGRhdGE6IGxzdE1vbnRoLFxyXG5cclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGNsYXNzTmFtZTogYCR7dGhpcy5wcmVmaXhDbHN9LXllYXItYnRuYCxcclxuICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGUueWVhclNlbGVjdCxcclxuICAgICAgICBvbkNsaWNrOiAoZGF0YTogVERTU2FmZUFueSkgPT4ge1xyXG4gICAgICAgICAgdGhhdC5jaGFuZ2VWYWx1ZSh0aGF0LnZhbHVlLnNldFllYXIoZGF0YSkpOy8vIHRoaXMuY2hhbmdlTW9kZSgneWVhcicpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBsYWJlbDogbGFiZWx5ZWFyLFxyXG4gICAgICAgIHZhbHVlOiB2YWx1ZVllYXIsXHJcbiAgICAgICAgZGF0YTogeWVhcixcclxuICAgICAgfSxcclxuXHJcbiAgICBdO1xyXG4gIH1cclxuICBwcml2YXRlIGdldE1vbnRocygpIHtcclxuICAgIGxldCByZXN1bHQgPSBbXTtcclxuICAgIGNvbnN0IGFjdGl2ZURhdGUgPSBuZXcgQ2FuZHlEYXRlKHRoaXMudmFsdWUubmF0aXZlRGF0ZSk7XHJcbiAgICBmb3IgKGxldCBtb250aFZhbHVlID0gMDsgbW9udGhWYWx1ZSA8IDEyOyBtb250aFZhbHVlKyspIHtcclxuICAgICAgY29uc3QgbW9udGggPSBhY3RpdmVEYXRlLnNldE1vbnRoKG1vbnRoVmFsdWUpO1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gdGhpcy5kYXRlSGVscGVyLmZvcm1hdChtb250aC5uYXRpdmVEYXRlLCAnTU1NTScpO1xyXG4gICAgICByZXN1bHQucHVzaCh7IGlkOiBtb250aFZhbHVlLCBuYW1lOiBjb250ZW50IH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcbiAgcHJpdmF0ZSBnZXRZZWFycygpIHtcclxuICAgIGxldCByZXN1bHQgPSBbXTtcclxuICAgIGNvbnN0IGFjdGl2ZURhdGUgPSBuZXcgQ2FuZHlEYXRlKHRoaXMudmFsdWUubmF0aXZlRGF0ZSk7ICAgIFxyXG4gICAgZm9yIChsZXQgeWVhciA9IDUwOyB5ZWFyID4gMDsgeWVhci0tKSB7XHJcbiAgICAgIGlmKGFjdGl2ZURhdGUuZ2V0WWVhcigpIC0geWVhciA+IDApXHJcbiAgICAgIHJlc3VsdC5wdXNoKHsgaWQ6IGFjdGl2ZURhdGUuZ2V0WWVhcigpIC0geWVhciwgbmFtZTogYCR7YWN0aXZlRGF0ZS5nZXRZZWFyKCkgLSB5ZWFyfWAgfSk7XHJcbiAgICB9XHJcbiAgICByZXN1bHQucHVzaCh7IGlkOiBhY3RpdmVEYXRlLmdldFllYXIoKSwgbmFtZTogYCR7YWN0aXZlRGF0ZS5nZXRZZWFyKCl9YCB9KTtcclxuICAgIGZvciAobGV0IHllYXIgPSAxOyB5ZWFyIDw9IDUwOyB5ZWFyKyspIHtcclxuICAgICAgcmVzdWx0LnB1c2goeyBpZDogYWN0aXZlRGF0ZS5nZXRZZWFyKCkgKyB5ZWFyLCBuYW1lOiBgJHthY3RpdmVEYXRlLmdldFllYXIoKSArIHllYXJ9YCB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG59XHJcbiIsIjxkaXYgY2xhc3M9XCJmbGV4IHB5LTIgcHgtMC41IHctZnVsbFwiIFtuZ0NsYXNzXT1cInByZWZpeENsc1wiPlxyXG4gIDxidXR0b24gKm5nSWY9XCJzaG93U3VwZXJQcmVCdG5cIiBbc3R5bGUudmlzaWJpbGl0eV09XCJzaG93U3VwZXJQcmVCdG4gPyAndmlzaWJsZScgOiAnaGlkZGVuJ1wiXHJcbiAgICBjbGFzcz1cInt7IHByZWZpeENscyB9fS1zdXBlci1wcmV2LWJ0biB0ZXh0LXhsIHRleHQtbmV1dHJhbC0xLTUwMCBkYXJrOnRleHQtZC1uZXV0cmFsLTEtNTAwIHAtMS41IGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIGJvcmRlciBib3JkZXItdHJhbnNwYXJlbnRcIlxyXG4gICAgcm9sZT1cImJ1dHRvblwiIHRhYmluZGV4PVwiLTFcIiB0aXRsZT1cInt7IHN1cGVyUHJldmlvdXNUaXRsZSgpIH19XCIgKGNsaWNrKT1cInN1cGVyUHJldmlvdXMoKVwiPlxyXG4gICAgPHNwYW4gY2xhc3M9XCJ0ZHNpLWFycm93LXByZXZpb3VzLWZpbGxcIj48L3NwYW4+XHJcbiAgPC9idXR0b24+XHJcbiAgPGJ1dHRvbiBbc3R5bGUudmlzaWJpbGl0eV09XCJzaG93UHJlQnRuID8gJ3Zpc2libGUnIDogJ2hpZGRlbidcIlxyXG4gICAgY2xhc3M9XCJ7eyBwcmVmaXhDbHMgfX0tcHJldi1idG4gcC0xLjUgdGV4dC14bCB0ZXh0LW5ldXRyYWwtMS01MDAgZGFyazp0ZXh0LWQtbmV1dHJhbC0xLTUwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBib3JkZXIgYm9yZGVyLXRyYW5zcGFyZW50XCJcclxuICAgIHJvbGU9XCJidXR0b25cIiB0aXRsZT1cInt7IHByZXZpb3VzVGl0bGUoKSB9fVwiIHRhYmluZGV4PVwiLTFcIiAoY2xpY2spPVwicHJldmlvdXMoKVwiPlxyXG4gICAgPHNwYW4gY2xhc3M9XCJ0ZHNpLWFycm93LWxlZnQtbGluZVwiPjwvc3Bhbj5cclxuICA8L2J1dHRvbj5cclxuXHJcbiAgPGRpdlxyXG4gICAgY2xhc3M9XCJ7eyBwcmVmaXhDbHMgfX0tdmlldyBmbGV4LWF1dG8gZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZm9udC1zZW1pYm9sZCB0ZXh0LXRpdGxlLTEgdGV4dC1uZXV0cmFsLTEtOTAwIGRhcms6dGV4dC1kLW5ldXRyYWwtMS05MDBcIj5cclxuICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IHNlbGVjdG9yIG9mIHNlbGVjdG9yczsgbGV0IGluZHg9IGluZGV4XCI+XHJcbiAgICAgIDxidXR0b24gKm5nSWY9XCIhc2VsZWN0b3IuZGF0YVwiIGNsYXNzPVwie3sgc2VsZWN0b3IuY2xhc3NOYW1lIH19XCIgcm9sZT1cImJ1dHRvblwiIHR5cGU9XCJidXR0b25cIlxyXG4gICAgICAgIHRpdGxlPVwie3sgc2VsZWN0b3IudGl0bGUgfHwgbnVsbCB9fVwiIChjbGljayk9XCJzZWxlY3Rvci5vbkNsaWNrKCRldmVudClcIj5cclxuICAgICAgICB7eyBzZWxlY3Rvci5sYWJlbCB9fSAmbmJzcDtcclxuICAgICAgPC9idXR0b24+XHJcbiAgICAgIDxkaXYgKm5nSWY9XCJzZWxlY3Rvci5kYXRhXCIgY2xhc3M9XCJweC0wLjVcIlxyXG4gICAgICAgIFtjbGFzc109XCJ7J3ctWzg1cHhdJzpzZWxlY3RvcnMubGVuZ3RoID09IDEsJ2ZsZXgtYXV0byc6c2VsZWN0b3JzLmxlbmd0aCA+IDEgJiYgaW5keCA9PSAwfVwiPlxyXG4gICAgICAgIDx0ZHMtc2VsZWN0IHZhbHVlRmllbGQ9XCJpZFwiIHRleHRGaWVsZD1cIm5hbWVcIiBbcGxhY2Vob2xkZXJdPSdzZWxlY3Rvci50aXRsZSEnIFtuZ01vZGVsXT1cInNlbGVjdG9yLnZhbHVlXCJcclxuICAgICAgICAgIChuZ01vZGVsQ2hhbmdlKT1cInNlbGVjdG9yLm9uQ2xpY2soJGV2ZW50KVwiIFtkYXRhXT1cInNlbGVjdG9yLmRhdGFcIiBbYWxsb3dTZWFyY2hdPVwiZmFsc2VcIiA+XHJcbiAgICAgICAgICA8bmctdGVtcGxhdGUgdGRzLW9wdGlvbi10bXAgbGV0LWxhYmVsPSdsYWJlbCcgbGV0LWl0ZW09XCJpdGVtXCIgbGV0LXZhbHVlPSd2YWx1ZScgbGV0LXNlbGVjdGVkPVwic2VsZWN0ZWRcIj5cclxuICAgICAgICAgICAge3tpdGVtLm5hbWV9fVxyXG4gICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cclxuICAgICAgICA8L3Rkcy1zZWxlY3Q+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9uZy1jb250YWluZXI+XHJcbiAgPC9kaXY+XHJcbiAgPGJ1dHRvbiBbc3R5bGUudmlzaWJpbGl0eV09XCJzaG93TmV4dEJ0biA/ICd2aXNpYmxlJyA6ICdoaWRkZW4nXCJcclxuICAgIGNsYXNzPVwie3sgcHJlZml4Q2xzIH19LW5leHQtYnRuIHRleHQteGwgdGV4dC1uZXV0cmFsLTEtNTAwIGRhcms6dGV4dC1kLW5ldXRyYWwtMS01MDAgcC0xLjUgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgYm9yZGVyIGJvcmRlci10cmFuc3BhcmVudFwiXHJcbiAgICByb2xlPVwiYnV0dG9uXCIgdGFiaW5kZXg9XCItMVwiIHRpdGxlPVwie3sgbmV4dFRpdGxlKCkgfX1cIiAoY2xpY2spPVwibmV4dCgpXCI+XHJcbiAgICA8c3BhbiBjbGFzcz1cInRkc2ktYXJyb3ctcmlnaHQtbGluZVwiPjwvc3Bhbj5cclxuICA8L2J1dHRvbj5cclxuICA8YnV0dG9uICpuZ0lmPVwic2hvd1N1cGVyTmV4dEJ0blwiIFtzdHlsZS52aXNpYmlsaXR5XT1cInNob3dTdXBlck5leHRCdG4gPyAndmlzaWJsZScgOiAnaGlkZGVuJ1wiXHJcbiAgICBjbGFzcz1cInt7IHByZWZpeENscyB9fS1zdXBlci1uZXh0LWJ0biB0ZXh0LXhsIHRleHQtbmV1dHJhbC0xLTUwMCBkYXJrOnRleHQtZC1uZXV0cmFsLTEtNTAwIHAtMS41IGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIGJvcmRlciBib3JkZXItdHJhbnNwYXJlbnRcIlxyXG4gICAgcm9sZT1cImJ1dHRvblwiIHRhYmluZGV4PVwiLTFcIiB0aXRsZT1cInt7IHN1cGVyTmV4dFRpdGxlKCkgfX1cIiAoY2xpY2spPVwic3VwZXJOZXh0KClcIj5cclxuICAgIDxzcGFuIGNsYXNzPVwidGRzaS1hcnJvdy1uZXh0LWZpbGxcIj48L3NwYW4+XHJcbiAgPC9idXR0b24+XHJcbjwvZGl2PiJdfQ==