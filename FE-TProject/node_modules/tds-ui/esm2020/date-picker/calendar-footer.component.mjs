import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output, ViewEncapsulation } from '@angular/core';
import { Subject } from 'rxjs';
import { TDSHelperObject } from 'tds-ui/shared/utility';
import { CandyDate } from 'tds-ui/core/time';
import { isNonEmptyString, isTemplateRef } from 'tds-ui/core/util';
import { transCompatFormat } from './lib/util';
import { PREFIX_CLASS } from './util';
import * as i0 from "@angular/core";
import * as i1 from "tds-ui/i18n";
import * as i2 from "./date-picker.service";
import * as i3 from "@angular/common";
import * as i4 from "tds-ui/button";
function CalendarFooterComponent_div_1_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function CalendarFooterComponent_div_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, CalendarFooterComponent_div_1_ng_container_2_ng_container_1_Template, 1, 0, "ng-container", 5);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", ctx_r3.extraFooter);
} }
function CalendarFooterComponent_div_1_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelement(1, "span", 6);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("innerHTML", ctx_r4.extraFooter, i0.ɵɵsanitizeHtml);
} }
function CalendarFooterComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div");
    i0.ɵɵelementContainerStart(1, 3);
    i0.ɵɵtemplate(2, CalendarFooterComponent_div_1_ng_container_2_Template, 2, 1, "ng-container", 4);
    i0.ɵɵtemplate(3, CalendarFooterComponent_div_1_ng_container_3_Template, 2, 1, "ng-container", 4);
    i0.ɵɵelementContainerEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵclassMapInterpolate1("", ctx_r0.prefixCls, "-footer-extra");
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngSwitch", true);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngSwitchCase", ctx_r0.isTemplateRef(ctx_r0.extraFooter));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngSwitchCase", ctx_r0.isNonEmptyString(ctx_r0.extraFooter));
} }
function CalendarFooterComponent_div_2_Template(rf, ctx) { if (rf & 1) {
    const _r7 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 7)(1, "a", 8);
    i0.ɵɵlistener("click", function CalendarFooterComponent_div_2_Template_a_click_1_listener() { i0.ɵɵrestoreView(_r7); const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.isTodayDisabled ? null : ctx_r6.onClickToday(); });
    i0.ɵɵtext(2);
    i0.ɵɵelementEnd()();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵclassMapInterpolate2("", ctx_r1.prefixCls, "-today-btn ", ctx_r1.isTodayDisabled ? ctx_r1.prefixCls + "-today-btn-disabled" : "text-primary-1", " text-body-2 font-semibold uppercase");
    i0.ɵɵpropertyInterpolate("title", ctx_r1.todayTitle);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", ctx_r1.locale.today, " ");
} }
function CalendarFooterComponent_div_3_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 14)(1, "div", 15)(2, "div", 16);
    i0.ɵɵelement(3, "span", 17);
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "div", 18);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(6, "div", 19);
    i0.ɵɵtext(7, " - ");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(8, "div", 18);
    i0.ɵɵtext(9);
    i0.ɵɵelementEnd()()();
} if (rf & 2) {
    const ctx_r8 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(5);
    i0.ɵɵtextInterpolate1(" ", ctx_r8.startDate, " ");
    i0.ɵɵadvance(4);
    i0.ɵɵtextInterpolate1(" ", ctx_r8.endDate, " ");
} }
function CalendarFooterComponent_div_3_Template(rf, ctx) { if (rf & 1) {
    const _r10 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 9);
    i0.ɵɵtemplate(1, CalendarFooterComponent_div_3_div_1_Template, 10, 2, "div", 10);
    i0.ɵɵelementStart(2, "div", 11)(3, "button", 12);
    i0.ɵɵlistener("click", function CalendarFooterComponent_div_3_Template_button_click_3_listener() { i0.ɵɵrestoreView(_r10); const ctx_r9 = i0.ɵɵnextContext(); return ctx_r9.onClickCancel(); });
    i0.ɵɵtext(4, "Cancel");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(5, "button", 13);
    i0.ɵɵlistener("click", function CalendarFooterComponent_div_3_Template_button_click_5_listener() { i0.ɵɵrestoreView(_r10); const ctx_r11 = i0.ɵɵnextContext(); return ctx_r11.okDisabled ? null : ctx_r11.clickOk.emit(); });
    i0.ɵɵtext(6, "Apply");
    i0.ɵɵelementEnd()()();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", !ctx_r2.hasTimePicker && (ctx_r2.startDate || ctx_r2.endDate));
    i0.ɵɵadvance(4);
    i0.ɵɵproperty("disabled", ctx_r2.okDisabled);
} }
export class CalendarFooterComponent {
    constructor(dateHelper, datePickerService) {
        this.dateHelper = dateHelper;
        this.datePickerService = datePickerService;
        this.showToday = false;
        this.showNow = false;
        this.hasTimePicker = false;
        this.isRange = false;
        this.okDisabled = false;
        this.rangeQuickSelector = null;
        this.clickOk = new EventEmitter();
        this.clickCancel = new EventEmitter();
        this.clickToday = new EventEmitter();
        this.prefixCls = PREFIX_CLASS;
        this.isTemplateRef = isTemplateRef;
        this.isNonEmptyString = isNonEmptyString;
        this.isTodayDisabled = false;
        this.todayTitle = '';
        this.destroy$ = new Subject();
        this.startDate = "";
        this.endDate = "";
    }
    ngOnChanges(changes) {
        const now = new Date();
        if (changes.disabledDate) {
            this.isTodayDisabled = !!(this.disabledDate && this.disabledDate(now));
        }
        if (changes.locale) {
            // NOTE: Compat for DatePipe formatting rules
            const dateFormat = transCompatFormat(this.locale.dateFormat);
            this.todayTitle = this.dateHelper.format(now, dateFormat);
        }
        if (changes.listDate) {
            if (this.isRange) {
                const dateFormat = transCompatFormat(this.locale.dateFormat);
                if (TDSHelperObject.hasValue(this.listDate)) {
                    let startDate = this.listDate[0];
                    let endDate = this.listDate[1];
                    if (TDSHelperObject.hasValue(startDate)) {
                        this.startDate = this.dateHelper.format(startDate.nativeDate, dateFormat);
                    }
                    else {
                        this.startDate = "";
                    }
                    if (TDSHelperObject.hasValue(endDate)) {
                        this.endDate = this.dateHelper.format(endDate.nativeDate, dateFormat);
                    }
                    else {
                        this.endDate = "";
                    }
                }
                else {
                    this.startDate = "";
                    this.endDate = "";
                }
            }
        }
    }
    onClickToday() {
        const now = new CandyDate();
        this.clickToday.emit(now.clone()); // To prevent the "now" being modified from outside, we use clone
    }
    onClickCancel() {
        this.clickCancel.emit(); // To prevent the "now" being modified from outside, we use clone
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
}
CalendarFooterComponent.ɵfac = function CalendarFooterComponent_Factory(t) { return new (t || CalendarFooterComponent)(i0.ɵɵdirectiveInject(i1.DateHelperService), i0.ɵɵdirectiveInject(i2.DatePickerService)); };
CalendarFooterComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: CalendarFooterComponent, selectors: [["calendar-footer"]], inputs: { locale: "locale", showToday: "showToday", showNow: "showNow", hasTimePicker: "hasTimePicker", isRange: "isRange", listDate: "listDate", okDisabled: "okDisabled", disabledDate: "disabledDate", extraFooter: "extraFooter", rangeQuickSelector: "rangeQuickSelector" }, outputs: { clickOk: "clickOk", clickCancel: "clickCancel", clickToday: "clickToday" }, exportAs: ["calendarFooter"], features: [i0.ɵɵNgOnChangesFeature], decls: 4, vars: 6, consts: [[3, "class", 4, "ngIf"], ["class", "flex justify-center px-4 py-2 w-full", 4, "ngIf"], ["class", "flex justify-end items-center px-4 py-2 w-full", 4, "ngIf"], [3, "ngSwitch"], [4, "ngSwitchCase"], [4, "ngTemplateOutlet"], [3, "innerHTML"], [1, "flex", "justify-center", "px-4", "py-2", "w-full"], ["role", "button", 3, "title", "click"], [1, "flex", "justify-end", "items-center", "px-4", "py-2", "w-full"], ["class", "px-4", 4, "ngIf"], [1, "ml-2"], ["tds-button", "", "color", "secondary", 1, "mr-2", 3, "click"], ["tds-button", "", "color", "primary", 3, "disabled", "click"], [1, "px-4"], [1, "flex", "items-center", "text-neutral-1-400"], [1, "flex"], [1, "text-lg", "leading-5", "tdsi-calendar-fill"], [1, "px-2", "text-body-2", "font-regular", "text-center"], [1, "text-body-2", "font-regular"]], template: function CalendarFooterComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div");
        i0.ɵɵtemplate(1, CalendarFooterComponent_div_1_Template, 4, 6, "div", 0);
        i0.ɵɵtemplate(2, CalendarFooterComponent_div_2_Template, 3, 6, "div", 1);
        i0.ɵɵtemplate(3, CalendarFooterComponent_div_3_Template, 7, 2, "div", 2);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵclassMapInterpolate1("", ctx.prefixCls, "-footer w-full  border-0 border-t  border-neutral-2-200 dark:border-d-neutral-2-200");
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.extraFooter);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", !ctx.isRange);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.isRange);
    } }, directives: [i3.NgIf, i3.NgSwitch, i3.NgSwitchCase, i3.NgTemplateOutlet, i4.TDSButtonComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CalendarFooterComponent, [{
        type: Component,
        args: [{ encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, selector: 'calendar-footer', exportAs: 'calendarFooter', template: "<div class=\"{{ prefixCls }}-footer w-full  border-0 border-t  border-neutral-2-200 dark:border-d-neutral-2-200\">\r\n    <div *ngIf=\"extraFooter\" class=\"{{ prefixCls }}-footer-extra\">\r\n        <ng-container [ngSwitch]=\"true\">\r\n            <ng-container *ngSwitchCase=\"isTemplateRef(extraFooter)\">\r\n                <ng-container *ngTemplateOutlet=\"$any(extraFooter)\"></ng-container>\r\n            </ng-container>\r\n            <ng-container *ngSwitchCase=\"isNonEmptyString(extraFooter)\">\r\n                <span [innerHTML]=\"extraFooter\"></span>\r\n            </ng-container>\r\n        </ng-container>\r\n    </div>\r\n    <div class=\"flex justify-center px-4 py-2 w-full\" *ngIf=\"!isRange\">\r\n        <a class=\"{{ prefixCls }}-today-btn {{ isTodayDisabled ? prefixCls + '-today-btn-disabled' : 'text-primary-1' }} text-body-2 font-semibold uppercase\"\r\n            role=\"button\" (click)=\"isTodayDisabled ? null : onClickToday()\" title=\"{{ todayTitle }}\">\r\n            {{ locale.today }}\r\n        </a>\r\n    </div>\r\n    <div class=\"flex justify-end items-center px-4 py-2 w-full\" *ngIf=\"isRange\">\r\n        <div *ngIf=\"!hasTimePicker && (startDate || endDate)\" class=\"px-4\">\r\n            <div class=\"flex items-center text-neutral-1-400\">\r\n                <div class=\"flex\">\r\n                    <span class=\"text-lg leading-5  tdsi-calendar-fill\"></span>\r\n                </div>\r\n                <div class=\"px-2 text-body-2 font-regular text-center\">\r\n                  {{startDate}}\r\n                </div>\r\n                <div class=\"text-body-2 font-regular\">\r\n                    -\r\n                </div>\r\n                <div class=\"px-2  text-body-2 font-regular text-center\">\r\n                    {{endDate}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"ml-2\">\r\n            <button tds-button color=\"secondary\" class=\"mr-2\" (click)=\"onClickCancel()\">Cancel</button>\r\n            <button tds-button color=\"primary\"   [disabled]=\"okDisabled\"\r\n            (click)=\"okDisabled ? null : clickOk.emit()\">Apply</button>\r\n        </div>\r\n    </div>\r\n</div>" }]
    }], function () { return [{ type: i1.DateHelperService }, { type: i2.DatePickerService }]; }, { locale: [{
            type: Input
        }], showToday: [{
            type: Input
        }], showNow: [{
            type: Input
        }], hasTimePicker: [{
            type: Input
        }], isRange: [{
            type: Input
        }], listDate: [{
            type: Input
        }], okDisabled: [{
            type: Input
        }], disabledDate: [{
            type: Input
        }], extraFooter: [{
            type: Input
        }], rangeQuickSelector: [{
            type: Input
        }], clickOk: [{
            type: Output
        }], clickCancel: [{
            type: Output
        }], clickToday: [{
            type: Output
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItZm9vdGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL3Rkcy11aS9kYXRlLXBpY2tlci9jYWxlbmRhci1mb290ZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vcHJvamVjdHMvdGRzLXVpL2RhdGUtcGlja2VyL2NhbGVuZGFyLWZvb3Rlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQ0wsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFDVCxZQUFZLEVBQ1osS0FBSyxFQUlMLE1BQU0sRUFHTixpQkFBaUIsRUFDbEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMvQixPQUFPLEVBQUUsZUFBZSxFQUFjLE1BQU0sdUJBQXVCLENBQUM7QUFDcEUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQzdDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUduRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFL0MsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLFFBQVEsQ0FBQzs7Ozs7OztJQ25CdEIsd0JBQW1FOzs7SUFEdkUsNkJBQXlEO0lBQ3JELCtHQUFtRTtJQUN2RSwwQkFBZTs7O0lBREksZUFBbUM7SUFBbkMscURBQW1DOzs7SUFFdEQsNkJBQTREO0lBQ3hELDBCQUF1QztJQUMzQywwQkFBZTs7O0lBREwsZUFBeUI7SUFBekIsaUVBQXlCOzs7SUFOM0MsMkJBQThEO0lBQzFELGdDQUFnQztJQUM1QixnR0FFZTtJQUNmLGdHQUVlO0lBQ25CLDBCQUFlO0lBQ25CLGlCQUFNOzs7SUFUbUIsZ0VBQW9DO0lBQzNDLGVBQWlCO0lBQWpCLCtCQUFpQjtJQUNaLGVBQXdDO0lBQXhDLHVFQUF3QztJ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LFFBQVEsRUFBRSxDQUFDO0lBQzNCLENBQUM7OzhGQWxGVSx1QkFBdUI7MEVBQXZCLHVCQUF1QjtRQ2pDcEMsMkJBQWdIO1FBQzVHLHdFQVNNO1FBQ04sd0VBS007UUFDTix3RUFzQk07UUFDVixpQkFBTTs7UUF4Q0QsbUlBQTBHO1FBQ3JHLGVBQWlCO1FBQWpCLHNDQUFpQjtRQVU0QixlQUFjO1FBQWQsbUNBQWM7UUFNSixlQUFhO1FBQWIsa0NBQWE7O3VGRGdCakUsdUJBQXVCO2NBUm5DLFNBQVM7Z0NBQ08saUJBQWlCLENBQUMsSUFBSSxtQkFDcEIsdUJBQXVCLENBQUMsTUFBTSxZQUVyQyxpQkFBaUIsWUFDakIsZ0JBQWdCO29HQUlqQixNQUFNO2tCQUFkLEtBQUs7WUFDRyxTQUFTO2tCQUFqQixLQUFLO1lBQ0csT0FBTztrQkFBZixLQUFLO1lBQ0csYUFBYTtrQkFBckIsS0FBSztZQUNHLE9BQU87a0JBQWYsS0FBSztZQUNHLFFBQVE7a0JBQWhCLEtBQUs7WUFFRyxVQUFVO2tCQUFsQixLQUFLO1lBQ0csWUFBWTtrQkFBcEIsS0FBSztZQUNHLFdBQVc7a0JBQW5CLEtBQUs7WUFDRyxrQkFBa0I7a0JBQTFCLEtBQUs7WUFFYSxPQUFPO2tCQUF6QixNQUFNO1lBQ1ksV0FBVztrQkFBN0IsTUFBTTtZQUNZLFVBQVU7a0JBQTVCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmltcG9ydCB7XHJcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXHJcbiAgQ29tcG9uZW50LFxyXG4gIEV2ZW50RW1pdHRlcixcclxuICBJbnB1dCxcclxuICBPbkNoYW5nZXMsXHJcbiAgT25EZXN0cm95LFxyXG4gIE9uSW5pdCxcclxuICBPdXRwdXQsXHJcbiAgU2ltcGxlQ2hhbmdlcyxcclxuICBUZW1wbGF0ZVJlZixcclxuICBWaWV3RW5jYXBzdWxhdGlvblxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFREU0hlbHBlck9iamVjdCwgVERTU2FmZUFueSB9IGZyb20gJ3Rkcy11aS9zaGFyZWQvdXRpbGl0eSc7XHJcbmltcG9ydCB7IENhbmR5RGF0ZSB9IGZyb20gJ3Rkcy11aS9jb3JlL3RpbWUnO1xyXG5pbXBvcnQgeyBpc05vbkVtcHR5U3RyaW5nLCBpc1RlbXBsYXRlUmVmIH0gZnJvbSAndGRzLXVpL2NvcmUvdXRpbCc7XHJcbmltcG9ydCB7IERhdGVIZWxwZXJTZXJ2aWNlLCBURFNDYWxlbmRhckkxOG5JbnRlcmZhY2UgfSBmcm9tICd0ZHMtdWkvaTE4bic7XHJcbmltcG9ydCB7IERhdGVQaWNrZXJTZXJ2aWNlIH0gZnJvbSAnLi9kYXRlLXBpY2tlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgdHJhbnNDb21wYXRGb3JtYXQgfSBmcm9tICcuL2xpYi91dGlsJztcclxuaW1wb3J0IHsgQ29tcGF0aWJsZURhdGUgfSBmcm9tICcuL3N0YW5kYXJkLXR5cGVzJztcclxuaW1wb3J0IHsgUFJFRklYX0NMQVNTIH0gZnJvbSAnLi91dGlsJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXHJcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxyXG4gIHNlbGVjdG9yOiAnY2FsZW5kYXItZm9vdGVyJyxcclxuICBleHBvcnRBczogJ2NhbGVuZGFyRm9vdGVyJyxcclxuICB0ZW1wbGF0ZVVybDonLi9jYWxlbmRhci1mb290ZXIuY29tcG9uZW50Lmh0bWwnLCBcclxufSlcclxuZXhwb3J0IGNsYXNzIENhbGVuZGFyRm9vdGVyQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzLCAgT25EZXN0cm95IHtcclxuICBASW5wdXQoKSBsb2NhbGUhOiBURFNDYWxlbmRhckkxOG5JbnRlcmZhY2U7XHJcbiAgQElucHV0KCkgc2hvd1RvZGF5OiBib29sZWFuID0gZmFsc2U7XHJcbiAgQElucHV0KCkgc2hvd05vdzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIGhhc1RpbWVQaWNrZXI6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBASW5wdXQoKSBpc1JhbmdlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgQElucHV0KCkgbGlzdERhdGUhOiBDb21wYXRpYmxlRGF0ZSB8IFREU1NhZmVBbnk7XHJcblxyXG4gIEBJbnB1dCgpIG9rRGlzYWJsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBASW5wdXQoKSBkaXNhYmxlZERhdGU/OiAoZDogRGF0ZSkgPT4gYm9vbGVhbjtcclxuICBASW5wdXQoKSBleHRyYUZvb3Rlcj86IFRlbXBsYXRlUmVmPHZvaWQ+IHwgc3RyaW5nO1xyXG4gIEBJbnB1dCgpIHJhbmdlUXVpY2tTZWxlY3RvcjogVGVtcGxhdGVSZWY8YW55PiB8IG51bGwgPSBudWxsO1xyXG5cclxuICBAT3V0cHV0KCkgcmVhZG9ubHkgY2xpY2tPayA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuICBAT3V0cHV0KCkgcmVhZG9ubHkgY2xpY2tDYW5jZWwgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcbiAgQE91dHB1dCgpIHJlYWRvbmx5IGNsaWNrVG9kYXkgPSBuZXcgRXZlbnRFbWl0dGVyPENhbmR5RGF0ZT4oKTtcclxuXHJcbiAgcHJlZml4Q2xzOiBzdHJpbmcgPSBQUkVGSVhfQ0xBU1M7XHJcbiAgaXNUZW1wbGF0ZVJlZiA9IGlzVGVtcGxhdGVSZWY7XHJcbiAgaXNOb25FbXB0eVN0cmluZyA9IGlzTm9uRW1wdHlTdHJpbmc7XHJcbiAgaXNUb2RheURpc2FibGVkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgdG9kYXlUaXRsZTogc3RyaW5nID0gJyc7XHJcbiAgcHJpdmF0ZSBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XHJcbiAgc3RhcnREYXRlOnN0cmluZyA9XCJcIjtcclxuICBlbmREYXRlOnN0cmluZz1cIlwiO1xyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0ZUhlbHBlcjogRGF0ZUhlbHBlclNlcnZpY2UsXHJcbiAgICBwdWJsaWMgZGF0ZVBpY2tlclNlcnZpY2U6IERhdGVQaWNrZXJTZXJ2aWNlLCAgICBcclxuICAgICkge31cclxuICAgIFxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgIGNvbnN0IG5vdzogRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBpZiAoY2hhbmdlcy5kaXNhYmxlZERhdGUpIHtcclxuICAgICAgdGhpcy5pc1RvZGF5RGlzYWJsZWQgPSAhISh0aGlzLmRpc2FibGVkRGF0ZSAmJiB0aGlzLmRpc2FibGVkRGF0ZShub3cpKTtcclxuICAgIH1cclxuICAgIGlmIChjaGFuZ2VzLmxvY2FsZSkge1xyXG4gICAgICAvLyBOT1RFOiBDb21wYXQgZm9yIERhdGVQaXBlIGZvcm1hdHRpbmcgcnVsZXNcclxuICAgICAgY29uc3QgZGF0ZUZvcm1hdDogc3RyaW5nID0gdHJhbnNDb21wYXRGb3JtYXQodGhpcy5sb2NhbGUuZGF0ZUZvcm1hdCk7XHJcbiAgICAgIHRoaXMudG9kYXlUaXRsZSA9IHRoaXMuZGF0ZUhlbHBlci5mb3JtYXQobm93LCBkYXRlRm9ybWF0KTtcclxuICAgIH1cclxuICAgIGlmKGNoYW5nZXMubGlzdERhdGUpXHJcbiAgICB7XHJcbiAgICAgIGlmKHRoaXMuaXNSYW5nZSlcclxuICAgICAge1xyXG4gICAgICAgIGNvbnN0IGRhdGVGb3JtYXQ6IHN0cmluZyA9IHRyYW5zQ29tcGF0Rm9ybWF0KHRoaXMubG9jYWxlLmRhdGVGb3JtYXQpO1xyXG4gICAgICAgXHJcbiAgICAgICAgaWYoVERTSGVscGVyT2JqZWN0Lmhhc1ZhbHVlKHRoaXMubGlzdERhdGUpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGxldCBzdGFydERhdGUgPSB0aGlzLmxpc3REYXRlWzBdO1xyXG4gICAgICAgICAgbGV0IGVuZERhdGUgPSB0aGlzLmxpc3REYXRlWzFdO1xyXG4gICAgICAgICAgaWYoVERTSGVscGVyT2JqZWN0Lmhhc1ZhbHVlKHN0YXJ0RGF0ZSkpXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnREYXRlID0gIHRoaXMuZGF0ZUhlbHBlci5mb3JtYXQoc3RhcnREYXRlLm5hdGl2ZURhdGUsIGRhdGVGb3JtYXQpO1xyXG4gICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnREYXRlID1cIlwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYoVERTSGVscGVyT2JqZWN0Lmhhc1ZhbHVlKGVuZERhdGUpKVxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLmVuZERhdGUgPSAgdGhpcy5kYXRlSGVscGVyLmZvcm1hdChlbmREYXRlLm5hdGl2ZURhdGUsIGRhdGVGb3JtYXQpO1xyXG4gICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuZW5kRGF0ZSA9XCJcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgIHRoaXMuc3RhcnREYXRlID1cIlwiO1xyXG4gICAgICAgICAgdGhpcy5lbmREYXRlID1cIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgXHJcbiAgICAgICBcclxuICAgICAgIFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkNsaWNrVG9kYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCBub3c6IENhbmR5RGF0ZSA9IG5ldyBDYW5keURhdGUoKTtcclxuICAgIHRoaXMuY2xpY2tUb2RheS5lbWl0KG5vdy5jbG9uZSgpKTsgLy8gVG8gcHJldmVudCB0aGUgXCJub3dcIiBiZWluZyBtb2RpZmllZCBmcm9tIG91dHNpZGUsIHdlIHVzZSBjbG9uZVxyXG4gIH1cclxuICBvbkNsaWNrQ2FuY2VsKCk6IHZvaWQge1xyXG4gICAgdGhpcy5jbGlja0NhbmNlbC5lbWl0KCk7IC8vIFRvIHByZXZlbnQgdGhlIFwibm93XCIgYmVpbmcgbW9kaWZpZWQgZnJvbSBvdXRzaWRlLCB3ZSB1c2UgY2xvbmVcclxuICB9XHJcbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcclxuICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuICB9XHJcbiBcclxufVxyXG4iLCI8ZGl2IGNsYXNzPVwie3sgcHJlZml4Q2xzIH19LWZvb3RlciB3LWZ1bGwgIGJvcmRlci0wIGJvcmRlci10ICBib3JkZXItbmV1dHJhbC0yLTIwMCBkYXJrOmJvcmRlci1kLW5ldXRyYWwtMi0yMDBcIj5cclxuICAgIDxkaXYgKm5nSWY9XCJleHRyYUZvb3RlclwiIGNsYXNzPVwie3sgcHJlZml4Q2xzIH19LWZvb3Rlci1leHRyYVwiPlxyXG4gICAgICAgIDxuZy1jb250YWluZXIgW25nU3dpdGNoXT1cInRydWVcIj5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwiaXNUZW1wbGF0ZVJlZihleHRyYUZvb3RlcilcIj5cclxuICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCIkYW55KGV4dHJhRm9vdGVyKVwiPjwvbmctY29udGFpbmVyPlxyXG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwiaXNOb25FbXB0eVN0cmluZyhleHRyYUZvb3RlcilcIj5cclxuICAgICAgICAgICAgICAgIDxzcGFuIFtpbm5lckhUTUxdPVwiZXh0cmFGb290ZXJcIj48L3NwYW4+XHJcbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgPC9kaXY+XHJcbiAgICA8ZGl2IGNsYXNzPVwiZmxleCBqdXN0aWZ5LWNlbnRlciBweC00IHB5LTIgdy1mdWxsXCIgKm5nSWY9XCIhaXNSYW5nZVwiPlxyXG4gICAgICAgIDxhIGNsYXNzPVwie3sgcHJlZml4Q2xzIH19LXRvZGF5LWJ0biB7eyBpc1RvZGF5RGlzYWJsZWQgPyBwcmVmaXhDbHMgKyAnLXRvZGF5LWJ0bi1kaXNhYmxlZCcgOiAndGV4dC1wcmltYXJ5LTEnIH19IHRleHQtYm9keS0yIGZvbnQtc2VtaWJvbGQgdXBwZXJjYXNlXCJcclxuICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiIChjbGljayk9XCJpc1RvZGF5RGlzYWJsZWQgPyBudWxsIDogb25DbGlja1RvZGF5KClcIiB0aXRsZT1cInt7IHRvZGF5VGl0bGUgfX1cIj5cclxuICAgICAgICAgICAge3sgbG9jYWxlLnRvZGF5IH19XHJcbiAgICAgICAgPC9hPlxyXG4gICAgPC9kaXY+XHJcbiAgICA8ZGl2IGNsYXNzPVwiZmxleCBqdXN0aWZ5LWVuZCBpdGVtcy1jZW50ZXIgcHgtNCBweS0yIHctZnVsbFwiICpuZ0lmPVwiaXNSYW5nZVwiPlxyXG4gICAgICAgIDxkaXYgKm5nSWY9XCIhaGFzVGltZVBpY2tlciAmJiAoc3RhcnREYXRlIHx8IGVuZERhdGUpXCIgY2xhc3M9XCJweC00XCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IGl0ZW1zLWNlbnRlciB0ZXh0LW5ldXRyYWwtMS00MDBcIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJ0ZXh0LWxnIGxlYWRpbmctNSAgdGRzaS1jYWxlbmRhci1maWxsXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHgtMiB0ZXh0LWJvZHktMiBmb250LXJlZ3VsYXIgdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICAgICAge3tzdGFydERhdGV9fVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dC1ib2R5LTIgZm9udC1yZWd1bGFyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgLVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHgtMiAgdGV4dC1ib2R5LTIgZm9udC1yZWd1bGFyIHRleHQtY2VudGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge3tlbmREYXRlfX1cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwibWwtMlwiPlxyXG4gICAgICAgICAgICA8YnV0dG9uIHRkcy1idXR0b24gY29sb3I9XCJzZWNvbmRhcnlcIiBjbGFzcz1cIm1yLTJcIiAoY2xpY2spPVwib25DbGlja0NhbmNlbCgpXCI+Q2FuY2VsPC9idXR0b24+XHJcbiAgICAgICAgICAgIDxidXR0b24gdGRzLWJ1dHRvbiBjb2xvcj1cInByaW1hcnlcIiAgIFtkaXNhYmxlZF09XCJva0Rpc2FibGVkXCJcclxuICAgICAgICAgICAgKGNsaWNrKT1cIm9rRGlzYWJsZWQgPyBudWxsIDogY2xpY2tPay5lbWl0KClcIj5BcHBseTwvYnV0dG9uPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbjwvZGl2PiJdfQ==