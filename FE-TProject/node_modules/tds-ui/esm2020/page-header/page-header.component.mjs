import { __decorate } from "tslib";
import { ChangeDetectionStrategy, Component, ContentChild, EventEmitter, Input, Optional, Output, ViewEncapsulation } from '@angular/core';
import { Subject } from 'rxjs';
import { map, takeUntil } from 'rxjs/operators';
import { TDSPageHeaderBreadcrumbDirective, TDSPageHeaderFooterDirective } from './page-header-cells';
import { WithConfig } from 'tds-ui/core/config';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "tds-ui/core/config";
import * as i3 from "tds-ui/core/resize-observers";
import * as i4 from "@angular/cdk/bidi";
import * as i5 from "tds-ui/core/outlet";
function TDSPageHeaderComponent_div_3_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelement(1, "span", 9);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const backIcon_r6 = ctx.$implicit;
    const ctx_r5 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngClass", backIcon_r6 || ctx_r5.getBackIcon());
} }
function TDSPageHeaderComponent_div_3_Template(rf, ctx) { if (rf & 1) {
    const _r8 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵlistener("click", function TDSPageHeaderComponent_div_3_Template_div_click_0_listener() { i0.ɵɵrestoreView(_r8); const ctx_r7 = i0.ɵɵnextContext(); return ctx_r7._onBack(); });
    i0.ɵɵelementStart(1, "div", 7);
    i0.ɵɵtemplate(2, TDSPageHeaderComponent_div_3_ng_container_2_Template, 2, 1, "ng-container", 8);
    i0.ɵɵelementEnd()();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("tdsStringTemplateOutlet", ctx_r0.backIcon);
} }
function TDSPageHeaderComponent_span_5_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r9 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(ctx_r9.title);
} }
function TDSPageHeaderComponent_span_5_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 10);
    i0.ɵɵtemplate(1, TDSPageHeaderComponent_span_5_ng_container_1_Template, 2, 1, "ng-container", 8);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("tdsStringTemplateOutlet", ctx_r1.title);
} }
function TDSPageHeaderComponent_ng_content_6_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵprojection(0, 6, ["*ngIf", "!title"]);
} }
function TDSPageHeaderComponent_span_7_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r10 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(ctx_r10.subtitle);
} }
function TDSPageHeaderComponent_span_7_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 11);
    i0.ɵɵtemplate(1, TDSPageHeaderComponent_span_7_ng_container_1_Template, 2, 1, "ng-container", 8);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("tdsStringTemplateOutlet", ctx_r3.subtitle);
} }
function TDSPageHeaderComponent_ng_content_8_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵprojection(0, 7, ["*ngIf", "!subtitle"]);
} }
const _c0 = [[["tds-breadcrumb", "tds-page-header-breadcrumb", ""]], [["tds-avatar", "tds-page-header-avatar", ""]], [["tds-page-header-tags"], ["", "tds-page-header-tags", ""]], [["tds-page-header-extra"], ["", "tds-page-header-extra", ""]], [["tds-page-header-content"], ["", "tds-page-header-content", ""]], [["tds-page-header-footer"], ["", "tds-page-header-footer", ""]], [["tds-page-header-title"], ["", "tds-page-header-title", ""]], [["tds-page-header-subtitle"], ["", "tds-page-header-subtitle", ""]]];
const _c1 = ["tds-breadcrumb[tds-page-header-breadcrumb]", "tds-avatar[tds-page-header-avatar]", "tds-page-header-tags, [tds-page-header-tags]", "tds-page-header-extra, [tds-page-header-extra]", "tds-page-header-content, [tds-page-header-content]", "tds-page-header-footer, [tds-page-header-footer]", "tds-page-header-title, [tds-page-header-title]", "tds-page-header-subtitle, [tds-page-header-subtitle]"];
// const TDS_CONFIG_MODULE_NAME: TDSConfigKey = 'pageHeader';
export class TDSPageHeaderComponent {
    constructor(location, tdsConfigService, elementRef, tdsResizeObserver, cdr, directionality) {
        this.location = location;
        this.tdsConfigService = tdsConfigService;
        this.elementRef = elementRef;
        this.tdsResizeObserver = tdsResizeObserver;
        this.cdr = cdr;
        this.directionality = directionality;
        this.backIcon = null;
        this.ghost = true;
        this.back = new EventEmitter();
        this.compact = false;
        this.destroy$ = new Subject();
        this.dir = 'ltr';
    }
    ngOnInit() {
        this.directionality.change?.pipe(takeUntil(this.destroy$)).subscribe((direction) => {
            this.dir = direction;
            this.cdr.detectChanges();
        });
        this.dir = this.directionality.value;
    }
    ngAfterViewInit() {
        this.tdsResizeObserver
            .observe(this.elementRef)
            .pipe(map(([entry]) => entry.contentRect.width), takeUntil(this.destroy$))
            .subscribe((width) => {
            this.compact = width < 768;
            this.cdr.markForCheck();
        });
    }
    _onBack() {
        if (this.back.observers.length) {
            this.back.emit();
        }
        else {
            if (!this.location) {
                throw new Error(`[TDS] you should import 'RouterModule' or register 'Location' if you want to use 'back' default event!`);
            }
            this.location.back();
        }
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
    getBackIcon() {
        if (this.dir === 'rtl') {
            return 'arrow-right';
        }
        return 'arrow-left';
    }
}
TDSPageHeaderComponent.ɵfac = function TDSPageHeaderComponent_Factory(t) { return new (t || TDSPageHeaderComponent)(i0.ɵɵdirectiveInject(i1.Location, 8), i0.ɵɵdirectiveInject(i2.TDSConfigService), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i3.TDSResizeObserver), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i4.Directionality, 8)); };
TDSPageHeaderComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TDSPageHeaderComponent, selectors: [["tds-page-header"]], contentQueries: function TDSPageHeaderComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        i0.ɵɵcontentQuery(dirIndex, TDSPageHeaderFooterDirective, 5);
        i0.ɵɵcontentQuery(dirIndex, TDSPageHeaderBreadcrumbDirective, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.tdsPageHeaderFooter = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.tdsPageHeaderBreadcrumb = _t.first);
    } }, hostAttrs: [1, "tds-page-header", "w-full", "block"], hostVars: 10, hostBindings: function TDSPageHeaderComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵclassProp("has-footer", ctx.tdsPageHeaderFooter)("tds-page-header-ghost", ctx.ghost)("has-breadcrumb", ctx.tdsPageHeaderBreadcrumb)("tds-page-header-compact", ctx.compact)("tds-page-header-rtl", ctx.dir === "rtl");
    } }, inputs: { backIcon: "backIcon", title: "title", subtitle: "subtitle", ghost: "ghost" }, outputs: { back: "back" }, exportAs: ["tdsPageHeader"], ngContentSelectors: _c1, decls: 13, vars: 5, consts: [[1, "tds-page-header-heading", "flex", "justify-between", "pl-4", "pr-4", "pb-2.5"], [1, "tds-page-header-heading-left", "flex", "items-center"], ["class", "tds-page-header-back", 3, "click", 4, "ngIf"], ["class", "tds-page-header-heading-title text-neutral-1-900 dark:text-d-neutral-1-900 text-header-1 font-semibold pr-3", 4, "ngIf"], [4, "ngIf"], ["class", "tds-page-header-heading-sub-title text-caption-1 font-regular text-neutral-1-400 dark:text-d-neutral-1-400 pr-3", 4, "ngIf"], [1, "tds-page-header-back", 3, "click"], ["role", "button", "tabindex", "0", 1, "tds-page-header-back-button"], [4, "tdsStringTemplateOutlet"], [3, "ngClass"], [1, "tds-page-header-heading-title", "text-neutral-1-900", "dark:text-d-neutral-1-900", "text-header-1", "font-semibold", "pr-3"], [1, "tds-page-header-heading-sub-title", "text-caption-1", "font-regular", "text-neutral-1-400", "dark:text-d-neutral-1-400", "pr-3"]], template: function TDSPageHeaderComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵprojectionDef(_c0);
        i0.ɵɵprojection(0);
        i0.ɵɵelementStart(1, "div", 0)(2, "div", 1);
        i0.ɵɵtemplate(3, TDSPageHeaderComponent_div_3_Template, 3, 1, "div", 2);
        i0.ɵɵprojection(4, 1);
        i0.ɵɵtemplate(5, TDSPageHeaderComponent_span_5_Template, 2, 1, "span", 3);
        i0.ɵɵtemplate(6, TDSPageHeaderComponent_ng_content_6_Template, 1, 0, "ng-content", 4);
        i0.ɵɵtemplate(7, TDSPageHeaderComponent_span_7_Template, 2, 1, "span", 5);
        i0.ɵɵtemplate(8, TDSPageHeaderComponent_ng_content_8_Template, 1, 0, "ng-content", 4);
        i0.ɵɵprojection(9, 2);
        i0.ɵɵelementEnd();
        i0.ɵɵprojection(10, 3);
        i0.ɵɵelementEnd();
        i0.ɵɵprojection(11, 4);
        i0.ɵɵprojection(12, 5);
    } if (rf & 2) {
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("ngIf", ctx.backIcon !== null);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngIf", ctx.title);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", !ctx.title);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.subtitle);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", !ctx.subtitle);
    } }, directives: [i1.NgIf, i5.TDSStringTemplateOutletDirective, i1.NgClass], encapsulation: 2, changeDetection: 0 });
__decorate([
    WithConfig()
], TDSPageHeaderComponent.prototype, "ghost", void 0);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSPageHeaderComponent, [{
        type: Component,
        args: [{
                selector: 'tds-page-header',
                exportAs: 'tdsPageHeader',
                template: `
    <ng-content select="tds-breadcrumb[tds-page-header-breadcrumb]"></ng-content>

    <div class="tds-page-header-heading flex justify-between pl-4 pr-4 pb-2.5">
      <div class="tds-page-header-heading-left flex items-center  ">
        <!--back-->
        <div *ngIf="backIcon !== null" (click)="_onBack()" class="tds-page-header-back">
          <div role="button" tabindex="0" class="tds-page-header-back-button">
            <ng-container *tdsStringTemplateOutlet="backIcon; let backIcon">
              <span [ngClass]="backIcon || getBackIcon()"></span>             
            </ng-container>
          </div>
        </div>
        <!--avatar-->
        <ng-content select="tds-avatar[tds-page-header-avatar]"></ng-content>
        <!--title-->
        <span class="tds-page-header-heading-title text-neutral-1-900 dark:text-d-neutral-1-900 text-header-1 font-semibold pr-3" *ngIf="title">
          <ng-container *tdsStringTemplateOutlet="title">{{ title }}</ng-container>
        </span>
        <ng-content *ngIf="!title" select="tds-page-header-title, [tds-page-header-title]"></ng-content>
        <!--subtitle-->
        <span class="tds-page-header-heading-sub-title text-caption-1 font-regular text-neutral-1-400 dark:text-d-neutral-1-400 pr-3" *ngIf="subtitle">
          <ng-container *tdsStringTemplateOutlet="subtitle">{{ subtitle }}</ng-container>
        </span>
        <ng-content *ngIf="!subtitle" select="tds-page-header-subtitle, [tds-page-header-subtitle]"></ng-content>
        <ng-content select="tds-page-header-tags, [tds-page-header-tags]"></ng-content>
      </div>

      <ng-content select="tds-page-header-extra, [tds-page-header-extra]"></ng-content>
    </div>

    <ng-content select="tds-page-header-content, [tds-page-header-content]"></ng-content>
    <ng-content select="tds-page-header-footer, [tds-page-header-footer]"></ng-content>
  `,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                host: {
                    class: 'tds-page-header w-full block',
                    '[class.has-footer]': 'tdsPageHeaderFooter',
                    '[class.tds-page-header-ghost]': 'ghost',
                    '[class.has-breadcrumb]': 'tdsPageHeaderBreadcrumb',
                    '[class.tds-page-header-compact]': 'compact',
                    '[class.tds-page-header-rtl]': `dir === 'rtl'`,
                }
            }]
    }], function () { return [{ type: i1.Location, decorators: [{
                type: Optional
            }] }, { type: i2.TDSConfigService }, { type: i0.ElementRef }, { type: i3.TDSResizeObserver }, { type: i0.ChangeDetectorRef }, { type: i4.Directionality, decorators: [{
                type: Optional
            }] }]; }, { backIcon: [{
            type: Input
        }], title: [{
            type: Input
        }], subtitle: [{
            type: Input
        }], ghost: [{
            type: Input
        }], back: [{
            type: Output
        }], tdsPageHeaderFooter: [{
            type: ContentChild,
            args: [TDSPageHeaderFooterDirective, { static: false }]
        }], tdsPageHeaderBreadcrumb: [{
            type: ContentChild,
            args: [TDSPageHeaderBreadcrumbDirective, { static: false }]
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS1oZWFkZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvdGRzLXVpL3BhZ2UtaGVhZGVyL3BhZ2UtaGVhZGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsT0FBTyxFQUVMLHVCQUF1QixFQUV2QixTQUFTLEVBQ1QsWUFBWSxFQUVaLFlBQVksRUFDWixLQUFLLEVBR0wsUUFBUSxFQUNSLE1BQU0sRUFFTixpQkFBaUIsRUFDbEIsTUFBTSxlQUFlLENBQUM7QUFJdkIsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMvQixPQUFPLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxnQ0FBZ0MsRUFBRSw0QkFBNEIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3JHLE9BQU8sRUFBb0IsVUFBVSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7Ozs7Ozs7O0lBaUJ0RCw2QkFBZ0U7SUFDOUQsMEJBQW1EO0lBQ3JELDBCQUFlOzs7O0lBRFAsZUFBcUM7SUFBckMsNkRBQXFDOzs7O0lBSGpELDhCQUFnRjtJQUFqRCxnS0FBUyxnQkFBUyxJQUFDO0lBQ2hELDhCQUFvRTtJQUNsRSwrRkFFZTtJQUNqQixpQkFBTSxFQUFBOzs7SUFIVyxlQUFtQztJQUFuQyx5REFBbUM7OztJQVNwRCw2QkFBK0M7SUFBQSxZQUFXO0lBQUEsMEJBQWU7OztJQUExQixlQUFXO0lBQVgsa0NBQVc7OztJQUQ1RCxnQ0FBd0k7SUFDdEksZ0dBQXlFO0lBQzNFLGlCQUFPOzs7SUFEVSxlQUE4QjtJQUE5QixzREFBOEI7OztJQUUvQywwQ0FBZ0c7OztJQUc5Riw2QkFBa0Q7SUFBQSxZQUFjO0lBQUEsMEJBQWU7OztJQUE3QixlQUFjO0lBQWQsc0NBQWM7OztJQURsRSxnQ0FBK0k7SUFDN0ksZ0dBQStFO0lBQ2pGLGlCQUFPOzs7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QWZ0ZXJWaWV3SW5pdCxcclxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcclxuICBDaGFuZ2VEZXRlY3RvclJlZixcclxuICBDb21wb25lbnQsXHJcbiAgQ29udGVudENoaWxkLFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIElucHV0LFxyXG4gIE9uRGVzdHJveSxcclxuICBPbkluaXQsXHJcbiAgT3B0aW9uYWwsXHJcbiAgT3V0cHV0LFxyXG4gIFRlbXBsYXRlUmVmLFxyXG4gIFZpZXdFbmNhcHN1bGF0aW9uXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5pbXBvcnQgeyBEaXJlY3Rpb24sIERpcmVjdGlvbmFsaXR5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2JpZGknO1xyXG5pbXBvcnQgeyBMb2NhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbWFwLCB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFREU1BhZ2VIZWFkZXJCcmVhZGNydW1iRGlyZWN0aXZlLCBURFNQYWdlSGVhZGVyRm9vdGVyRGlyZWN0aXZlIH0gZnJvbSAnLi9wYWdlLWhlYWRlci1jZWxscyc7XHJcbmltcG9ydCB7IFREU0NvbmZpZ1NlcnZpY2UsIFdpdGhDb25maWcgfSBmcm9tICd0ZHMtdWkvY29yZS9jb25maWcnO1xyXG5pbXBvcnQgeyBURFNSZXNpemVPYnNlcnZlciB9IGZyb20gJ3Rkcy11aS9jb3JlL3Jlc2l6ZS1vYnNlcnZlcnMnO1xyXG5cclxuXHJcbi8vIGNvbnN0IFREU19DT05GSUdfTU9EVUxFX05BTUU6IFREU0NvbmZpZ0tleSA9ICdwYWdlSGVhZGVyJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAndGRzLXBhZ2UtaGVhZGVyJyxcclxuICBleHBvcnRBczogJ3Rkc1BhZ2VIZWFkZXInLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8bmctY29udGVudCBzZWxlY3Q9XCJ0ZHMtYnJlYWRjcnVtYlt0ZHMtcGFnZS1oZWFkZXItYnJlYWRjcnVtYl1cIj48L25nLWNvbnRlbnQ+XHJcblxyXG4gICAgPGRpdiBjbGFzcz1cInRkcy1wYWdlLWhlYWRlci1oZWFkaW5nIGZsZXgganVzdGlmeS1iZXR3ZWVuIHBsLTQgcHItNCBwYi0yLjVcIj5cclxuICAgICAgPGRpdiBjbGFzcz1cInRkcy1wYWdlLWhlYWRlci1oZWFkaW5nLWxlZnQgZmxleCBpdGVtcy1jZW50ZXIgIFwiPlxyXG4gICAgICAgIDwhLS1iYWNrLS0+XHJcbiAgICAgICAgPGRpdiAqbmdJZj1cImJhY2tJY29uICE9PSBudWxsXCIgKGNsaWNrKT1cIl9vbkJhY2soKVwiIGNsYXNzPVwidGRzLXBhZ2UtaGVhZGVyLWJhY2tcIj5cclxuICAgICAgICAgIDxkaXYgcm9sZT1cImJ1dHRvblwiIHRhYmluZGV4PVwiMFwiIGNsYXNzPVwidGRzLXBhZ2UtaGVhZGVyLWJhY2stYnV0dG9uXCI+XHJcbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKnRkc1N0cmluZ1RlbXBsYXRlT3V0bGV0PVwiYmFja0ljb247IGxldCBiYWNrSWNvblwiPlxyXG4gICAgICAgICAgICAgIDxzcGFuIFtuZ0NsYXNzXT1cImJhY2tJY29uIHx8IGdldEJhY2tJY29uKClcIj48L3NwYW4+ICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwhLS1hdmF0YXItLT5cclxuICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJ0ZHMtYXZhdGFyW3Rkcy1wYWdlLWhlYWRlci1hdmF0YXJdXCI+PC9uZy1jb250ZW50PlxyXG4gICAgICAgIDwhLS10aXRsZS0tPlxyXG4gICAgICAgIDxzcGFuIGNsYXNzPVwidGRzLXBhZ2UtaGVhZGVyLWhlYWRpbmctdGl0bGUgdGV4dC1uZXV0cmFsLTEtOTAwIGRhcms6dGV4dC1kLW5ldXRyYWwtMS05MDAgdGV4dC1oZWFkZXItMSBmb250LXNlbWlib2xkIHByLTNcIiAqbmdJZj1cInRpdGxlXCI+XHJcbiAgICAgICAgICA8bmctY29udGFpbmVyICp0ZHNTdHJpbmdUZW1wbGF0ZU91dGxldD1cInRpdGxlXCI+e3sgdGl0bGUgfX08L25nLWNvbnRhaW5lcj5cclxuICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgPG5nLWNvbnRlbnQgKm5nSWY9XCIhdGl0bGVcIiBzZWxlY3Q9XCJ0ZHMtcGFnZS1oZWFkZXItdGl0bGUsIFt0ZHMtcGFnZS1oZWFkZXItdGl0bGVdXCI+PC9uZy1jb250ZW50PlxyXG4gICAgICAgIDwhLS1zdWJ0aXRsZS0tPlxyXG4gICAgICAgIDxzcGFuIGNsYXNzPVwidGRzLXBhZ2UtaGVhZGVyLWhlYWRpbmctc3ViLXRpdGxlIHRleHQtY2FwdGlvbi0xIGZvbnQtcmVndWxhciB0ZXh0LW5ldXRyYWwtMS00MDAgZGFyazp0ZXh0LWQtbmV1dHJhbC0xLTQwMCBwci0zXCIgKm5nSWY9XCJzdWJ0aXRsZVwiPlxyXG4gICAgICAgICAgPG5nLWNvbnRhaW5lciAqdGRzU3RyaW5nVGVtcGxhdGVPdXRsZXQ9XCJzdWJ0aXRsZVwiPnt7IHN1YnRpdGxlIH19PC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgIDxuZy1jb250ZW50ICpuZ0lmPVwiIXN1YnRpdGxlXCIgc2VsZWN0PVwidGRzLXBhZ2UtaGVhZGVyLXN1YnRpdGxlLCBbdGRzLXBhZ2UtaGVhZGVyLXN1YnRpdGxlXVwiPjwvbmctY29udGVudD5cclxuICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJ0ZHMtcGFnZS1oZWFkZXItdGFncywgW3Rkcy1wYWdlLWhlYWRlci10YWdzXVwiPjwvbmctY29udGVudD5cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJ0ZHMtcGFnZS1oZWFkZXItZXh0cmEsIFt0ZHMtcGFnZS1oZWFkZXItZXh0cmFdXCI+PC9uZy1jb250ZW50PlxyXG4gICAgPC9kaXY+XHJcblxyXG4gICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwidGRzLXBhZ2UtaGVhZGVyLWNvbnRlbnQsIFt0ZHMtcGFnZS1oZWFkZXItY29udGVudF1cIj48L25nLWNvbnRlbnQ+XHJcbiAgICA8bmctY29udGVudCBzZWxlY3Q9XCJ0ZHMtcGFnZS1oZWFkZXItZm9vdGVyLCBbdGRzLXBhZ2UtaGVhZGVyLWZvb3Rlcl1cIj48L25nLWNvbnRlbnQ+XHJcbiAgYCxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gIGhvc3Q6IHtcclxuICAgIGNsYXNzOiAndGRzLXBhZ2UtaGVhZGVyIHctZnVsbCBibG9jaycsXHJcbiAgICAnW2NsYXNzLmhhcy1mb290ZXJdJzogJ3Rkc1BhZ2VIZWFkZXJGb290ZXInLFxyXG4gICAgJ1tjbGFzcy50ZHMtcGFnZS1oZWFkZXItZ2hvc3RdJzogJ2dob3N0JyxcclxuICAgICdbY2xhc3MuaGFzLWJyZWFkY3J1bWJdJzogJ3Rkc1BhZ2VIZWFkZXJCcmVhZGNydW1iJyxcclxuICAgICdbY2xhc3MudGRzLXBhZ2UtaGVhZGVyLWNvbXBhY3RdJzogJ2NvbXBhY3QnLFxyXG4gICAgJ1tjbGFzcy50ZHMtcGFnZS1oZWFkZXItcnRsXSc6IGBkaXIgPT09ICdydGwnYCxcclxuICAgIFxyXG4gIH1cclxufSlcclxuZXhwb3J0IGNsYXNzIFREU1BhZ2VIZWFkZXJDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3ksIE9uSW5pdCB7XHJcblxyXG4gIEBJbnB1dCgpIGJhY2tJY29uOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjx2b2lkPiB8IG51bGwgPSBudWxsO1xyXG4gIEBJbnB1dCgpIHRpdGxlPzogc3RyaW5nIHwgVGVtcGxhdGVSZWY8dm9pZD47XHJcbiAgQElucHV0KCkgc3VidGl0bGU/OiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjx2b2lkPjtcclxuICBASW5wdXQoKSBAV2l0aENvbmZpZygpIGdob3N0OiBib29sZWFuID0gdHJ1ZTtcclxuICBAT3V0cHV0KCkgcmVhZG9ubHkgYmFjayA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuXHJcbiAgQENvbnRlbnRDaGlsZChURFNQYWdlSGVhZGVyRm9vdGVyRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSkgdGRzUGFnZUhlYWRlckZvb3Rlcj86IEVsZW1lbnRSZWY8VERTUGFnZUhlYWRlckZvb3RlckRpcmVjdGl2ZT47XHJcbiAgQENvbnRlbnRDaGlsZChURFNQYWdlSGVhZGVyQnJlYWRjcnVtYkRpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pIHRkc1BhZ2VIZWFkZXJCcmVhZGNydW1iPzogRWxlbWVudFJlZjxURFNQYWdlSGVhZGVyQnJlYWRjcnVtYkRpcmVjdGl2ZT47XHJcblxyXG4gIGNvbXBhY3QgPSBmYWxzZTtcclxuICBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XHJcbiAgZGlyOiBEaXJlY3Rpb24gPSAnbHRyJztcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGxvY2F0aW9uOiBMb2NhdGlvbixcclxuICAgIHB1YmxpYyB0ZHNDb25maWdTZXJ2aWNlOiBURFNDb25maWdTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxyXG4gICAgcHJpdmF0ZSB0ZHNSZXNpemVPYnNlcnZlcjogVERTUmVzaXplT2JzZXJ2ZXIsXHJcbiAgICBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGRpcmVjdGlvbmFsaXR5OiBEaXJlY3Rpb25hbGl0eVxyXG4gICkge31cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpcmVjdGlvbmFsaXR5LmNoYW5nZT8ucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpLnN1YnNjcmliZSgoZGlyZWN0aW9uOiBEaXJlY3Rpb24pID0+IHtcclxuICAgICAgdGhpcy5kaXIgPSBkaXJlY3Rpb247XHJcbiAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuZGlyID0gdGhpcy5kaXJlY3Rpb25hbGl0eS52YWx1ZTtcclxuICB9XHJcblxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMudGRzUmVzaXplT2JzZXJ2ZXJcclxuICAgICAgLm9ic2VydmUodGhpcy5lbGVtZW50UmVmKVxyXG4gICAgICAucGlwZShcclxuICAgICAgICBtYXAoKFtlbnRyeV0pID0+IGVudHJ5LmNvbnRlbnRSZWN0LndpZHRoKSxcclxuICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgKVxyXG4gICAgICAuc3Vic2NyaWJlKCh3aWR0aDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jb21wYWN0ID0gd2lkdGggPCA3Njg7XHJcbiAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX29uQmFjaygpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmJhY2sub2JzZXJ2ZXJzLmxlbmd0aCkge1xyXG4gICAgICB0aGlzLmJhY2suZW1pdCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKCF0aGlzLmxvY2F0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbVERTXSB5b3Ugc2hvdWxkIGltcG9ydCAnUm91dGVyTW9kdWxlJyBvciByZWdpc3RlciAnTG9jYXRpb24nIGlmIHlvdSB3YW50IHRvIHVzZSAnYmFjaycgZGVmYXVsdCBldmVudCFgKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmxvY2F0aW9uLmJhY2soKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgdGhpcy5kZXN0cm95JC5uZXh0KCk7XHJcbiAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XHJcbiAgfVxyXG5cclxuICBnZXRCYWNrSWNvbigpOiBzdHJpbmcge1xyXG4gICAgaWYgKHRoaXMuZGlyID09PSAncnRsJykge1xyXG4gICAgICByZXR1cm4gJ2Fycm93LXJpZ2h0JztcclxuICAgIH1cclxuICAgIHJldHVybiAnYXJyb3ctbGVmdCc7XHJcbiAgfVxyXG59XHJcbiJdfQ==