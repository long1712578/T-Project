import { Component, ChangeDetectionStrategy, Input, ViewChild, Output, EventEmitter } from "@angular/core";
import { mixinDisabled } from "tds-ui/shared/common";
import { TDSButtonMenuTrigger } from "tds-ui/button-menu";
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "tds-ui/button-menu";
const _c0 = ["button"];
const _c1 = [[["", 8, "js-label"]], [["", 8, "js-content"]]];
const _c2 = function (a0) { return { "opacity-65": a0 }; };
const _c3 = [".js-label", ".js-content"];
class TAButtonSplitBase {
    constructor(_elementRef) {
        this._elementRef = _elementRef;
    }
}
const _TButtonSplitMixinBase = mixinDisabled(TAButtonSplitBase);
export class TDSButtonSplit extends _TButtonSplitMixinBase {
    constructor(elementRef) {
        super(elementRef);
        this.defaultColor = "primary";
        this._size = "md";
        this.listClassLabel = [];
        this.listClassButton = [];
        this.clickButton = new EventEmitter();
        this.disabled = false;
        this.color = this.defaultColor;
    }
    get color() {
        return this._color;
    }
    set color(val) {
        this._color = val;
        this.p_UpdateClass();
    }
    get size() {
        return this._size;
    }
    set size(val) {
        this._size = val;
        this.p_UpdateClass();
    }
    ngOnChanges(changes) {
        const { disabled } = changes;
        if (disabled) {
            this.p_UpdateClass();
        }
    }
    p_UpdateClass() {
        const color = {
            'bg-primary-1': this.color == 'primary',
            'border-primary-1': this.color == 'primary',
            'ring-primary-1': true,
            'hover:border-primary-2 hover:bg-primary-2 focus:bg-primary-1': this.color == 'primary' && !this.disabled,
            'text-white': this.color == 'primary',
            'disabled:cursor-not-allowed': true,
            'disabled:bg-primary-1': this.color == 'primary',
            'bg-white border-neutral-2-200 text-neutral-1-900 dark:bg-d-neutral-3-300 dark:border-d-neutral-2-200 dark:text-d-neutral-1-900': this.color == "secondary",
            'hover:bg-neutral-3-50  focus:bg-neutral-3-50 focus:border-primary-2 dark:focus:border-primary-2 dark:hover:bg-d-neutral-3-50  dark:focus:bg-d-neutral-3-50': this.color == "secondary" && !this.disabled,
        };
        this.ngClsButton = {
            "p-1": this.size == 'sm',
            "p-1.5": this.size == 'md',
            "p-2": this.size == 'lg',
            ...color
        };
        this.ngClsLabel = {
            "py-1": this.size == 'sm',
            "px-2.5": this.size == 'sm',
            "py-1.5": this.size == 'md',
            "px-3": this.size == 'md' || this.size == 'lg',
            "py-2": this.size == 'lg',
            ...color
        };
    }
    _getHostElement() {
        return this._elementRef.nativeElement;
    }
    // private p_getClassBySize(): { listClassButton: Array<string>, listClassLabel: Array<string>, } {
    //     let result: { listClassButton: Array<string>, listClassLabel: Array<string>, } = { listClassButton: [], listClassLabel: [] }
    //     switch (this.size) {
    //         case "sm":
    //             result.listClassButton = ["p-1"];
    //             result.listClassLabel = ["py-1", " px-2.5"];
    //             break;
    //         case "lg":
    //             result.listClassButton = ["p-2"];
    //             // result.listClassLabel = ["py-2", " px-3"];
    //             break;
    //         default:
    //             result.listClassButton = ["p-1.5"];
    //             result.listClassLabel = ["py-1.5", " px-3"];
    //             break;
    //     }
    //     return result;
    // }
    // private p_getClassByColor() {
    //     let result: { listClassButton: Array<string>, listClassLabel: Array<string> } = { listClassButton: [], listClassLabel: [] };
    //     switch (this.color) {
    //         case "primary":
    //             result.listClassButton = ['bg-primary-1', 'border-primary-1', 'ring-primary-1', 'hover:border-primary-2', 'hover:bg-primary-2', 'focus:bg-primary-1', 'text-white', 'disabled:cursor-default', 'disabled:bg-primary-1'];
    //             // result.listClassLabel = ['border-primary-1', 'bg-primary-1','focus:ring', 'ring-primary-1', 'text-white', 'hover:border-primary-2', 'hover:bg-primary-2', 'focus:bg-primary-1','ring-opacity-20'];
    //             break;
    //         case "secondary":
    //             result.listClassButton = ['hover:bg-neutral-3-50 ', 'bg-white', 'border-neutral-2-200', 'ring-primary-1', 'group-hover:bg-neutral-3-50 ', 'focus:bg-white', 'disabled:cursor-default', 'text-neutral-1-900', 'focus:border-primary-2'];
    //             // result.listClassLabel = ['bg-white', 'border-neutral-2-200', 'ring-primary-1', 'group-hover:bg-neutral-3-50 ', 'focus:bg-white', 'disabled:cursor-default', 'text-neutral-1-900', 'focus:border-primary-2','ring-opacity-20'];
    //             break;
    //         default:
    //             // result = ['text-white',`ring-${color}-400`,`border-${color}-400` ,`bg-${color}-400`, `hover:bg-${color}-500`, `focus:bg-${color}-400`];
    //             break;
    //     }
    //     return result;
    // }
    onClickLabel(event) {
        if (!this.disabled) {
            this.clickButton.emit(event);
        }
        else {
            event.preventDefault();
            event.stopImmediatePropagation();
        }
    }
    onClickDropdown(event) {
        if (!this.disabled) {
            this.trigger.openMenu();
        }
        else {
            event.preventDefault();
            event.stopImmediatePropagation();
        }
    }
}
TDSButtonSplit.ɵfac = function TDSButtonSplit_Factory(t) { return new (t || TDSButtonSplit)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
TDSButtonSplit.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TDSButtonSplit, selectors: [["tds-button-split"]], viewQuery: function TDSButtonSplit_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(TDSButtonMenuTrigger, 5);
        i0.ɵɵviewQuery(_c0, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.trigger = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.buttonElement = _t.first);
    } }, hostAttrs: [1, "inline-block"], hostVars: 8, hostBindings: function TDSButtonSplit_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵhostProperty("disabled", ctx.disabled || null);
        i0.ɵɵattribute("tabindex", ctx.disabled ? -1 : ctx.tabIndex || 0);
        i0.ɵɵclassProp("disabled:opacity-65", ctx.disabled)("cursor-not-allowed", ctx.disabled)("cursor-pointer", !ctx.disabled);
    } }, inputs: { disabled: "disabled", color: "color", size: "size" }, outputs: { clickButton: "clickButton" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], ngContentSelectors: _c3, decls: 9, vars: 9, consts: [[1, "flex", "justify-between", "items-stretch", "text-body-2", "rounded-md", "font-semibold", "text-neutral-1-900", "dark:text-d-neutral-1-900", "dark:bg-d-neutral-3-300", 3, "ngClass"], [1, "flex", "items-center", "border", "rounded-l-md", "border-r-0", "disabled:opacity-65", "focus:outline-none", "box-border", "ring-opacity-20", "focus:ring", "ring-primary-1", 3, "disabled", "ngClass", "click"], [1, "flex", "items-center", "rounded-l-none", "border", "rounded-r-md", "disabled:opacity-65", "focus:outline-none", "box-border", "ring-opacity-20", "focus:ring", "ring-primary-1", 3, "tdsbuttonMenuTriggerFor", "tbuttonMenuTriggerRestoreFocus", "ngClass", "disabled", "click"], ["button", ""], [1, "text-xl", "tdsi-arrow-down-fill", "leading-none"], ["menu", "TDSButtonMenu"]], template: function TDSButtonSplit_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵprojectionDef(_c1);
        i0.ɵɵelementStart(0, "div", 0)(1, "button", 1);
        i0.ɵɵlistener("click", function TDSButtonSplit_Template_button_click_1_listener($event) { return ctx.onClickLabel($event); });
        i0.ɵɵprojection(2);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(3, "button", 2, 3);
        i0.ɵɵlistener("click", function TDSButtonSplit_Template_button_click_3_listener($event) { return ctx.onClickDropdown($event); });
        i0.ɵɵelement(5, "i", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(6, "tbutton-menu", null, 5);
        i0.ɵɵprojection(8, 1);
        i0.ɵɵelementEnd()();
    } if (rf & 2) {
        const _r1 = i0.ɵɵreference(7);
        i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction1(7, _c2, ctx.disabled));
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("disabled", ctx.disabled)("ngClass", ctx.ngClsLabel);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("tdsbuttonMenuTriggerFor", _r1)("tbuttonMenuTriggerRestoreFocus", false)("ngClass", ctx.ngClsButton)("disabled", ctx.disabled);
    } }, directives: [i1.NgClass, i2.TDSButtonMenuTrigger, i2.TDSButtonMenu], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSButtonSplit, [{
        type: Component,
        args: [{ selector: 'tds-button-split', host: {
                    '[attr.tabindex]': 'disabled ? -1 : (tabIndex || 0)',
                    '[disabled]': 'disabled ||  null',
                    '[class.disabled:opacity-65]': 'disabled',
                    '[class.cursor-not-allowed]': 'disabled',
                    '[class.cursor-pointer]': '!disabled',
                    class: 'inline-block',
                }, changeDetection: ChangeDetectionStrategy.OnPush, template: "<div class=\"flex justify-between items-stretch text-body-2 rounded-md font-semibold text-neutral-1-900 dark:text-d-neutral-1-900 dark:bg-d-neutral-3-300\" [ngClass]=\"{'opacity-65':disabled}\">\r\n    <button class=\"flex items-center border rounded-l-md  border-r-0 disabled:opacity-65 focus:outline-none  box-border ring-opacity-20  focus:ring  ring-primary-1\"  [disabled]=\"disabled\"  [ngClass]=\"ngClsLabel\"\r\n    \r\n    (click)=\"onClickLabel($event)\">\r\n        <ng-content select=\".js-label\"></ng-content>\r\n    </button>\r\n    <button #button (click)=\"onClickDropdown($event)\"\r\n        class=\" flex items-center rounded-l-none border rounded-r-md disabled:opacity-65  focus:outline-none  box-border ring-opacity-20  focus:ring  ring-primary-1\"\r\n        [tdsbuttonMenuTriggerFor]=\"menu\" [tbuttonMenuTriggerRestoreFocus]=\"false\"  [ngClass]=\"ngClsButton\" [disabled]=\"disabled\">      \r\n        <i class=\"text-xl tdsi-arrow-down-fill leading-none\"></i>\r\n    </button>\r\n    <tbutton-menu #menu=\"TDSButtonMenu\">       \r\n        <ng-content select=\".js-content\"></ng-content>\r\n    </tbutton-menu>\r\n</div>" }]
    }], function () { return [{ type: i0.ElementRef }]; }, { clickButton: [{
            type: Output
        }], trigger: [{
            type: ViewChild,
            args: [TDSButtonMenuTrigger]
        }], buttonElement: [{
            type: ViewChild,
            args: ['button']
        }], disabled: [{
            type: Input,
            args: ["disabled"]
        }], color: [{
            type: Input,
            args: ["color"]
        }], size: [{
            type: Input,
            args: ["size"]
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnV0dG9uLXNwbGl0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvdGRzLXVpL2J1dHR0b24tc3BsaXQvYnV0dG9uLXNwbGl0LnRzIiwiLi4vLi4vLi4vLi4vcHJvamVjdHMvdGRzLXVpL2J1dHR0b24tc3BsaXQvYnV0dG9uLXNwbGl0Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSx1QkFBdUIsRUFBYyxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBQ2pKLE9BQU8sRUFBOEIsYUFBYSxFQUFtQixNQUFNLHNCQUFzQixDQUFDO0FBRWxHLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLG9CQUFvQixDQUFDOzs7Ozs7OztBQUMxRCxNQUFNLGlCQUFpQjtJQUNuQixZQUFtQixXQUF1QjtRQUF2QixnQkFBVyxHQUFYLFdBQVcsQ0FBWTtJQUFJLENBQUM7Q0FDbEQ7QUFFRCxNQUFNLHNCQUFzQixHQUNHLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBaUJoRSxNQUFNLE9BQU8sY0FBZSxTQUFRLHNCQUFzQjtJQTRCdEQsWUFBWSxVQUFzQjtRQUU5QixLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7UUE3QnRCLGlCQUFZLEdBQW9CLFNBQVMsQ0FBQTtRQUVqQyxVQUFLLEdBQWUsSUFBSSxDQUFDO1FBQzFCLG1CQUFjLEdBQWtCLEVBQUUsQ0FBQztRQUNuQyxvQkFBZSxHQUFrQixFQUFFLENBQUM7UUFDeEIsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBYyxDQUFDO1FBRzdDLGFBQVEsR0FBWSxLQUFLLENBQUM7UUFzQnpDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQztJQUNuQyxDQUFDO0lBcEJELElBQ0ksS0FBSztRQUNMLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUN2QixDQUFD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QixDQUFDLE1BQU07NkRBUzVCLFdBQVc7a0JBQTdCLE1BQU07WUFDMEIsT0FBTztrQkFBdkMsU0FBUzttQkFBQyxvQkFBb0I7WUFDVixhQUFhO2tCQUFqQyxTQUFTO21CQUFDLFFBQVE7WUFDQSxRQUFRO2tCQUExQixLQUFLO21CQUFDLFVBQVU7WUFJYixLQUFLO2tCQURSLEtBQUs7bUJBQUMsT0FBTztZQVNWLElBQUk7a0JBRFAsS0FBSzttQkFBQyxNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgRWxlbWVudFJlZiwgSW5wdXQsIFZpZXdDaGlsZCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcyB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IENhbkRpc2FibGUsIENhbkRpc2FibGVDdG9yLCBtaXhpbkRpc2FibGVkLCBURFNUaGVtZVBhbGV0dGUgfSBmcm9tIFwidGRzLXVpL3NoYXJlZC9jb21tb25cIjtcclxuaW1wb3J0IHsgQnV0dG9uU2l6ZSwgTmdDbGFzc0ludGVyZmFjZSB9IGZyb20gXCJ0ZHMtdWkvY29yZS9jb25maWdcIjtcclxuaW1wb3J0IHsgVERTQnV0dG9uTWVudVRyaWdnZXIgfSBmcm9tIFwidGRzLXVpL2J1dHRvbi1tZW51XCI7XHJcbmNsYXNzIFRBQnV0dG9uU3BsaXRCYXNlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBfZWxlbWVudFJlZjogRWxlbWVudFJlZikgeyB9XHJcbn1cclxuXHJcbmNvbnN0IF9UQnV0dG9uU3BsaXRNaXhpbkJhc2U6IENhbkRpc2FibGVDdG9yICZcclxuICAgIHR5cGVvZiBUQUJ1dHRvblNwbGl0QmFzZSA9IG1peGluRGlzYWJsZWQoVEFCdXR0b25TcGxpdEJhc2UpO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3Rkcy1idXR0b24tc3BsaXQnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2J1dHRvbi1zcGxpdC5odG1sJyxcclxuICAgIGhvc3Q6IHtcclxuICAgICAgICAnW2F0dHIudGFiaW5kZXhdJzogJ2Rpc2FibGVkID8gLTEgOiAodGFiSW5kZXggfHwgMCknLFxyXG4gICAgICAgICdbZGlzYWJsZWRdJzogJ2Rpc2FibGVkIHx8ICBudWxsJyxcclxuICAgICAgICAnW2NsYXNzLmRpc2FibGVkOm9wYWNpdHktNjVdJzogJ2Rpc2FibGVkJyxcclxuICAgICAgICAnW2NsYXNzLmN1cnNvci1ub3QtYWxsb3dlZF0nOiAnZGlzYWJsZWQnLFxyXG4gICAgICAgICdbY2xhc3MuY3Vyc29yLXBvaW50ZXJdJzogJyFkaXNhYmxlZCcsXHJcbiAgICAgICAgY2xhc3M6ICdpbmxpbmUtYmxvY2snLFxyXG4gICAgfSxcclxuXHJcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFREU0J1dHRvblNwbGl0IGV4dGVuZHMgX1RCdXR0b25TcGxpdE1peGluQmFzZSBpbXBsZW1lbnRzIENhbkRpc2FibGUsIE9uQ2hhbmdlcyB7XHJcbiAgICBkZWZhdWx0Q29sb3I6IFREU1RoZW1lUGFsZXR0ZSA9IFwicHJpbWFyeVwiXHJcbiAgICBwcml2YXRlIF9jb2xvcjogVERTVGhlbWVQYWxldHRlO1xyXG4gICAgcHJpdmF0ZSBfc2l6ZTogQnV0dG9uU2l6ZSA9IFwibWRcIjtcclxuICAgIHB1YmxpYyBsaXN0Q2xhc3NMYWJlbDogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG4gICAgcHVibGljIGxpc3RDbGFzc0J1dHRvbjogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG4gICAgQE91dHB1dCgpIHJlYWRvbmx5IGNsaWNrQnV0dG9uID0gbmV3IEV2ZW50RW1pdHRlcjxNb3VzZUV2ZW50PigpO1xyXG4gICAgQFZpZXdDaGlsZChURFNCdXR0b25NZW51VHJpZ2dlcikgdHJpZ2dlciE6IFREU0J1dHRvbk1lbnVUcmlnZ2VyO1xyXG4gICAgQFZpZXdDaGlsZCgnYnV0dG9uJykgYnV0dG9uRWxlbWVudCE6IEVsZW1lbnRSZWY7XHJcbiAgICBASW5wdXQoXCJkaXNhYmxlZFwiKSBkaXNhYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgbmdDbHNCdXR0b24hOiBOZ0NsYXNzSW50ZXJmYWNlO1xyXG4gICAgbmdDbHNMYWJlbCE6IE5nQ2xhc3NJbnRlcmZhY2U7XHJcbiAgICBASW5wdXQoXCJjb2xvclwiKVxyXG4gICAgZ2V0IGNvbG9yKCk6IFREU1RoZW1lUGFsZXR0ZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbG9yO1xyXG4gICAgfVxyXG4gICAgc2V0IGNvbG9yKHZhbDogVERTVGhlbWVQYWxldHRlKSB7XHJcbiAgICAgICAgdGhpcy5fY29sb3IgPSB2YWw7XHJcbiAgICAgICAgdGhpcy5wX1VwZGF0ZUNsYXNzKCk7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoXCJzaXplXCIpXHJcbiAgICBnZXQgc2l6ZSgpOiBCdXR0b25TaXplIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2l6ZTtcclxuICAgIH1cclxuICAgIHNldCBzaXplKHZhbDogQnV0dG9uU2l6ZSkge1xyXG4gICAgICAgIHRoaXMuX3NpemUgPSB2YWw7XHJcbiAgICAgICAgdGhpcy5wX1VwZGF0ZUNsYXNzKCk7XHJcbiAgICB9XHJcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50UmVmOiBFbGVtZW50UmVmXHJcbiAgICApIHtcclxuICAgICAgICBzdXBlcihlbGVtZW50UmVmKTtcclxuICAgICAgICB0aGlzLmNvbG9yID0gdGhpcy5kZWZhdWx0Q29sb3I7XHJcbiAgICB9XHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgeyBkaXNhYmxlZCB9ID0gY2hhbmdlcztcclxuICAgICAgICBpZiAoZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5wX1VwZGF0ZUNsYXNzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBwX1VwZGF0ZUNsYXNzKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbG9yID0ge1xyXG4gICAgICAgICAgICAnYmctcHJpbWFyeS0xJzogdGhpcy5jb2xvciA9PSAncHJpbWFyeScsXHJcbiAgICAgICAgICAgICdib3JkZXItcHJpbWFyeS0xJzogdGhpcy5jb2xvciA9PSAncHJpbWFyeScsXHJcbiAgICAgICAgICAgICdyaW5nLXByaW1hcnktMSc6IHRydWUsXHJcbiAgICAgICAgICAgICdob3Zlcjpib3JkZXItcHJpbWFyeS0yIGhvdmVyOmJnLXByaW1hcnktMiBmb2N1czpiZy1wcmltYXJ5LTEnOiB0aGlzLmNvbG9yID09ICdwcmltYXJ5JyAmJiAhdGhpcy5kaXNhYmxlZCxcclxuICAgICAgICAgICAgJ3RleHQtd2hpdGUnOiB0aGlzLmNvbG9yID09ICdwcmltYXJ5JyxcclxuICAgICAgICAgICAgJ2Rpc2FibGVkOmN1cnNvci1ub3QtYWxsb3dlZCc6IHRydWUsXHJcbiAgICAgICAgICAgICdkaXNhYmxlZDpiZy1wcmltYXJ5LTEnOiB0aGlzLmNvbG9yID09ICdwcmltYXJ5JyxcclxuICAgICAgICAgICAgJ2JnLXdoaXRlIGJvcmRlci1uZXV0cmFsLTItMjAwIHRleHQtbmV1dHJhbC0xLTkwMCBkYXJrOmJnLWQtbmV1dHJhbC0zLTMwMCBkYXJrOmJvcmRlci1kLW5ldXRyYWwtMi0yMDAgZGFyazp0ZXh0LWQtbmV1dHJhbC0xLTkwMCc6IHRoaXMuY29sb3IgPT0gXCJzZWNvbmRhcnlcIixcclxuICAgICAgICAgICAgJ2hvdmVyOmJnLW5ldXRyYWwtMy01MCAgZm9jdXM6YmctbmV1dHJhbC0zLTUwIGZvY3VzOmJvcmRlci1wcmltYXJ5LTIgZGFyazpmb2N1czpib3JkZXItcHJpbWFyeS0yIGRhcms6aG92ZXI6YmctZC1uZXV0cmFsLTMtNTAgIGRhcms6Zm9jdXM6YmctZC1uZXV0cmFsLTMtNTAnOiB0aGlzLmNvbG9yID09IFwic2Vjb25kYXJ5XCIgJiYgIXRoaXMuZGlzYWJsZWQsXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubmdDbHNCdXR0b24gPSB7XHJcbiAgICAgICAgICAgIFwicC0xXCI6IHRoaXMuc2l6ZSA9PSAnc20nLFxyXG4gICAgICAgICAgICBcInAtMS41XCI6IHRoaXMuc2l6ZSA9PSAnbWQnLFxyXG4gICAgICAgICAgICBcInAtMlwiOiB0aGlzLnNpemUgPT0gJ2xnJyxcclxuICAgICAgICAgICAgLi4uY29sb3JcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubmdDbHNMYWJlbCA9IHtcclxuICAgICAgICAgICAgXCJweS0xXCI6IHRoaXMuc2l6ZSA9PSAnc20nLFxyXG4gICAgICAgICAgICBcInB4LTIuNVwiOiB0aGlzLnNpemUgPT0gJ3NtJyxcclxuICAgICAgICAgICAgXCJweS0xLjVcIjogdGhpcy5zaXplID09ICdtZCcsXHJcbiAgICAgICAgICAgIFwicHgtM1wiOiB0aGlzLnNpemUgPT0gJ21kJyB8fCB0aGlzLnNpemUgPT0gJ2xnJyxcclxuICAgICAgICAgICAgXCJweS0yXCI6IHRoaXMuc2l6ZSA9PSAnbGcnLFxyXG4gICAgICAgICAgICAuLi5jb2xvclxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9nZXRIb3N0RWxlbWVudCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xyXG4gICAgfVxyXG4gICAgLy8gcHJpdmF0ZSBwX2dldENsYXNzQnlTaXplKCk6IHsgbGlzdENsYXNzQnV0dG9uOiBBcnJheTxzdHJpbmc+LCBsaXN0Q2xhc3NMYWJlbDogQXJyYXk8c3RyaW5nPiwgfSB7XHJcbiAgICAvLyAgICAgbGV0IHJlc3VsdDogeyBsaXN0Q2xhc3NCdXR0b246IEFycmF5PHN0cmluZz4sIGxpc3RDbGFzc0xhYmVsOiBBcnJheTxzdHJpbmc+LCB9ID0geyBsaXN0Q2xhc3NCdXR0b246IFtdLCBsaXN0Q2xhc3NMYWJlbDogW10gfVxyXG4gICAgLy8gICAgIHN3aXRjaCAodGhpcy5zaXplKSB7XHJcbiAgICAvLyAgICAgICAgIGNhc2UgXCJzbVwiOlxyXG4gICAgLy8gICAgICAgICAgICAgcmVzdWx0Lmxpc3RDbGFzc0J1dHRvbiA9IFtcInAtMVwiXTtcclxuICAgIC8vICAgICAgICAgICAgIHJlc3VsdC5saXN0Q2xhc3NMYWJlbCA9IFtcInB5LTFcIiwgXCIgcHgtMi41XCJdO1xyXG4gICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAvLyAgICAgICAgIGNhc2UgXCJsZ1wiOlxyXG4gICAgLy8gICAgICAgICAgICAgcmVzdWx0Lmxpc3RDbGFzc0J1dHRvbiA9IFtcInAtMlwiXTtcclxuICAgIC8vICAgICAgICAgICAgIC8vIHJlc3VsdC5saXN0Q2xhc3NMYWJlbCA9IFtcInB5LTJcIiwgXCIgcHgtM1wiXTtcclxuICAgIC8vICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgLy8gICAgICAgICBkZWZhdWx0OlxyXG4gICAgLy8gICAgICAgICAgICAgcmVzdWx0Lmxpc3RDbGFzc0J1dHRvbiA9IFtcInAtMS41XCJdO1xyXG4gICAgLy8gICAgICAgICAgICAgcmVzdWx0Lmxpc3RDbGFzc0xhYmVsID0gW1wicHktMS41XCIsIFwiIHB4LTNcIl07XHJcbiAgICAvLyAgICAgICAgICAgICBicmVhaztcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIC8vIH1cclxuICAgIC8vIHByaXZhdGUgcF9nZXRDbGFzc0J5Q29sb3IoKSB7XHJcbiAgICAvLyAgICAgbGV0IHJlc3VsdDogeyBsaXN0Q2xhc3NCdXR0b246IEFycmF5PHN0cmluZz4sIGxpc3RDbGFzc0xhYmVsOiBBcnJheTxzdHJpbmc+IH0gPSB7IGxpc3RDbGFzc0J1dHRvbjogW10sIGxpc3RDbGFzc0xhYmVsOiBbXSB9O1xyXG4gICAgLy8gICAgIHN3aXRjaCAodGhpcy5jb2xvcikge1xyXG4gICAgLy8gICAgICAgICBjYXNlIFwicHJpbWFyeVwiOlxyXG4gICAgLy8gICAgICAgICAgICAgcmVzdWx0Lmxpc3RDbGFzc0J1dHRvbiA9IFsnYmctcHJpbWFyeS0xJywgJ2JvcmRlci1wcmltYXJ5LTEnLCAncmluZy1wcmltYXJ5LTEnLCAnaG92ZXI6Ym9yZGVyLXByaW1hcnktMicsICdob3ZlcjpiZy1wcmltYXJ5LTInLCAnZm9jdXM6YmctcHJpbWFyeS0xJywgJ3RleHQtd2hpdGUnLCAnZGlzYWJsZWQ6Y3Vyc29yLWRlZmF1bHQnLCAnZGlzYWJsZWQ6YmctcHJpbWFyeS0xJ107XHJcbiAgICAvLyAgICAgICAgICAgICAvLyByZXN1bHQubGlzdENsYXNzTGFiZWwgPSBbJ2JvcmRlci1wcmltYXJ5LTEnLCAnYmctcHJpbWFyeS0xJywnZm9jdXM6cmluZycsICdyaW5nLXByaW1hcnktMScsICd0ZXh0LXdoaXRlJywgJ2hvdmVyOmJvcmRlci1wcmltYXJ5LTInLCAnaG92ZXI6YmctcHJpbWFyeS0yJywgJ2ZvY3VzOmJnLXByaW1hcnktMScsJ3Jpbmctb3BhY2l0eS0yMCddO1xyXG4gICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAvLyAgICAgICAgIGNhc2UgXCJzZWNvbmRhcnlcIjpcclxuICAgIC8vICAgICAgICAgICAgIHJlc3VsdC5saXN0Q2xhc3NCdXR0b24gPSBbJ2hvdmVyOmJnLW5ldXRyYWwtMy01MCAnLCAnYmctd2hpdGUnLCAnYm9yZGVyLW5ldXRyYWwtMi0yMDAnLCAncmluZy1wcmltYXJ5LTEnLCAnZ3JvdXAtaG92ZXI6YmctbmV1dHJhbC0zLTUwICcsICdmb2N1czpiZy13aGl0ZScsICdkaXNhYmxlZDpjdXJzb3ItZGVmYXVsdCcsICd0ZXh0LW5ldXRyYWwtMS05MDAnLCAnZm9jdXM6Ym9yZGVyLXByaW1hcnktMiddO1xyXG4gICAgLy8gICAgICAgICAgICAgLy8gcmVzdWx0Lmxpc3RDbGFzc0xhYmVsID0gWydiZy13aGl0ZScsICdib3JkZXItbmV1dHJhbC0yLTIwMCcsICdyaW5nLXByaW1hcnktMScsICdncm91cC1ob3ZlcjpiZy1uZXV0cmFsLTMtNTAgJywgJ2ZvY3VzOmJnLXdoaXRlJywgJ2Rpc2FibGVkOmN1cnNvci1kZWZhdWx0JywgJ3RleHQtbmV1dHJhbC0xLTkwMCcsICdmb2N1czpib3JkZXItcHJpbWFyeS0yJywncmluZy1vcGFjaXR5LTIwJ107XHJcbiAgICAvLyAgICAgICAgICAgICBicmVhaztcclxuICAgIC8vICAgICAgICAgZGVmYXVsdDpcclxuICAgIC8vICAgICAgICAgICAgIC8vIHJlc3VsdCA9IFsndGV4dC13aGl0ZScsYHJpbmctJHtjb2xvcn0tNDAwYCxgYm9yZGVyLSR7Y29sb3J9LTQwMGAgLGBiZy0ke2NvbG9yfS00MDBgLCBgaG92ZXI6YmctJHtjb2xvcn0tNTAwYCwgYGZvY3VzOmJnLSR7Y29sb3J9LTQwMGBdO1xyXG4gICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAvLyB9XHJcbiAgICBvbkNsaWNrTGFiZWwoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jbGlja0J1dHRvbi5lbWl0KGV2ZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgb25DbGlja0Ryb3Bkb3duKGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlci5vcGVuTWVudSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbn1cclxuIiwiPGRpdiBjbGFzcz1cImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLXN0cmV0Y2ggdGV4dC1ib2R5LTIgcm91bmRlZC1tZCBmb250LXNlbWlib2xkIHRleHQtbmV1dHJhbC0xLTkwMCBkYXJrOnRleHQtZC1uZXV0cmFsLTEtOTAwIGRhcms6YmctZC1uZXV0cmFsLTMtMzAwXCIgW25nQ2xhc3NdPVwieydvcGFjaXR5LTY1JzpkaXNhYmxlZH1cIj5cclxuICAgIDxidXR0b24gY2xhc3M9XCJmbGV4IGl0ZW1zLWNlbnRlciBib3JkZXIgcm91bmRlZC1sLW1kICBib3JkZXItci0wIGRpc2FibGVkOm9wYWNpdHktNjUgZm9jdXM6b3V0bGluZS1ub25lICBib3gtYm9yZGVyIHJpbmctb3BhY2l0eS0yMCAgZm9jdXM6cmluZyAgcmluZy1wcmltYXJ5LTFcIiAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCIgIFtuZ0NsYXNzXT1cIm5nQ2xzTGFiZWxcIlxyXG4gICAgXHJcbiAgICAoY2xpY2spPVwib25DbGlja0xhYmVsKCRldmVudClcIj5cclxuICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCIuanMtbGFiZWxcIj48L25nLWNvbnRlbnQ+XHJcbiAgICA8L2J1dHRvbj5cclxuICAgIDxidXR0b24gI2J1dHRvbiAoY2xpY2spPVwib25DbGlja0Ryb3Bkb3duKCRldmVudClcIlxyXG4gICAgICAgIGNsYXNzPVwiIGZsZXggaXRlbXMtY2VudGVyIHJvdW5kZWQtbC1ub25lIGJvcmRlciByb3VuZGVkLXItbWQgZGlzYWJsZWQ6b3BhY2l0eS02NSAgZm9jdXM6b3V0bGluZS1ub25lICBib3gtYm9yZGVyIHJpbmctb3BhY2l0eS0yMCAgZm9jdXM6cmluZyAgcmluZy1wcmltYXJ5LTFcIlxyXG4gICAgICAgIFt0ZHNidXR0b25NZW51VHJpZ2dlckZvcl09XCJtZW51XCIgW3RidXR0b25NZW51VHJpZ2dlclJlc3RvcmVGb2N1c109XCJmYWxzZVwiICBbbmdDbGFzc109XCJuZ0Nsc0J1dHRvblwiIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiPiAgICAgIFxyXG4gICAgICAgIDxpIGNsYXNzPVwidGV4dC14bCB0ZHNpLWFycm93LWRvd24tZmlsbCBsZWFkaW5nLW5vbmVcIj48L2k+XHJcbiAgICA8L2J1dHRvbj5cclxuICAgIDx0YnV0dG9uLW1lbnUgI21lbnU9XCJURFNCdXR0b25NZW51XCI+ICAgICAgIFxyXG4gICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1cIi5qcy1jb250ZW50XCI+PC9uZy1jb250ZW50PlxyXG4gICAgPC90YnV0dG9uLW1lbnU+XHJcbjwvZGl2PiJdfQ==