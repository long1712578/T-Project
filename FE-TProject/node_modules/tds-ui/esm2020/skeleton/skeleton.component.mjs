import { ChangeDetectionStrategy, Component, Input, ViewEncapsulation } from '@angular/core';
import { toCssPixel } from 'tds-ui/shared/utility';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "./skeleton-element.component";
function TDSSkeletonComponent_ng_container_0_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 5);
    i0.ɵɵelement(1, "tds-skeleton-element", 6);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("tdsSize", ctx_r2.avatar.size || "md")("tdsShape", ctx_r2.avatar.shape || "circle");
} }
function TDSSkeletonComponent_ng_container_0_h3_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "h3", 7);
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext(2);
    i0.ɵɵstyleProp("width", ctx_r3.toCSSUnit(ctx_r3.title.width));
} }
function TDSSkeletonComponent_ng_container_0_ul_4_li_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "li", 10);
} if (rf & 2) {
    const i_r7 = ctx.index;
    const ctx_r5 = i0.ɵɵnextContext(3);
    i0.ɵɵstyleProp("width", ctx_r5.toCSSUnit(ctx_r5.widthList[i_r7]));
} }
function TDSSkeletonComponent_ng_container_0_ul_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "ul", 8);
    i0.ɵɵtemplate(1, TDSSkeletonComponent_ng_container_0_ul_4_li_1_Template, 1, 2, "li", 9);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngForOf", ctx_r4.rowsList);
} }
function TDSSkeletonComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, TDSSkeletonComponent_ng_container_0_div_1_Template, 2, 2, "div", 1);
    i0.ɵɵelementStart(2, "div", 2);
    i0.ɵɵtemplate(3, TDSSkeletonComponent_ng_container_0_h3_3_Template, 1, 2, "h3", 3);
    i0.ɵɵtemplate(4, TDSSkeletonComponent_ng_container_0_ul_4_Template, 2, 1, "ul", 4);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", !!ctx_r0.tdsAvatar);
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("ngIf", !!ctx_r0.tdsTitle);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", !!ctx_r0.tdsParagraph);
} }
function TDSSkeletonComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵprojection(1);
    i0.ɵɵelementContainerEnd();
} }
const _c0 = ["*"];
export class TDSSkeletonComponent {
    constructor(cdr, renderer, elementRef) {
        this.cdr = cdr;
        this.tdsActive = false;
        this.tdsLoading = true;
        this.tdsRound = false;
        this.tdsTitle = true;
        this.tdsAvatar = false;
        this.tdsParagraph = true;
        this.rowsList = [];
        this.widthList = [];
        renderer.addClass(elementRef.nativeElement, 'tds-skeleton');
    }
    toCSSUnit(value = '') {
        return toCssPixel(value);
    }
    getTitleProps() {
        const hasAvatar = !!this.tdsAvatar;
        const hasParagraph = !!this.tdsParagraph;
        let width = '';
        if (!hasAvatar && hasParagraph) {
            width = '38%';
        }
        else if (hasAvatar && hasParagraph) {
            width = '50%';
        }
        return { width, ...this.getProps(this.tdsTitle) };
    }
    getAvatarProps() {
        const shape = !!this.tdsTitle && !this.tdsParagraph ? 'square' : 'circle';
        const size = 'md';
        return { shape, size, ...this.getProps(this.tdsAvatar) };
    }
    getParagraphProps() {
        const hasAvatar = !!this.tdsAvatar;
        const hasTitle = !!this.tdsTitle;
        const basicProps = {};
        // Width
        if (!hasAvatar || !hasTitle) {
            basicProps.width = '61%';
        }
        // Rows
        if (!hasAvatar && hasTitle) {
            basicProps.rows = 3;
        }
        else {
            basicProps.rows = 2;
        }
        return { ...basicProps, ...this.getProps(this.tdsParagraph) };
    }
    getProps(prop) {
        return prop && typeof prop === 'object' ? prop : {};
    }
    getWidthList() {
        const { width, rows } = this.paragraph;
        let widthList = [];
        if (width && Array.isArray(width)) {
            widthList = width;
        }
        else if (width && !Array.isArray(width)) {
            widthList = [];
            widthList[rows - 1] = width;
        }
        return widthList;
    }
    updateProps() {
        this.title = this.getTitleProps();
        this.avatar = this.getAvatarProps();
        this.paragraph = this.getParagraphProps();
        this.rowsList = [...Array(this.paragraph.rows)];
        this.widthList = this.getWidthList();
        this.cdr.markForCheck();
    }
    ngOnInit() {
        this.updateProps();
    }
    ngOnChanges(changes) {
        if (changes.tdsTitle || changes.tdsAvatar || changes.tdsParagraph) {
            this.updateProps();
        }
    }
}
TDSSkeletonComponent.ɵfac = function TDSSkeletonComponent_Factory(t) { return new (t || TDSSkeletonComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i0.ElementRef)); };
TDSSkeletonComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TDSSkeletonComponent, selectors: [["tds-skeleton"]], hostAttrs: [1, "table", "w-full", "box-border"], hostVars: 8, hostBindings: function TDSSkeletonComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵclassProp("tds-skeleton-with-avatar", !!ctx.tdsAvatar)("tds-skeleton-active", ctx.tdsActive)("animate-pulse", ctx.tdsActive)("tds-skeleton-round", !!ctx.tdsRound);
    } }, inputs: { tdsActive: "tdsActive", tdsLoading: "tdsLoading", tdsRound: "tdsRound", tdsTitle: "tdsTitle", tdsAvatar: "tdsAvatar", tdsParagraph: "tdsParagraph" }, exportAs: ["tdsSkeleton"], features: [i0.ɵɵNgOnChangesFeature], ngContentSelectors: _c0, decls: 2, vars: 2, consts: [[4, "ngIf"], ["class", "tds-skeleton-header table-cell pr-4 align-top", 4, "ngIf"], [1, "tds-skeleton-content", "w-full", "table-cell", "align-top", "m-0", "p-0"], ["class", "tds-skeleton-title w-full h-[18px] mt-4 bg-neutral-2-100 dark:bg-d-neutral-2-200 rounded-10", 3, "width", 4, "ngIf"], ["class", "tds-skeleton-paragraph mt-4 w-full", 4, "ngIf"], [1, "tds-skeleton-header", "table-cell", "pr-4", "align-top"], ["tdsType", "avatar", 3, "tdsSize", "tdsShape"], [1, "tds-skeleton-title", "w-full", "h-[18px]", "mt-4", "bg-neutral-2-100", "dark:bg-d-neutral-2-200", "rounded-10"], [1, "tds-skeleton-paragraph", "mt-4", "w-full"], ["class", "w-full h-[14px] bg-neutral-2-100 dark:bg-d-neutral-2-200 rounded-10 mb-2.5", 3, "width", 4, "ngFor", "ngForOf"], [1, "w-full", "h-[14px]", "bg-neutral-2-100", "dark:bg-d-neutral-2-200", "rounded-10", "mb-2.5"]], template: function TDSSkeletonComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵprojectionDef();
        i0.ɵɵtemplate(0, TDSSkeletonComponent_ng_container_0_Template, 5, 3, "ng-container", 0);
        i0.ɵɵtemplate(1, TDSSkeletonComponent_ng_container_1_Template, 2, 0, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.tdsLoading);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", !ctx.tdsLoading);
    } }, directives: [i1.NgIf, i2.TDSSkeletonElementDirective, i2.TDSSkeletonElementAvatarComponent, i1.NgForOf], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TDSSkeletonComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                selector: 'tds-skeleton',
                exportAs: 'tdsSkeleton',
                host: {
                    'class': "table w-full box-border",
                    '[class.tds-skeleton-with-avatar]': '!!tdsAvatar',
                    '[class.tds-skeleton-active]': 'tdsActive',
                    '[class.animate-pulse]': 'tdsActive',
                    '[class.tds-skeleton-round]': '!!tdsRound'
                },
                template: `
    <ng-container *ngIf="tdsLoading">
      <div class="tds-skeleton-header table-cell pr-4 align-top" *ngIf="!!tdsAvatar">
        <tds-skeleton-element tdsType="avatar" [tdsSize]="avatar.size || 'md'" [tdsShape]="avatar.shape || 'circle'"></tds-skeleton-element>
      </div>
      <div class="tds-skeleton-content w-full table-cell align-top m-0 p-0">
        <h3 *ngIf="!!tdsTitle" class="tds-skeleton-title w-full h-[18px] mt-4 bg-neutral-2-100 dark:bg-d-neutral-2-200 rounded-10" [style.width]="toCSSUnit(title.width)"></h3>
        <ul *ngIf="!!tdsParagraph" class="tds-skeleton-paragraph mt-4 w-full">
          <li class="w-full h-[14px] bg-neutral-2-100 dark:bg-d-neutral-2-200 rounded-10 mb-2.5" *ngFor="let row of rowsList; let i = index" [style.width]="toCSSUnit(widthList[i])"></li>
        </ul>
      </div>
    </ng-container>
    <ng-container *ngIf="!tdsLoading">
      <ng-content></ng-content>
    </ng-container>
  `
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.Renderer2 }, { type: i0.ElementRef }]; }, { tdsActive: [{
            type: Input
        }], tdsLoading: [{
            type: Input
        }], tdsRound: [{
            type: Input
        }], tdsTitle: [{
            type: Input
        }], tdsAvatar: [{
            type: Input
        }], tdsParagraph: [{
            type: Input
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tlbGV0b24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvdGRzLXVpL3NrZWxldG9uL3NrZWxldG9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQ0wsdUJBQXVCLEVBRXZCLFNBQVMsRUFFVCxLQUFLLEVBS0wsaUJBQWlCLEVBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQzs7Ozs7SUFrQjdDLDhCQUErRTtJQUM3RSwwQ0FBb0k7SUFDdEksaUJBQU07OztJQURtQyxlQUErQjtJQUEvQixvREFBK0IsNkNBQUE7OztJQUd0RSx3QkFBdUs7OztJQUE1Qyw2REFBc0M7OztJQUUvSix5QkFBZ0w7Ozs7SUFBN0MsaUVBQXVDOzs7SUFENUssNkJBQXNFO0lBQ3BFLHVGQUFnTDtJQUNsTCxpQkFBSzs7O0lBRG9HLGVBQWE7SUFBYix5Q0FBYTs7O0lBUDFILDZCQUFpQztJQUMvQixvRkFFTTtJQUNOLDhCQUFzRTtJQUNwRSxrRkFBdUs7SUFDdkssa0ZBRUs7SUFDUCxpQkFBTTtJQUNSLDBCQUFlOzs7SUFUK0MsZUFBaUI7SUFBakIseUNBQWlCO0lBSXRFLGVBQWdCO0lBQWhCLHdDQUFnQjtJQUNoQixlQUFvQjtJQUFwQiw0Q0FBb0I7OztJQUs3Qiw2QkFBa0M7SUFDaEMsa0JBQXlCO0lBQzNCLDBCQUFlOzs7QUFHbkIsTUFBTSxPQUFPLG9CQUFvQjtJQWMvQixZQUFvQixHQUFzQixFQUFFLFFBQW1CLEVBQUUsVUFBc0I7UUFBbkUsUUFBRyxHQUFILEdBQUcsQ0FBbUI7UUFiakMsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNsQixlQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLGFBQVEsR0FBRyxLQUFLLENBQUM7UUFDakIsYUFBUSxHQUErQixJQUFJLENBQUM7UUFDNUMsY0FBUyxHQUFnQyxLQUFLLENB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LDRCQUE0QixFQUFFLFlBQVk7aUJBQzNDO2dCQUNELFFBQVEsRUFBRTs7Ozs7Ozs7Ozs7Ozs7O0dBZVQ7YUFDRjtxSEFFVSxTQUFTO2tCQUFqQixLQUFLO1lBQ0csVUFBVTtrQkFBbEIsS0FBSztZQUNHLFFBQVE7a0JBQWhCLEtBQUs7WUFDRyxRQUFRO2tCQUFoQixLQUFLO1lBQ0csU0FBUztrQkFBakIsS0FBSztZQUNHLFlBQVk7a0JBQXBCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmltcG9ydCB7XHJcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXHJcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgQ29tcG9uZW50LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgSW5wdXQsXHJcbiAgT25DaGFuZ2VzLFxyXG4gIE9uSW5pdCxcclxuICBSZW5kZXJlcjIsXHJcbiAgU2ltcGxlQ2hhbmdlcyxcclxuICBWaWV3RW5jYXBzdWxhdGlvblxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyB0b0Nzc1BpeGVsIH0gZnJvbSAndGRzLXVpL3NoYXJlZC91dGlsaXR5JztcclxuXHJcbmltcG9ydCB7IFREU1NrZWxldG9uQXZhdGFyLCBURFNTa2VsZXRvbkF2YXRhclNoYXBlLCBURFNTa2VsZXRvbkF2YXRhclNpemUsIFREU1NrZWxldG9uUGFyYWdyYXBoLCBURFNTa2VsZXRvblRpdGxlIH0gZnJvbSAnLi9za2VsZXRvbi50eXBlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxyXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgc2VsZWN0b3I6ICd0ZHMtc2tlbGV0b24nLFxyXG4gIGV4cG9ydEFzOiAndGRzU2tlbGV0b24nLFxyXG4gIGhvc3Q6IHtcclxuICAgICdjbGFzcyc6XCJ0YWJsZSB3LWZ1bGwgYm94LWJvcmRlclwiLCBcclxuICAgICdbY2xhc3MudGRzLXNrZWxldG9uLXdpdGgtYXZhdGFyXSc6ICchIXRkc0F2YXRhcicsXHJcbiAgICAnW2NsYXNzLnRkcy1za2VsZXRvbi1hY3RpdmVdJzogJ3Rkc0FjdGl2ZScsXHJcbiAgICAnW2NsYXNzLmFuaW1hdGUtcHVsc2VdJzogJ3Rkc0FjdGl2ZScsXHJcbiAgICAnW2NsYXNzLnRkcy1za2VsZXRvbi1yb3VuZF0nOiAnISF0ZHNSb3VuZCdcclxuICB9LFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwidGRzTG9hZGluZ1wiPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwidGRzLXNrZWxldG9uLWhlYWRlciB0YWJsZS1jZWxsIHByLTQgYWxpZ24tdG9wXCIgKm5nSWY9XCIhIXRkc0F2YXRhclwiPlxyXG4gICAgICAgIDx0ZHMtc2tlbGV0b24tZWxlbWVudCB0ZHNUeXBlPVwiYXZhdGFyXCIgW3Rkc1NpemVdPVwiYXZhdGFyLnNpemUgfHwgJ21kJ1wiIFt0ZHNTaGFwZV09XCJhdmF0YXIuc2hhcGUgfHwgJ2NpcmNsZSdcIj48L3Rkcy1za2VsZXRvbi1lbGVtZW50PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzcz1cInRkcy1za2VsZXRvbi1jb250ZW50IHctZnVsbCB0YWJsZS1jZWxsIGFsaWduLXRvcCBtLTAgcC0wXCI+XHJcbiAgICAgICAgPGgzICpuZ0lmPVwiISF0ZHNUaXRsZVwiIGNsYXNzPVwidGRzLXNrZWxldG9uLXRpdGxlIHctZnVsbCBoLVsxOHB4XSBtdC00IGJnLW5ldXRyYWwtMi0xMDAgZGFyazpiZy1kLW5ldXRyYWwtMi0yMDAgcm91bmRlZC0xMFwiIFtzdHlsZS53aWR0aF09XCJ0b0NTU1VuaXQodGl0bGUud2lkdGgpXCI+PC9oMz5cclxuICAgICAgICA8dWwgKm5nSWY9XCIhIXRkc1BhcmFncmFwaFwiIGNsYXNzPVwidGRzLXNrZWxldG9uLXBhcmFncmFwaCBtdC00IHctZnVsbFwiPlxyXG4gICAgICAgICAgPGxpIGNsYXNzPVwidy1mdWxsIGgtWzE0cHhdIGJnLW5ldXRyYWwtMi0xMDAgZGFyazpiZy1kLW5ldXRyYWwtMi0yMDAgcm91bmRlZC0xMCBtYi0yLjVcIiAqbmdGb3I9XCJsZXQgcm93IG9mIHJvd3NMaXN0OyBsZXQgaSA9IGluZGV4XCIgW3N0eWxlLndpZHRoXT1cInRvQ1NTVW5pdCh3aWR0aExpc3RbaV0pXCI+PC9saT5cclxuICAgICAgICA8L3VsPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiF0ZHNMb2FkaW5nXCI+XHJcbiAgICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cclxuICAgIDwvbmctY29udGFpbmVyPlxyXG4gIGBcclxufSlcclxuZXhwb3J0IGNsYXNzIFREU1NrZWxldG9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG4gIEBJbnB1dCgpIHRkc0FjdGl2ZSA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHRkc0xvYWRpbmcgPSB0cnVlO1xyXG4gIEBJbnB1dCgpIHRkc1JvdW5kID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdGRzVGl0bGU6IFREU1NrZWxldG9uVGl0bGUgfCBib29sZWFuID0gdHJ1ZTtcclxuICBASW5wdXQoKSB0ZHNBdmF0YXI6IFREU1NrZWxldG9uQXZhdGFyIHwgYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHRkc1BhcmFncmFwaDogVERTU2tlbGV0b25QYXJhZ3JhcGggfCBib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgdGl0bGUhOiBURFNTa2VsZXRvblRpdGxlO1xyXG4gIGF2YXRhciE6IFREU1NrZWxldG9uQXZhdGFyO1xyXG4gIHBhcmFncmFwaCE6IFREU1NrZWxldG9uUGFyYWdyYXBoO1xyXG4gIHJvd3NMaXN0OiBudW1iZXJbXSA9IFtdO1xyXG4gIHdpZHRoTGlzdDogQXJyYXk8bnVtYmVyIHwgc3RyaW5nPiA9IFtdO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsIHJlbmRlcmVyOiBSZW5kZXJlcjIsIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYpIHtcclxuICAgIHJlbmRlcmVyLmFkZENsYXNzKGVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ3Rkcy1za2VsZXRvbicpO1xyXG4gIH1cclxuXHJcbiAgdG9DU1NVbml0KHZhbHVlOiBudW1iZXIgfCBzdHJpbmcgPSAnJyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdG9Dc3NQaXhlbCh2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFRpdGxlUHJvcHMoKTogVERTU2tlbGV0b25UaXRsZSB7XHJcbiAgICBjb25zdCBoYXNBdmF0YXI6IGJvb2xlYW4gPSAhIXRoaXMudGRzQXZhdGFyO1xyXG4gICAgY29uc3QgaGFzUGFyYWdyYXBoOiBib29sZWFuID0gISF0aGlzLnRkc1BhcmFncmFwaDtcclxuICAgIGxldCB3aWR0aCA9ICcnO1xyXG4gICAgaWYgKCFoYXNBdmF0YXIgJiYgaGFzUGFyYWdyYXBoKSB7XHJcbiAgICAgIHdpZHRoID0gJzM4JSc7XHJcbiAgICB9IGVsc2UgaWYgKGhhc0F2YXRhciAmJiBoYXNQYXJhZ3JhcGgpIHtcclxuICAgICAgd2lkdGggPSAnNTAlJztcclxuICAgIH1cclxuICAgIHJldHVybiB7IHdpZHRoLCAuLi50aGlzLmdldFByb3BzKHRoaXMudGRzVGl0bGUpIH07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEF2YXRhclByb3BzKCk6IFREU1NrZWxldG9uQXZhdGFyIHtcclxuICAgIGNvbnN0IHNoYXBlOiBURFNTa2VsZXRvbkF2YXRhclNoYXBlID0gISF0aGlzLnRkc1RpdGxlICYmICF0aGlzLnRkc1BhcmFncmFwaCA/ICdzcXVhcmUnIDogJ2NpcmNsZSc7XHJcbiAgICBjb25zdCBzaXplOiBURFNTa2VsZXRvbkF2YXRhclNpemUgPSAnbWQnO1xyXG4gICAgcmV0dXJuIHsgc2hhcGUsIHNpemUsIC4uLnRoaXMuZ2V0UHJvcHModGhpcy50ZHNBdmF0YXIpIH07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFBhcmFncmFwaFByb3BzKCk6IFREU1NrZWxldG9uUGFyYWdyYXBoIHtcclxuICAgIGNvbnN0IGhhc0F2YXRhcjogYm9vbGVhbiA9ICEhdGhpcy50ZHNBdmF0YXI7XHJcbiAgICBjb25zdCBoYXNUaXRsZTogYm9vbGVhbiA9ICEhdGhpcy50ZHNUaXRsZTtcclxuICAgIGNvbnN0IGJhc2ljUHJvcHM6IFREU1NrZWxldG9uUGFyYWdyYXBoID0ge307XHJcbiAgICAvLyBXaWR0aFxyXG4gICAgaWYgKCFoYXNBdmF0YXIgfHwgIWhhc1RpdGxlKSB7XHJcbiAgICAgIGJhc2ljUHJvcHMud2lkdGggPSAnNjElJztcclxuICAgIH1cclxuICAgIC8vIFJvd3NcclxuICAgIGlmICghaGFzQXZhdGFyICYmIGhhc1RpdGxlKSB7XHJcbiAgICAgIGJhc2ljUHJvcHMucm93cyA9IDM7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBiYXNpY1Byb3BzLnJvd3MgPSAyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHsgLi4uYmFzaWNQcm9wcywgLi4udGhpcy5nZXRQcm9wcyh0aGlzLnRkc1BhcmFncmFwaCkgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0UHJvcHM8VD4ocHJvcDogVCB8IGJvb2xlYW4gfCB1bmRlZmluZWQpOiBUIHwge30ge1xyXG4gICAgcmV0dXJuIHByb3AgJiYgdHlwZW9mIHByb3AgPT09ICdvYmplY3QnID8gcHJvcCA6IHt9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRXaWR0aExpc3QoKTogQXJyYXk8bnVtYmVyIHwgc3RyaW5nPiB7XHJcbiAgICBjb25zdCB7IHdpZHRoLCByb3dzIH0gPSB0aGlzLnBhcmFncmFwaDtcclxuICAgIGxldCB3aWR0aExpc3Q6IEFycmF5PHN0cmluZyB8IG51bWJlcj4gPSBbXTtcclxuICAgIGlmICh3aWR0aCAmJiBBcnJheS5pc0FycmF5KHdpZHRoKSkge1xyXG4gICAgICB3aWR0aExpc3QgPSB3aWR0aDtcclxuICAgIH0gZWxzZSBpZiAod2lkdGggJiYgIUFycmF5LmlzQXJyYXkod2lkdGgpKSB7XHJcbiAgICAgIHdpZHRoTGlzdCA9IFtdO1xyXG4gICAgICB3aWR0aExpc3Rbcm93cyEgLSAxXSA9IHdpZHRoO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHdpZHRoTGlzdDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlUHJvcHMoKTogdm9pZCB7XHJcbiAgICB0aGlzLnRpdGxlID0gdGhpcy5nZXRUaXRsZVByb3BzKCk7XHJcbiAgICB0aGlzLmF2YXRhciA9IHRoaXMuZ2V0QXZhdGFyUHJvcHMoKTtcclxuICAgIHRoaXMucGFyYWdyYXBoID0gdGhpcy5nZXRQYXJhZ3JhcGhQcm9wcygpO1xyXG4gICAgdGhpcy5yb3dzTGlzdCA9IFsuLi5BcnJheSh0aGlzLnBhcmFncmFwaC5yb3dzKV07XHJcbiAgICB0aGlzLndpZHRoTGlzdCA9IHRoaXMuZ2V0V2lkdGhMaXN0KCk7XHJcbiAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy51cGRhdGVQcm9wcygpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgaWYgKGNoYW5nZXMudGRzVGl0bGUgfHwgY2hhbmdlcy50ZHNBdmF0YXIgfHwgY2hhbmdlcy50ZHNQYXJhZ3JhcGgpIHtcclxuICAgICAgdGhpcy51cGRhdGVQcm9wcygpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0=